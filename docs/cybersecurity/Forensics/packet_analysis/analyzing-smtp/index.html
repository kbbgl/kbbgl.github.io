<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-cybersecurity/Forensics/packet_analysis/Analyzing SMTP" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Analyzing SMTP | Kobbi&#x27;s Knowledgebase</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kbbgl.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kbbgl.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kbbgl.github.io/docs/cybersecurity/Forensics/packet_analysis/analyzing-smtp"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Analyzing SMTP | Kobbi&#x27;s Knowledgebase"><meta data-rh="true" name="description" content="Fill me up!"><meta data-rh="true" property="og:description" content="Fill me up!"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://kbbgl.github.io/docs/cybersecurity/Forensics/packet_analysis/analyzing-smtp"><link data-rh="true" rel="alternate" href="https://kbbgl.github.io/docs/cybersecurity/Forensics/packet_analysis/analyzing-smtp" hreflang="en"><link data-rh="true" rel="alternate" href="https://kbbgl.github.io/docs/cybersecurity/Forensics/packet_analysis/analyzing-smtp" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://3OEAR0LK7K-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kobbi&#39;s Knowledgebase RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kobbi&#39;s Knowledgebase Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Kobbi&#39;s Knowledgebase" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.7908c776.css">
<script src="/assets/js/runtime~main.2267bef1.js" defer="defer"></script>
<script src="/assets/js/main.a2e5e7bf.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kobbi&#x27;s Knowledgebase</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" sidebarid="blogSidebar" href="/blog">Blog</a><a class="navbar__item navbar__link" sidebarid="hackBlogSidebar" href="/hack_blog">Hack Blog</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/software/containerization/docker/admin/get-list-containers-resource-usage">Software</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/hardware/cpu/computing-abstraction-layers">Hardware</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/os/UNIX/Account Management/Controlling_File_Directory_PERMISSIONS">Operating Systems</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/cybersecurity/Encryption/check-cert-cn">Cybersecurity</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/cybersecurity/Encryption/check-cert-cn">Encryption</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/cybersecurity/Forensics/gdb/gdb-cheatsheet">Forensics</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/cybersecurity/Forensics/gdb/gdb-cheatsheet">gdb</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/cybersecurity/Forensics/packet_analysis/analyzing-smtp">packet_analysis</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/cybersecurity/Forensics/packet_analysis/analyzing-smtp">Analyzing SMTP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cybersecurity/Forensics/packet_analysis/smtp">smtp</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/cybersecurity/Offensive/Enumeration/unix-enumeration-scripts">Offensive</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/cloud_services/aws/aws-cli-cheatsheet">Cloud Services</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Cybersecurity</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Forensics</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">packet_analysis</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Analyzing SMTP</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Analyzing SMTP</h1></header><p>Taken from <em>Network Forensics, Tracking Hackers through Cyberspace</em>, Case Study 4.6.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="description">Description<a href="#description" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h2>
<p>After being released on bail, Ann Dercover disappears! Fortunately, investigators were carefully monitoring her network activity before she skipped town. “We believe Ann may have communicated with her secret lover, Mr. X, before she left,” says the police chief. “The packet capture may contain clues to her whereabouts.”</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mission">Mission<a href="#mission" class="hash-link" aria-label="Direct link to Mission" title="Direct link to Mission">​</a></h2>
<p>Your mission is to analyze the packet capture and gather information about Ann’s activities and plans.</p>
<p>The following questions will help guide your investigation:
• Provide any online aliases or addresses and corresponding account credentials that may be used by the suspect under investigation.</p>
<p>• Who did Ann communicate with? Provide a list of email addresses and any other identifying information.</p>
<p>• Extract any transcripts of Ann’s conversations and present them to investigators.</p>
<p>• If Ann transferred or received any files of interest, recover them.</p>
<p>• Are there any indications of Ann’s physical whereabouts? If so, provide supporting evidence.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="network">Network<a href="#network" class="hash-link" aria-label="Direct link to Network" title="Direct link to Network">​</a></h2>
<p>• Internal network: <code>192.168.30.0/24</code></p>
<p>• DMZ: <code>10.30.30.0/24</code></p>
<p>• The “Internet”: <code>172.30.1.0/24</code> [Note that for the purposes of this case study, we are treating the <code>172.30.1.0/24</code> subnet as “the Internet.” In real life, this is a reserved nonroutable IP address space.]</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="evidence">Evidence<a href="#evidence" class="hash-link" aria-label="Direct link to Evidence" title="Direct link to Evidence">​</a></h2>
<p>Investigators provide you with a packet capture from Ann’s home network, <a href="/docs/cybersecurity/Forensics/packet_analysis/evidence-packet-analysis.pcap"><code>evidence-packet-analysis.pcap</code></a> They also inform you that in the course of their monitoring, they have found that Ann’s laptop has the MAC address <code>00:21:70:4D:4F:AE</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="analysis">Analysis<a href="#analysis" class="hash-link" aria-label="Direct link to Analysis" title="Direct link to Analysis">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="protocol-summary">Protocol Summary<a href="#protocol-summary" class="hash-link" aria-label="Direct link to Protocol Summary" title="Direct link to Protocol Summary">​</a></h3>
<p>Let&#x27;s first review the protocols used in this packet capture.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tshark </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain">  </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> evidence-packet-analysis.pcap </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-z</span><span class="token plain"> io,ph</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">===================================================================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Protocol Hierarchy Statistics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Filter: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eth                                      frames:2487 bytes:1508942</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ip                                     frames:2487 bytes:1508942</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    udp                                  frames:481 bytes:53801</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ntp                                frames:17 bytes:1530</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      dhcp                               frames:10 bytes:3509</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      nbdgm                              frames:18 bytes:3888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        smb                              frames:18 bytes:3888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          mailslot                       frames:18 bytes:3888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            browser                      frames:18 bytes:3888</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      nbns                               frames:108 bytes:10584</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      dns                                frames:328 bytes:34290</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tcp                                  frames:2000 bytes:1454781</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      http                               frames:111 bytes:71429</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data-text-lines                  frames:18 bytes:15217</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          tcp.segments                   frames:11 bytes:10088</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        media                            frames:2 bytes:1490</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          tcp.segments                   frames:1 bytes:694</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image-gif                        frames:4 bytes:2205</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          tcp.segments                   frames:1 bytes:995</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        png                              frames:23 bytes:14320</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          tcp.segments                   frames:18 bytes:8640</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          _ws.malformed                  frames:2 bytes:2251</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        image-jfif                       frames:6 bytes:4737</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          tcp.segments                   frames:6 bytes:4737</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      smtp                               frames:269 bytes:303146</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        imf                              frames:3 bytes:180</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      imap                               frames:291 bytes:307021</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        imf                              frames:2 bytes:1189</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tcp.segments                     frames:202 bytes:284153</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    igmp                                 frames:6 bytes:360</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">===================================================================</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>All ethernet (layer 2) and IP (layer 3) communication.</p>
<p>We can see that DHCP communication occurred. It can help us link the provided MAC address to the assigned IP address.</p>
<p>As a reminder, this is how the DHCP request/response works:</p>
<p><img decoding="async" loading="lazy" src="https://www.researchgate.net/profile/Chi-Fu-Huang/publication/4109437/figure/fig8/AS:670523923103777@1536876769687/llustrates-the-related-DHCP-message-flows-The-DHCP-Discover-is-forwarded-by-the-DHCP.ppm" alt="dhcp-req-res" class="img_ev3q"></p>
<p>Let&#x27;s list all DHCP communication in the packet capture:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">❯ tshark </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> evidence-packet-analysis.pcap </span><span class="token parameter variable" style="color:#36acaa">-Y</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;eth.addr == 00:21:70:4d:4f:ae and bootp&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-V</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We can see in frame 2 that the DHCP message is sent to request a local IP address <code>192.168.30.108</code>:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Frame 2: 352 bytes on wire (2816 bits), 352 bytes captured (2816 bits)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dynamic Host Configuration Protocol (Request)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Message type: Boot Request (1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (53) DHCP Message Type (Request)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DHCP: Request (3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (61) Client identifier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Hardware type: Ethernet (0x01)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Client MAC address: Dell_4d:4f:ae (00:21:70:4d:4f:ae)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (50) Requested IP Address (192.168.30.108)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Requested IP Address: 192.168.30.108</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (12) Host Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Host Name: ann-laptop</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then, in frame 5, we see the reply/acknowledgement for the requeted IP address, the DNS server (<code>10.30.30.20</code>) and the DHCP server (<code>192.168.30.108</code>)</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Frame 5: 358 bytes on wire (2864 bits), 358 bytes captured (2864 bits)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dynamic Host Configuration Protocol (ACK)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Message type: Boot Reply (2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (53) DHCP Message Type (ACK)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DHCP: ACK (5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (54) DHCP Server Identifier (192.168.30.10)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DHCP Server Identifier: 192.168.30.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (51) IP Address Lease Time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        IP Address Lease Time: (3600s) 1 hour</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (58) Renewal Time Value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Renewal Time Value: (1800s) 30 minutes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (59) Rebinding Time Value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Rebinding Time Value: (3150s) 52 minutes, 30 seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (81) Client Fully Qualified Domain Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Flags: 0x00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            0000 .... = Reserved flags: 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .... 0... = Server DDNS: Some server updates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .... .0.. = Encoding: ASCII encoding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .... ..0. = Server overrides: No override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .... ...0 = Server: Client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        A-RR result: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        PTR-RR result: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Client name: ann-laptop.example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (1) Subnet Mask (255.255.255.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Subnet Mask: 255.255.255.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (6) Domain Name Server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Domain Name Server: 10.30.30.20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (46) NetBIOS over TCP/IP Node Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        NetBIOS over TCP/IP Node Type: H-node (8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (3) Router</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Length: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Router: 192.168.30.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Option: (255) End</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Option End: 255</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="keyword-search">Keyword Search<a href="#keyword-search" class="hash-link" aria-label="Direct link to Keyword Search" title="Direct link to Keyword Search">​</a></h3>
<p>A common way to find any information is to perform some search for keywords. Since we know the targets name is &#x27;Ann Dercover&#x27;, we can search for it within the packet capture.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">❯ ngrep </span><span class="token string" style="color:#e3116c">&quot;Ann&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-N</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-I</span><span class="token plain"> evidence-packet-analysis.pcap</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We can see that Ann sent message to get a fake passport which was split into a couple of messages (output was cleaned up):</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">T(6) 2011/05/17 22:33:08.648555 192.168.30.108:1685 -&gt; 205.188.58.10:143 [AP] #1615</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  From: &quot;Ann Dercover&quot; &lt;sneakyg33ky@aol.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  To: &lt;inter0pt1c@aol.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Subject: need a favor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Date: Tue, 17 May 2011 13:32:17 -0600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Hey, can you hook me up quick with that fake passport you were taking </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  about? - Ann</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  T(6) 2011/05/17 22:34:16.481132 192.168.30.108:1687 -&gt; 64.12.168.40:587 [A] #1749</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  From: &quot;Ann Dercover&quot; &lt;sneakyg33ky@aol.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  To: &lt;d4rktangent@gmail.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Subject: lunch next week</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Date: Tue, 17 May 2011 13:33:26 -0600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Sorry-- I can&#x27;t do lunch next week after all. Heading out of town. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Another time!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -Ann</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T(6) 2011/05/17 22:35:16.962873 192.168.30.108:1689 -&gt; 64.12.168.40:587 [A] #1825</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  From: &quot;Ann Dercover&quot; &lt;sneakyg33ky@aol.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  To: &lt;mistersekritx@aol.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Subject: rendezvous</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Date: Tue, 17 May 2011 13:34:26 -0600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Hi sweetheart! Bring your fake passport and a bathing suit. Address </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  attached. love, Ann</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And we see there&#x27;s an email attachment called <code>secretrendezvous.docx</code> and the base64 representation of this file:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">T(6) 2011/05/17 22:35:16.963123 192.168.30.108:1689 -&gt; 64.12.168.40:587 [A] #1826</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  it. Address attached. love, Ann&lt;/FONT&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Content-Type: application/octet-stream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name=&quot;secretrendezvous.docx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Content-Transfer-Encoding: base64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Content-Disposition: attachment;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  filename=&quot;secretrendezvous.docx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  UEsDBBQABgAIAAAAIQCht/xGcgEAAFIFAAATAAgCW0NvbnRlbnRfVHlwZXNdLnhtbCCiBAIooAAC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">....</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="carving-out-attachment">Carving Out Attachment<a href="#carving-out-attachment" class="hash-link" aria-label="Direct link to Carving Out Attachment" title="Direct link to Carving Out Attachment">​</a></h3>
<p>Putting this base64 payload into a file <code>evidence-packet-analysis-smtp3-attachment.b64.enc</code></p>
<p>We can take the base64 payload and decrypt it into a Microsoft Word document format:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">❯ base64 </span><span class="token parameter variable" style="color:#36acaa">-d</span><span class="token plain"> evidence-packet-analysis-smtp3-attachment.b64.enc </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> secretrendezvous.docx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❯ </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> secretrendezvous.docx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">secretrendezvous.docx: Microsoft Word </span><span class="token number" style="color:#36acaa">2007</span><span class="token plain">+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Opening the document, we can see that it has an image in png format. We can also carve it out:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">❯ </span><span class="token function" style="color:#d73a49">unzip</span><span class="token plain"> secretrendezvous.docx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Archive:  secretrendezvous.docx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inflating: </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">Content_Types</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inflating: _rels/.rels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inflating: word/_rels/document.xml.rels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inflating: word/document.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> extracting: word/media/image1.png</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inflating: word/theme/theme1.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inflating: word/settings.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inflating: word/webSettings.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inflating: docProps/core.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inflating: word/styles.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inflating: word/fontTable.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  inflating: docProps/app.xml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">❯ </span><span class="token function" style="color:#d73a49">open</span><span class="token plain"> word/media/image1.png</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/pcap">pcap</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/smtp">smtp</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/tshark">tshark</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/wireshark">wireshark</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/cybersecurity/Forensics/gdb/loading-coredump"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Loading Coredump into GDB</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/cybersecurity/Forensics/packet_analysis/smtp"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">smtp</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#description" class="table-of-contents__link toc-highlight">Description</a></li><li><a href="#mission" class="table-of-contents__link toc-highlight">Mission</a></li><li><a href="#network" class="table-of-contents__link toc-highlight">Network</a></li><li><a href="#evidence" class="table-of-contents__link toc-highlight">Evidence</a></li><li><a href="#analysis" class="table-of-contents__link toc-highlight">Analysis</a><ul><li><a href="#protocol-summary" class="table-of-contents__link toc-highlight">Protocol Summary</a></li><li><a href="#keyword-search" class="table-of-contents__link toc-highlight">Keyword Search</a></li><li><a href="#carving-out-attachment" class="table-of-contents__link toc-highlight">Carving Out Attachment</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Knowledgebase</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Knowledgebase</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/hack_blog">Hack Blog</a></li><li class="footer__item"><a href="https://github.com/kbbgl" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Kobbi's Knowledgebase, Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>