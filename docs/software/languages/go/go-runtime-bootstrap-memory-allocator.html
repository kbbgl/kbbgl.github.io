<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-software/languages/go/runtime-bootstrap-and-memory-allocator" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Go runtime bootstrap and memory allocator | Kobbi&#x27;s Knowledgebase</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kbbgl.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kbbgl.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kbbgl.github.io/docs/software/languages/go/go-runtime-bootstrap-memory-allocator"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Go runtime bootstrap and memory allocator | Kobbi&#x27;s Knowledgebase"><meta data-rh="true" name="description" content="This note condenses two excellent Internals for Interns articles into a mental model you can use while debugging performance, memory, and concurrency issues in Go."><meta data-rh="true" property="og:description" content="This note condenses two excellent Internals for Interns articles into a mental model you can use while debugging performance, memory, and concurrency issues in Go."><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://kbbgl.github.io/docs/software/languages/go/go-runtime-bootstrap-memory-allocator"><link data-rh="true" rel="alternate" href="https://kbbgl.github.io/docs/software/languages/go/go-runtime-bootstrap-memory-allocator" hreflang="en"><link data-rh="true" rel="alternate" href="https://kbbgl.github.io/docs/software/languages/go/go-runtime-bootstrap-memory-allocator" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://3OEAR0LK7K-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Kobbi&#39;s Knowledgebase RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Kobbi&#39;s Knowledgebase Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Kobbi&#39;s Knowledgebase" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.88614c44.css">
<script src="/assets/js/runtime~main.b66e5dc9.js" defer="defer"></script>
<script src="/assets/js/main.ab31b490.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Kobbi&#x27;s Knowledgebase</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" sidebarid="blogSidebar" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/software/chaos/add-flaky-network">Software</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/chaos/add-flaky-network">chaos</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/cicd/how-to-setup-gitlab-self-hosted-runner">cicd</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/containerization/docker/admin/get-list-containers-resource-usage">containerization</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/database/oracledb-cheatsheet">database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/infrastructure/artifactory/jfrog-artifactory-management">infrastructure</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/software/languages/ansible/ansible_cheat_sheet">languages</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/languages/ansible/ansible_cheat_sheet">ansible</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/languages/assembly/assemblers">assembly</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/languages/c/debugging/analyzing_coredump_with_gdb">c</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/languages/erlang/syntax">erlang</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/software/languages/go/channels-and-routines">go</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/channels-and-routines">Channels (chan) and goroutines (Concurrency)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/how-to-debug-go-code-delve">Using Delve Debugger</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/functions">Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/go-vc-env">Go Versions and Environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/interfaces">Interfaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/maps">Maps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/profiling-golang-using-pprof">How to Profile Golang application using pprof</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/run-tests">Run Tests in go</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/software/languages/go/go-runtime-bootstrap-memory-allocator">Go runtime bootstrap and memory allocator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/slices-and-loops">Slices and Loops</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/structs">Struct</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/type-conversion">Type Conversion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/using-package-modules-and-receiver-functions">Package Modules and Receiver Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/variables-and-types">Variables and Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/software/languages/go/writing-from-fs">Writing to Filesystem</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/languages/java/Debugging/Checking_JVMs_running_on_machine">java</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/languages/javascript/DevTools/Adding_logs_to_JavaScript_sourcecode">javascript</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/languages/powershell/arrays">powershell</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/languages/python/Development Environment/list-pipenv-interpreters">python</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/languages/regex/Find_pattern_recursively">regex</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/languages/shell/animation_in_script">shell</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/observability/splunk/splunk-cheat-sheet">observability</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/project_management/jira/keyboard-shortcuts">project_management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/system_design/reliable-scalable-maintainable">system_design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/software/version_control_systems/diff-files-ignore-lines">version_control_systems</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/hardware/cpu/computing-abstraction-layers">Hardware</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/os/UNIX/Account Management/Controlling_File_Directory_PERMISSIONS">Operating Systems</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/cybersecurity/Encryption/certificate-troubleshooting">Cybersecurity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/cloud_services/aws/aws-cli-cheatsheet">Cloud Services</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Software</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">languages</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">go</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Go runtime bootstrap and memory allocator</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Go runtime bootstrap and memory allocator</h1></header><p>This note condenses two excellent Internals for Interns articles into a mental model you can use while debugging performance, memory, and concurrency issues in Go.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="related-docs-in-this-repo">Related docs in this repo<a href="#related-docs-in-this-repo" class="hash-link" aria-label="Direct link to Related docs in this repo" title="Direct link to Related docs in this repo">​</a></h2>
<ul>
<li><strong>Profiling (heap/allocs/goroutines)</strong>: <a href="/docs/software/languages/go/profiling-golang-using-pprof"><code>pprof.md</code></a></li>
<li><strong>Concurrency basics (goroutines/channels)</strong>: <a href="/docs/software/languages/go/channels-and-routines"><code>channels-and-routines.md</code></a></li>
<li><strong>Debugging with Delve</strong>: <a href="/docs/software/languages/go/how-to-debug-go-code-delve"><code>debugger.md</code></a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="runtime-bootstrap-what-runs-before-mainmain">Runtime bootstrap: what runs before <code>main.main</code><a href="#runtime-bootstrap-what-runs-before-mainmain" class="hash-link" aria-label="Direct link to runtime-bootstrap-what-runs-before-mainmain" title="Direct link to runtime-bootstrap-what-runs-before-mainmain">​</a></h2>
<p>The entry point of a Go binary is <em>not</em> <code>main.main</code>. It starts in an architecture-specific runtime entry stub like <code>_rt0_amd64_linux</code>, which jumps into <code>rt0_go</code> to bootstrap the runtime. During this phase the runtime (roughly):</p>
<ul>
<li><strong>Creates <code>g0</code> and <code>m0</code></strong>: the initial goroutine (<code>g0</code>, used for runtime work) and initial OS thread (<code>m0</code>).</li>
<li><strong>Sets up TLS</strong>: thread-local storage is used so the runtime can quickly find “the current goroutine” for a given OS thread.</li>
<li><strong>Detects CPU capabilities</strong>: checks CPU/vendor features (and may refuse to run if required instructions aren’t available).</li>
<li><strong>Transitions into Go runtime init</strong>: saves args, initializes OS/CPU info (including a default <code>GOMAXPROCS</code>), then calls <code>schedinit()</code> which wires up the major subsystems.</li>
</ul>
<p>Inside <code>schedinit()</code> the runtime initializes key pieces such as:</p>
<ul>
<li><strong>Stack pools</strong>: goroutines start small (e.g. 2KB) and grow; stacks are pooled to make goroutine creation cheap.</li>
<li><strong>Allocator</strong> (<code>mallocinit()</code>): sets up heap management; later, per-<code>P</code> caches make the common allocation path lock-free.</li>
<li><strong>Map hashing selection</strong> (<code>alginit()</code>): chooses faster hashing (e.g. AES-based) when hardware support is present.</li>
<li><strong>Type/interface runtime tables</strong>: module/type/linkage structures plus interface dispatch tables (<code>itabs</code>).</li>
<li><strong>Environment and security checks</strong>: parses env vars (including <code>GODEBUG=*</code>) and validates stdio fds are open.</li>
<li><strong>GC is prepared but not enabled yet</strong>: <code>gcinit()</code> sets up GC machinery, but <code>gcenable()</code> happens later once the runtime can safely start goroutines/channels.</li>
</ul>
<p>Then the runtime creates the first “real” goroutine to run <strong><code>runtime.main</code></strong> (not your <code>main</code> yet). In <code>runtime.main</code>, it:</p>
<ul>
<li><strong>Starts the system monitor</strong> (<code>sysmon</code>): watchdog thread that helps with scheduling fairness, syscalls, GC pacing nudges, etc.</li>
<li><strong>Enables GC</strong> (<code>gcenable()</code>), then runs package <code>init()</code>s in dependency order.</li>
<li><strong>Calls your <code>main.main</code></strong>.</li>
</ul>
<p>One practical implication: when <strong><code>main</code> returns</strong>, the process is exiting; goroutines that are still running are not “gracefully completed” by default. Use explicit synchronization (e.g. <code>sync.WaitGroup</code>, context cancellation) if you need work to finish.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="runtime-debug-knobs-worth-remembering">Runtime debug knobs worth remembering<a href="#runtime-debug-knobs-worth-remembering" class="hash-link" aria-label="Direct link to Runtime debug knobs worth remembering" title="Direct link to Runtime debug knobs worth remembering">​</a></h3>
<p><code>GODEBUG</code> can emit high-signal traces during startup and runtime:</p>
<ul>
<li><strong><code>GODEBUG=inittrace=1</code></strong>: timings for package init.</li>
<li><strong><code>GODEBUG=schedtrace=1000</code></strong>: scheduler state every second.</li>
<li><strong><code>GODEBUG=gctrace=1</code></strong>: GC cycle logs.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="memory-allocator-how-heap-memory-is-organized-and-why-its-fast">Memory allocator: how heap memory is organized and why it’s fast<a href="#memory-allocator-how-heap-memory-is-organized-and-why-its-fast" class="hash-link" aria-label="Direct link to Memory allocator: how heap memory is organized and why it’s fast" title="Direct link to Memory allocator: how heap memory is organized and why it’s fast">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="stack-vs-heap-and-why-the-allocator-matters">Stack vs heap (and why the allocator matters)<a href="#stack-vs-heap-and-why-the-allocator-matters" class="hash-link" aria-label="Direct link to Stack vs heap (and why the allocator matters)" title="Direct link to Stack vs heap (and why the allocator matters)">​</a></h3>
<p>Not all variables go through the allocator. The compiler uses <strong>escape analysis</strong> to decide what can stay on the stack vs what must live on the heap (e.g. if it outlives the current function call). The allocator manages heap memory and also provides the backing memory for goroutine stacks (even though stack variables themselves are not individually “allocated” via the heap allocator).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="arenas--pages--spans--slots">Arenas → pages → spans → slots<a href="#arenas--pages--spans--slots" class="hash-link" aria-label="Direct link to Arenas → pages → spans → slots" title="Direct link to Arenas → pages → spans → slots">​</a></h3>
<p>The allocator avoids frequent OS syscalls by requesting memory in large chunks and managing it internally:</p>
<ul>
<li><strong>Arenas</strong>: typically <strong>64MB</strong> chunks of <em>address space</em> reserved from the OS (with OS-level commitment happening incrementally as memory is used).</li>
<li><strong>Pages</strong>: arenas are subdivided into <strong>8KB</strong> runtime pages (distinct from typical 4KB OS pages).</li>
<li><strong>Spans</strong>: one or more contiguous pages dedicated to objects of a single size (and scan vs noscan category).</li>
<li><strong>Slots</strong>: a span is subdivided into fixed-size slots; allocation is often “find next free slot”.</li>
</ul>
<p>Spans track allocation state with bitmaps such as:</p>
<ul>
<li><strong><code>allocBits</code></strong>: which slots are currently allocated.</li>
<li><strong><code>gcmarkBits</code></strong>: which slots were marked live by the GC in the last mark phase.</li>
</ul>
<p>After a GC mark phase, the runtime can effectively “free” dead objects by swapping/interpreting these bitmaps (live remains allocated; unmarked becomes available again).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="size-classes-8b--32kb-and-the-edges">Size classes (8B → 32KB) and the edges<a href="#size-classes-8b--32kb-and-the-edges" class="hash-link" aria-label="Direct link to Size classes (8B → 32KB) and the edges" title="Direct link to Size classes (8B → 32KB) and the edges">​</a></h3>
<p>For <strong>small objects (up to ~32KB)</strong>, allocations are rounded up to one of <strong>68 size classes</strong>. This keeps allocation fast and limits fragmentation inside spans.</p>
<p>Two important edge behaviors:</p>
<ul>
<li><strong>Large objects (&gt; 32KB)</strong>: bypass size classes and get their own “class 0” span sized to the object.</li>
<li><strong>Tiny allocator (&lt; 16B, no pointers)</strong>: packs multiple tiny, pointer-free objects into a single 16-byte block to reduce waste (so “1-byte things” don’t each consume an 8-byte slot).</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="span-classes-scan-vs-noscan">Span classes (scan vs noscan)<a href="#span-classes-scan-vs-noscan" class="hash-link" aria-label="Direct link to Span classes (scan vs noscan)" title="Direct link to Span classes (scan vs noscan)">​</a></h3>
<p>The allocator separates objects that <strong>contain pointers</strong> (must be scanned by GC) from those that <strong>do not</strong> (can be skipped). Combining:</p>
<ul>
<li><strong>size class</strong> × <strong>(scan|noscan)</strong></li>
</ul>
<p>…yields <strong>136 span classes</strong> in total.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="concurrency-mcache--mcentral--mheap">Concurrency: <code>mcache</code> → <code>mcentral</code> → <code>mheap</code><a href="#concurrency-mcache--mcentral--mheap" class="hash-link" aria-label="Direct link to concurrency-mcache--mcentral--mheap" title="Direct link to concurrency-mcache--mcentral--mheap">​</a></h3>
<p>To avoid allocator lock contention under heavy concurrency, Go uses a cache hierarchy:</p>
<ul>
<li><strong><code>mcache</code> (per-<code>P</code>, fast path, lock-free)</strong>: most allocations are served from a per-processor cache because only one goroutine runs on a <code>P</code> at a time.</li>
<li><strong><code>mcentral</code> (per span class, briefly locked)</strong>: refills <code>mcache</code> with spans when local spans are exhausted.</li>
<li><strong><code>mheap</code> (global, expensive/rare path)</strong>: supplies new pages/spans (and may request new arenas from the OS).</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sweeping-and-scavenging-reclaiming-memory">Sweeping and scavenging: reclaiming memory<a href="#sweeping-and-scavenging-reclaiming-memory" class="hash-link" aria-label="Direct link to Sweeping and scavenging: reclaiming memory" title="Direct link to Sweeping and scavenging: reclaiming memory">​</a></h3>
<ul>
<li><strong>Sweeping</strong>: spans may be swept lazily “on demand” when <code>mcentral</code> needs to reuse spans; sweeping interprets GC mark results to find free slots.</li>
<li><strong>Scavenging</strong>: even after objects are freed, the runtime often keeps pages mapped for reuse. A background scavenger can advise the OS to reclaim physical memory for unused pages (e.g. via <code>MADV_DONTNEED</code> on Linux) while keeping address space reserved.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-apply-this-when-profilingdebugging">How to apply this when profiling/debugging<a href="#how-to-apply-this-when-profilingdebugging" class="hash-link" aria-label="Direct link to How to apply this when profiling/debugging" title="Direct link to How to apply this when profiling/debugging">​</a></h2>
<ul>
<li>If you’re looking at heap growth, allocations, or goroutine state, jump to <a href="/docs/software/languages/go/profiling-golang-using-pprof"><code>pprof.md</code></a> for capture/compare commands (including <code>heap?gc=1</code>, goroutine dumps, and allocs sampling).</li>
<li>If you suspect allocator/GC pressure:<!-- -->
<ul>
<li>consider whether objects are <strong>tiny</strong> (packed), <strong>small</strong> (size classes), or <strong>large</strong> (&gt;32KB direct spans),</li>
<li>and whether your objects contain pointers (scan cost) vs not (noscan).</li>
</ul>
</li>
<li>If you see “work still running” at exit, remember that returning from <code>main</code> ends the process; coordinate goroutines explicitly.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sources">Sources<a href="#sources" class="hash-link" aria-label="Direct link to Sources" title="Direct link to Sources">​</a></h2>
<ul>
<li>Internals for Interns — <em>Understanding the Go Runtime: The Bootstrap</em>: <code>https://internals-for-interns.com/posts/understanding-go-runtime/</code></li>
<li>Internals for Interns — <em>Understanding the Go Runtime: The Memory Allocator</em>: <code>https://internals-for-interns.com/posts/go-memory-allocator/</code></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/go">go</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/runtime">runtime</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/memory">memory</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/allocator">allocator</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/gc">gc</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/scheduler">scheduler</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/performance">performance</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/profiling">profiling</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/software/languages/go/run-tests"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Run Tests in go</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/software/languages/go/slices-and-loops"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Slices and Loops</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#related-docs-in-this-repo" class="table-of-contents__link toc-highlight">Related docs in this repo</a></li><li><a href="#runtime-bootstrap-what-runs-before-mainmain" class="table-of-contents__link toc-highlight">Runtime bootstrap: what runs before <code>main.main</code></a><ul><li><a href="#runtime-debug-knobs-worth-remembering" class="table-of-contents__link toc-highlight">Runtime debug knobs worth remembering</a></li></ul></li><li><a href="#memory-allocator-how-heap-memory-is-organized-and-why-its-fast" class="table-of-contents__link toc-highlight">Memory allocator: how heap memory is organized and why it’s fast</a><ul><li><a href="#stack-vs-heap-and-why-the-allocator-matters" class="table-of-contents__link toc-highlight">Stack vs heap (and why the allocator matters)</a></li><li><a href="#arenas--pages--spans--slots" class="table-of-contents__link toc-highlight">Arenas → pages → spans → slots</a></li><li><a href="#size-classes-8b--32kb-and-the-edges" class="table-of-contents__link toc-highlight">Size classes (8B → 32KB) and the edges</a></li><li><a href="#span-classes-scan-vs-noscan" class="table-of-contents__link toc-highlight">Span classes (scan vs noscan)</a></li><li><a href="#concurrency-mcache--mcentral--mheap" class="table-of-contents__link toc-highlight">Concurrency: <code>mcache</code> → <code>mcentral</code> → <code>mheap</code></a></li><li><a href="#sweeping-and-scavenging-reclaiming-memory" class="table-of-contents__link toc-highlight">Sweeping and scavenging: reclaiming memory</a></li></ul></li><li><a href="#how-to-apply-this-when-profilingdebugging" class="table-of-contents__link toc-highlight">How to apply this when profiling/debugging</a></li><li><a href="#sources" class="table-of-contents__link toc-highlight">Sources</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Knowledgebase</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Knowledgebase</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/hack_blog">Hack Blog</a></li><li class="footer__item"><a href="https://github.com/kbbgl" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Kobbi's Knowledgebase, Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>