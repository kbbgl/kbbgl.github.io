"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[94868],{3243:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>o,toc:()=>d});var s=t(74848),r=t(28453);const c={},i="credstuf",o={permalink:"/blog/pico_2022/cryptography/credstuff/README",source:"@site/blog/pico_2022/cryptography/credstuff/README.md",title:"credstuf",description:"Description",date:"2024-09-26T20:55:31.413Z",tags:[],readingTime:1.135,hasTruncateMarker:!1,authors:[],frontMatter:{},unlisted:!1,prevItem:{title:"x-sixty-what",permalink:"/blog/pico_2022/binary_exploitation/x-sixty-what/README"},nextItem:{title:"Eavesdrop",permalink:"/blog/pico_2022/forensics/eavesdrop/README"}},a={authorsImageUrls:[]},d=[{value:"Description",id:"description",level:2},{value:"Research",id:"research",level:2}];function l(e){const n={a:"a",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,s.jsxs)(n.p,{children:["We found a leak of a blackmarket website's login credentials.\nCan you find the password of the user ",(0,s.jsx)(n.code,{children:"cultiris"})," and successfully decrypt it?"]}),"\n",(0,s.jsxs)(n.p,{children:["Download the leak ",(0,s.jsx)(n.a,{href:"https://artifacts.picoctf.net/c/534/leak.tar",children:"here"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["The first user in ",(0,s.jsx)(n.code,{children:"usernames.txt"})," corresponds to the first password in ",(0,s.jsx)(n.code,{children:"passwords.txt"}),". The second user corresponds to the second password, and so on."]}),"\n",(0,s.jsx)(n.h2,{id:"research",children:"Research"}),"\n",(0,s.jsxs)(n.p,{children:["We can find what line the username ",(0,s.jsx)(n.code,{children:"cultiris"})," is in by using ",(0,s.jsx)(n.code,{children:"awk"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"awk '/cultiris/{ print NR; exit }' usernames.txt\n378\n"})}),"\n",(0,s.jsx)(n.p,{children:"Let's see what's printed in this line in the passwords file:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sed -n 378p passwords.txt\ncvpbPGS{P7e1S_54I35_71Z3}\n"})}),"\n",(0,s.jsx)(n.p,{children:"In line 204, we find:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sed -n 204p usernames.txt\npico\n\nsed -n 204p passwords.txt\npICo7rYpiCoU51N6PicOr0t13\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If we look at the last 5 characters of the password in line 204, ",(0,s.jsx)(n.code,{children:"r0t13"}),", we see that there's a hint as to what type of cipher is used to encrypt the password, namely ROT13. It basically replaces the letter in the sequence with a letter 13 characters up in the alphabet."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://upload.wikimedia.org/wikipedia/commons/2/2a/ROT13.png",alt:""})}),"\n",(0,s.jsxs)(n.p,{children:["Since we know that the expected flag format is ",(0,s.jsx)(n.code,{children:"picoCTF{SOMEFLAG}"}),", we can test out the ROT13 with the first few letters:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"c + 13 = p\nv - 13 = i\np - 13 = c\nb + 13 = o\n"})}),"\n",(0,s.jsx)(n.p,{children:"We can use the built-in Python ROT13 decoder to get the flag:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import codecs\ncodecs.decode('cvpbPGS{P7e1S_54I35_71Z3}', 'rot_13')\n'picoCTF{C7r1F_54V35_71M3}'\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var s=t(96540);const r={},c=s.createContext(r);function i(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);