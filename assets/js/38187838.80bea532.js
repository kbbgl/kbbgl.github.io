"use strict";(globalThis.webpackChunkkgkb=globalThis.webpackChunkkgkb||[]).push([[31065],{44524:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>c});var l=s(74848),r=s(28453);const t={slug:"os-linux-network-firewalls-tcp-wrappers",title:"TCP Wrappers",authors:["kbbgl"],tags:["os","linux","network","firewalls","tcp_wrappers"]},i="TCP Wrappers",a={id:"os/linux/network/firewalls/TCP_Wrappers",title:"TCP Wrappers",description:"The TCP Wrappers system is a host-based network firewall and ACL. Originally, it only protected the inetd system, but has now been extended with the shared object library libwrap.",source:"@site/docs/os/linux/network/firewalls/TCP_Wrappers.md",sourceDirName:"os/linux/network/firewalls",slug:"/os/linux/network/firewalls/os-linux-network-firewalls-tcp-wrappers",permalink:"/docs/os/linux/network/firewalls/os-linux-network-firewalls-tcp-wrappers",draft:!1,unlisted:!1,tags:[{inline:!0,label:"os",permalink:"/docs/tags/os"},{inline:!0,label:"linux",permalink:"/docs/tags/linux"},{inline:!0,label:"network",permalink:"/docs/tags/network"},{inline:!0,label:"firewalls",permalink:"/docs/tags/firewalls"},{inline:!0,label:"tcp_wrappers",permalink:"/docs/tags/tcp-wrappers"}],version:"current",frontMatter:{slug:"os-linux-network-firewalls-tcp-wrappers",title:"TCP Wrappers",authors:["kbbgl"],tags:["os","linux","network","firewalls","tcp_wrappers"]},sidebar:"docsSidebar",previous:{title:"Filter, NAT and Mangle Tables",permalink:"/docs/os/linux/network/firewalls/os-linux-network-firewalls-filter-nat-and-mangle-tables"},next:{title:"`iptables` Command",permalink:"/docs/os/linux/network/firewalls/os-linux-network-firewalls-iptables-command"}},o={},c=[];function d(e){const n={code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"tcp-wrappers",children:"TCP Wrappers"})}),"\n",(0,l.jsxs)(n.p,{children:["The TCP Wrappers system is a host-based network firewall and ACL. Originally, it only protected the ",(0,l.jsx)(n.code,{children:"inetd"})," system, but has now been extended with the shared object library ",(0,l.jsx)(n.code,{children:"libwrap"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:["The configuration for ",(0,l.jsx)(n.code,{children:"tcpwrappers"})," is handled by two files, ",(0,l.jsx)(n.code,{children:"/etc/hosts.allow"})," and ",(0,l.jsx)(n.code,{children:"/etc/hosts.deny"}),". Both files have the same syntax:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# <DAEMON>:<CLIENT>\n"})}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"<DAEMON>"})," should match the name of the binary of the service (e.g. ",(0,l.jsx)(n.code,{children:"sshd"}),"). The ",(0,l.jsx)(n.code,{children:"<CLIENT>"})," pattern can be:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["An IP address: ",(0,l.jsx)(n.code,{children:"10.30.21.7"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["A network/netmask: ",(0,l.jsx)(n.code,{children:"10.30.21.0/255.255.255.0"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["A domain name: ",(0,l.jsx)(n.code,{children:".foo.example.com"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["A partial address: ",(0,l.jsx)(n.code,{children:"10.30.21"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:["A file name full of the above patterns: ",(0,l.jsx)(n.code,{children:"/etc/ssh-hosts.allow"}),"."]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["When traffic comes to a ",(0,l.jsx)(n.code,{children:"libwrap-enabled"})," daemon, those two files are consulted to see the following:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["If the pattern matches in ",(0,l.jsx)(n.code,{children:"/etc/hosts.allow"}),", the traffic is permitted."]}),"\n",(0,l.jsxs)(n.li,{children:["If the pattern is not found in ",(0,l.jsx)(n.code,{children:"/etc/hosts.allow"}),", and it matches in ",(0,l.jsx)(n.code,{children:"/etc/hosts.deny"}),", the traffic will be denied."]}),"\n",(0,l.jsx)(n.li,{children:"If the pattern does not match in either file, the traffic will be permitted."}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Below you will find some examples of TCP wrappers:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"hosts.allow\nvsftpd:ALL\nALL:LOCAL\nALL:10\nALL:.example.com EXCEPT untrusted.example.com\n\nhosts.deny\nALL:ALL\n"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>a});var l=s(96540);const r={},t=l.createContext(r);function i(e){const n=l.useContext(t);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),l.createElement(t.Provider,{value:n},e.children)}}}]);