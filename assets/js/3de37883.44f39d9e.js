"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[99172],{87066:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>c,toc:()=>l});var s=t(74848),r=t(28453);const o={},i="Eavesdrop",c={permalink:"/blog/pico_2022/forensics/eavesdrop/README",source:"@site/blog/pico_2022/forensics/eavesdrop/README.md",title:"Eavesdrop",description:"Description",date:"2024-09-26T20:55:31.413Z",tags:[],readingTime:1.14,hasTruncateMarker:!1,authors:[],frontMatter:{},unlisted:!1,prevItem:{title:"credstuf",permalink:"/blog/pico_2022/cryptography/credstuff/README"},nextItem:{title:"Enhance!",permalink:"/blog/pico_2022/forensics/enhance/README"}},a={authorsImageUrls:[]},l=[{value:"Description",id:"description",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h2:"h2",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,s.jsxs)(n.p,{children:["Download ",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(85228).A+"",children:"this packet"})," capture and find the flag."]}),"\n",(0,s.jsx)(n.p,{children:"Opening the dump in Wireshark, we can see that there's some conversation going on. By following the TCP stream, we can read the whole exchange:"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["Hey, how do you decrypt this file again?",(0,s.jsx)(n.br,{}),"\n","You're serious?",(0,s.jsx)(n.br,{}),"\n","Yeah, I'm serious"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"openssl des3 -d -salt -in file.des3 -out file.txt -k supersecretpassword123\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["Ok, great, thanks.",(0,s.jsx)(n.br,{}),"\n","Let's use Discord next time, it's more secure.",(0,s.jsx)(n.br,{}),"\n","C'mon, no one knows we use this program like this!",(0,s.jsx)(n.br,{}),"\n","Whatever.",(0,s.jsx)(n.br,{}),"\n","Hey.",(0,s.jsx)(n.br,{}),"\n","Yeah?",(0,s.jsx)(n.br,{}),"\n","Could you transfer the file to me again?",(0,s.jsx)(n.br,{}),"\n","Oh great. Ok, over 9002?",(0,s.jsx)(n.br,{}),"\n","Yeah, listening.",(0,s.jsx)(n.br,{}),"\n","Sent it",(0,s.jsx)(n.br,{}),"\n","Got it.",(0,s.jsx)(n.br,{}),"\n","You're unbelievable"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["So we know that the file will be sent over port ",(0,s.jsx)(n.code,{children:"9002"})," and we know it's going to be encrypted using Triple DES cipher."]}),"\n",(0,s.jsxs)(n.p,{children:["Adding the filter ",(0,s.jsx)(n.code,{children:"tcp.port == 9002"})," to Wireshark, we see that the following packet contains some data"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"57\t205.302713\t10.0.2.15\t10.0.2.4\tTCP\t114\t56370 \u2192 9002 [PSH, ACK] Seq=1 Ack=1 Win=64256 Len=48 TSval=3517420532 TSecr=1765870695\n"})}),"\n",(0,s.jsx)(n.p,{children:"If we export packet as bytes (CTRL + SHIFT + X), we get the file we need to feed into OpenSSL:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"> openssl des3 -d -in wireshark_export.des3 -out flag.txt -k supersecretpassword123\n*** WARNING : deprecated key derivation used.\nUsing -iter or -pbkdf2 would be better.\n\n> cat flag.txt\n\npicoCTF{nc_73115_411_5786acc3}\n"})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},85228:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/files/capture.flag-a500e88a2803dcc151cfa087354297a1.pcap"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>c});var s=t(96540);const r={},o=s.createContext(r);function i(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);