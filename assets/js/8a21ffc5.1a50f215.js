"use strict";(globalThis.webpackChunkkgkb=globalThis.webpackChunkkgkb||[]).push([[5685],{8752:(e,r,a)=>{a.r(r),a.d(r,{assets:()=>c,contentTitle:()=>s,default:()=>g,frontMatter:()=>t,metadata:()=>n,toc:()=>l});var o=a(74848),i=a(28453);const t={slug:"how-to-create-docker-image-cloud",title:"How To Create Docker Image in Cloud Provider Registry",authors:["kgal-akl"],tags:["docker","registry","images","google_cloud","aws_ecr","ecr","artifacts"]},s=void 0,n={id:"software/containerization/docker/registry/create-dev-image",title:"How To Create Docker Image in Cloud Provider Registry",description:"When developing features for certain applications (where these application are run as containers, e.g. KEDA, Dapr), we need to create a new Docker image to test out our changes. This guide explains how to do that using Google Cloud Artifact Registry and Amazon Web Services ECR.",source:"@site/docs/software/containerization/docker/registry/create-dev-image.md",sourceDirName:"software/containerization/docker/registry",slug:"/software/containerization/docker/registry/how-to-create-docker-image-cloud",permalink:"/docs/software/containerization/docker/registry/how-to-create-docker-image-cloud",draft:!1,unlisted:!1,tags:[{inline:!0,label:"docker",permalink:"/docs/tags/docker"},{inline:!0,label:"registry",permalink:"/docs/tags/registry"},{inline:!0,label:"images",permalink:"/docs/tags/images"},{inline:!0,label:"google_cloud",permalink:"/docs/tags/google-cloud"},{inline:!0,label:"aws_ecr",permalink:"/docs/tags/aws-ecr"},{inline:!0,label:"ecr",permalink:"/docs/tags/ecr"},{inline:!0,label:"artifacts",permalink:"/docs/tags/artifacts"}],version:"current",frontMatter:{slug:"how-to-create-docker-image-cloud",title:"How To Create Docker Image in Cloud Provider Registry",authors:["kgal-akl"],tags:["docker","registry","images","google_cloud","aws_ecr","ecr","artifacts"]},sidebar:"docsSidebar",previous:{title:"Use Host Network",permalink:"/docs/software/containerization/docker/network/set-host-net"},next:{title:"quay.io Tutorial",permalink:"/docs/software/containerization/docker/registry/quay-io-tutorial"}},c={},l=[{value:"GCP",id:"gcp",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"Create a Repository",id:"create-a-repository",level:3},{value:"Make Repository Public",id:"make-repository-public",level:3},{value:"Make Repository Private",id:"make-repository-private",level:3},{value:"AWS ECR",id:"aws-ecr",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Create Repository",id:"create-repository",level:3},{value:"Authenticate Docker",id:"authenticate-docker",level:3},{value:"List Images",id:"list-images",level:3}];function d(e){const r={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(r.p,{children:["When developing features for certain applications (where these application are run as containers, e.g. ",(0,o.jsx)(r.a,{href:"https://github.com/kedacore/keda",children:"KEDA"}),", ",(0,o.jsx)(r.a,{href:"https://github.com/dapr/components-contrib",children:"Dapr"}),"), we need to create a new Docker image to test out our changes. This guide explains how to do that using Google Cloud Artifact Registry and Amazon Web Services ECR."]}),"\n",(0,o.jsx)(r.h2,{id:"gcp",children:"GCP"}),"\n",(0,o.jsx)(r.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsx)(r.p,{children:"Enable the Artifact Registry service using the Google Cloud CLI:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"gcloud services enable artifactregistry.googleapis.com\n"})}),"\n",(0,o.jsx)(r.p,{children:"Configure the relevant Google Cloud Platform details:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"export GCP_LOCATION=us-east\nexport GCP_PROJECT=keda-test-env\nexport GCP_REPO_NAME=keda\n"})}),"\n",(0,o.jsx)(r.h3,{id:"create-a-repository",children:"Create a Repository"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:'gcloud artifacts repositories create $GCP_REPO_NAME \\\n    --repository-format=docker \\\n    --location=$GCP_LOCATION \\\n    --project=$GCP_PROJECT \\\n    --description="Docker repository for $GCP_REPO_NAME-related images"\n'})}),"\n",(0,o.jsx)(r.h3,{id:"make-repository-public",children:"Make Repository Public"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"gcloud artifacts repositories add-iam-policy-binding $GCP_REPO_NAME \\\n    --location=$GCP_LOCATION \\\n    --member='allUsers' \\\n    --role='roles/artifactregistry.reader' \\\n    --project=$GCP_PROJECT\n"})}),"\n",(0,o.jsx)(r.h3,{id:"make-repository-private",children:"Make Repository Private"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"gcloud artifacts repositories remove-iam-policy-binding $GCP_REPO_NAME \\\n    --location=$GCP_LOCATION \\\n    --member='allUsers' \\\n    --role='roles/artifactregistry.reader' \\\n    --project=$GCP_PROJECT\n"})}),"\n",(0,o.jsx)(r.h2,{id:"aws-ecr",children:"AWS ECR"}),"\n",(0,o.jsx)(r.h3,{id:"configuration",children:"Configuration"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:'export AWS_ACCOUNT_ID=1234\nexport AWS_REGION="us-east-1"\nexport REPO_NAME=dapr\n'})}),"\n",(0,o.jsx)(r.h3,{id:"create-repository",children:"Create Repository"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"aws ecr create-repository --repository-name $REPO_NAME --region $AWS_REGION\n"})}),"\n",(0,o.jsx)(r.h3,{id:"authenticate-docker",children:"Authenticate Docker"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"aws ecr get-login-password --region $AWS_REGION | docker login --username AWS --password-stdin $AWS_ACCOUNT_ID.dkr.ecr.$AWS_REGION.amazonaws.com\n"})}),"\n",(0,o.jsx)(r.h3,{id:"list-images",children:"List Images"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-bash",children:"aws ecr list-images --repository-name $REPO_NAME --no-cli-pager\n"})})]})}function g(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,r,a)=>{a.d(r,{R:()=>s,x:()=>n});var o=a(96540);const i={},t=o.createContext(i);function s(e){const r=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function n(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(t.Provider,{value:r},e.children)}}}]);