"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[21237],{57289:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>d});var r=t(74848),s=t(28453);const a={},o=void 0,i={id:"software/containerization/k8s/Installation and Configuration/upgrade_cluster",title:"upgrade_cluster",description:"Upgrade Cluster",source:"@site/docs/software/containerization/k8s/Installation and Configuration/upgrade_cluster.md",sourceDirName:"software/containerization/k8s/Installation and Configuration",slug:"/software/containerization/k8s/Installation and Configuration/upgrade_cluster",permalink:"/docs/software/containerization/k8s/Installation and Configuration/upgrade_cluster",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"tools",permalink:"/docs/software/containerization/k8s/Installation and Configuration/tools"},next:{title:"Cluster_Start_Sequence",permalink:"/docs/software/containerization/k8s/Logging and Troubleshooting/Cluster_Start_Sequence"}},l={},d=[{value:"Upgrade Cluster",id:"upgrade-cluster",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"upgrade-cluster",children:"Upgrade Cluster"}),"\n",(0,r.jsxs)(n.p,{children:["If the cluster was built using ",(0,r.jsx)(n.code,{children:"kubeadm"}),", ",(0,r.jsx)(n.code,{children:"kubeadm upgrade"})," can be used to upgrade a cluster."]}),"\n",(0,r.jsx)(n.p,{children:"To compare the installed version with the latest and if it's posssible to upgrade:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo kubeadm upgrade plan\n"})}),"\n",(0,r.jsx)(n.p,{children:"To upgrade first control plane to specified version:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo kubeadm apply\n"})}),"\n",(0,r.jsxs)(n.p,{children:["To show the differences applied during the upgrade (similar to ",(0,r.jsx)(n.code,{children:"kubectl apply --dry-run"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo kubeadm diff\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This allows for updating the local ",(0,r.jsx)(n.code,{children:"kubelet"})," configuration on worker nodes, or the control planes of other master nodes if there is more than one. Also, it will access a phase command to step through the upgrade process:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo kubeadm node\n"})}),"\n",(0,r.jsx)(n.p,{children:"General upgrade process:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Update the software"}),"\n",(0,r.jsx)(n.li,{children:"Check the software version"}),"\n",(0,r.jsx)(n.li,{children:"Drain the control plane"}),"\n",(0,r.jsx)(n.li,{children:"View the planned upgrade"}),"\n",(0,r.jsx)(n.li,{children:"Apply the upgrade"}),"\n",(0,r.jsx)(n.li,{children:"Uncordon the control plane to allow pods to be scheduled."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/",children:"Full details"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>i});var r=t(96540);const s={},a=r.createContext(s);function o(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);