"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[61296],{75022:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>d});var t=n(74848),r=n(28453);const l={},i="TCP Wrappers",o={id:"os/UNIX/Network/Firewalls/TCP_Wrappers",title:"TCP Wrappers",description:"The TCP Wrappers system is a host-based network firewall and ACL. Originally, it only protected the inetd system, but has now been extended with the shared object library libwrap.",source:"@site/docs/os/UNIX/Network/Firewalls/TCP_Wrappers.md",sourceDirName:"os/UNIX/Network/Firewalls",slug:"/os/UNIX/Network/Firewalls/TCP_Wrappers",permalink:"/docs/os/UNIX/Network/Firewalls/TCP_Wrappers",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Filter, NAT and Mangle Tables",permalink:"/docs/os/UNIX/Network/Firewalls/Filter,_NAT_and_Mangle_Tables"},next:{title:"iptables Command",permalink:"/docs/os/UNIX/Network/Firewalls/iptables_Command"}},a={},d=[];function c(e){const s={code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"tcp-wrappers",children:"TCP Wrappers"})}),"\n",(0,t.jsxs)(s.p,{children:["The TCP Wrappers system is a host-based network firewall and ACL. Originally, it only protected the ",(0,t.jsx)(s.code,{children:"inetd"})," system, but has now been extended with the shared object library ",(0,t.jsx)(s.code,{children:"libwrap"}),"."]}),"\n",(0,t.jsxs)(s.p,{children:["The configuration for ",(0,t.jsx)(s.code,{children:"tcpwrappers"})," is handled by two files, ",(0,t.jsx)(s.code,{children:"/etc/hosts.allow"})," and ",(0,t.jsx)(s.code,{children:"/etc/hosts.deny"}),". Both files have the same syntax:"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"# <DAEMON>:<CLIENT>\n"})}),"\n",(0,t.jsxs)(s.p,{children:["The ",(0,t.jsx)(s.code,{children:"<DAEMON>"})," should match the name of the binary of the service (e.g. ",(0,t.jsx)(s.code,{children:"sshd"}),"). The ",(0,t.jsx)(s.code,{children:"<CLIENT>"})," pattern can be:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["An IP address: ",(0,t.jsx)(s.code,{children:"10.30.21.7"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:["A network/netmask: ",(0,t.jsx)(s.code,{children:"10.30.21.0/255.255.255.0"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:["A domain name: ",(0,t.jsx)(s.code,{children:".foo.example.com"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:["A partial address: ",(0,t.jsx)(s.code,{children:"10.30.21"}),"."]}),"\n",(0,t.jsxs)(s.li,{children:["A file name full of the above patterns: ",(0,t.jsx)(s.code,{children:"/etc/ssh-hosts.allow"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(s.p,{children:["When traffic comes to a ",(0,t.jsx)(s.code,{children:"libwrap-enabled"})," daemon, those two files are consulted to see the following:"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["If the pattern matches in ",(0,t.jsx)(s.code,{children:"/etc/hosts.allow"}),", the traffic is permitted."]}),"\n",(0,t.jsxs)(s.li,{children:["If the pattern is not found in ",(0,t.jsx)(s.code,{children:"/etc/hosts.allow"}),", and it matches in ",(0,t.jsx)(s.code,{children:"/etc/hosts.deny"}),", the traffic will be denied."]}),"\n",(0,t.jsx)(s.li,{children:"If the pattern does not match in either file, the traffic will be permitted."}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"Below you will find some examples of TCP wrappers:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-bash",children:"hosts.allow\nvsftpd:ALL\nALL:LOCAL\nALL:10\nALL:.example.com EXCEPT untrusted.example.com\n\nhosts.deny\nALL:ALL\n"})})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>o});var t=n(96540);const r={},l=t.createContext(r);function i(e){const s=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(l.Provider,{value:s},e.children)}}}]);