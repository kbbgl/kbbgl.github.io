"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[68936],{69019:(e,n,d)=>{d.r(n),d.d(n,{assets:()=>t,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>l});var s=d(74848),i=d(28453);const o={},r="udev",c={id:"os/UNIX/Kernel/udev",title:"udev",description:"udev is a device manager for the Linux kernel. It manages device nodes in /dev. It also handles all user space events raised when HW devices are added or removed into the system.",source:"@site/docs/os/UNIX/Kernel/udev.md",sourceDirName:"os/UNIX/Kernel",slug:"/os/UNIX/Kernel/udev",permalink:"/docs/os/UNIX/Kernel/udev",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Modules",permalink:"/docs/os/UNIX/Kernel/module"},next:{title:"Displaying Native GUI Notifications from Bash",permalink:"/docs/os/UNIX/Mac OS/gui_notifications"}},t={},l=[{value:"Device Nodes",id:"device-nodes",level:2},{value:"<code>udev</code> Components",id:"udev-components",level:2},{value:"Configuration",id:"configuration",level:2},{value:"How <code>udev</code> Loads Devices",id:"how-udev-loads-devices",level:2},{value:"Rule Files",id:"rule-files",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"udev",children:(0,s.jsx)(n.code,{children:"udev"})})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"udev"})," is a device manager for the Linux kernel. It manages device nodes in ",(0,s.jsx)(n.code,{children:"/dev"}),". It also handles all user space events raised when HW devices are added or removed into the system."]}),"\n",(0,s.jsx)(n.h2,{id:"device-nodes",children:"Device Nodes"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"/dev"})," directory includes different device nodes such as network and block devices."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://us.v-cdn.net/6030874/uploads/editor/vi/n36syvedw95x.png",alt:"udev"})}),"\n",(0,s.jsx)(n.p,{children:"Device nodes can be created:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo mknod [-m mode] /dev/name\n\n# e.g.\nsudo mknod -m 666 /dev/mycdrv c 254 1\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Device drivers can manage multiple devices nodes. To identify the driver associated with a device, there are ",(0,s.jsx)(n.strong,{children:"major"})," and ",(0,s.jsx)(n.strong,{children:"minor"})," numbers. Device nodes of the same type (e.g. block) with the same major number use the same driver."]}),"\n",(0,s.jsx)(n.p,{children:"We can see the major/minor numbers:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ll /dev/sda*\n\n# major is 8, minor is 0-3\nbrw-rw---- 1 root disk 8, 0 Dec 31 11:10 /dev/sda\nbrw-rw---- 1 root disk 8, 1 Dec 31 11:10 /dev/sda1\nbrw-rw---- 1 root disk 8, 2 Dec 31 11:10 /dev/sda2\nbrw-rw---- 1 root disk 8, 3 Dec 31 11:10 /dev/sda3\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"udev-components",children:[(0,s.jsx)(n.code,{children:"udev"})," Components"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"udev"})," is built upon 3 components:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"libudev"})," library which allows access to devices' informations."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"udevd"})," or ",(0,s.jsx)(n.code,{children:"systemd-udevd"})," which manages the devices in ",(0,s.jsx)(n.code,{children:"/dev"})," directory."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"udevadm"}),", a tool for diagnostics and control."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsxs)(n.p,{children:["The main configuration file can be found in ",(0,s.jsx)(n.code,{children:"/etc/udev/udev.conf"})," which contains information about where to place device nodes, permissions, etc. The rules for device naming are kept in ",(0,s.jsx)(n.code,{children:"/etc/udev/rules.d"})," and ",(0,s.jsx)(n.code,{children:"/usr/lib/udev/rules.d"}),"."]}),"\n",(0,s.jsxs)(n.h2,{id:"how-udev-loads-devices",children:["How ",(0,s.jsx)(n.code,{children:"udev"})," Loads Devices"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"udev"})," runs a daemon (either ",(0,s.jsx)(n.code,{children:"udevd"})," or ",(0,s.jsx)(n.code,{children:"systemd-udevd"}),") and monitors a netlink socket (communication between kernel and user space)."]}),"\n",(0,s.jsxs)(n.p,{children:["The hotplug kernel subsystem dynamically handles the addition and removal of devices, by loading the appropriate drivers and by creating the corresponding device files (with the help of ",(0,s.jsx)(n.code,{children:"udevd"}),"). When ",(0,s.jsx)(n.code,{children:"udev"})," is notified by the kernel of the appearance of a new device, it collects various information on the given device by consulting the corresponding entries in ",(0,s.jsx)(n.code,{children:"/sys/"}),". Armed with all of this information, ",(0,s.jsx)(n.code,{children:"udev"})," then consults all of the rules contained in ",(0,s.jsx)(n.code,{children:"/etc/udev/rules.d/"})," and ",(0,s.jsx)(n.code,{children:"/lib/udev/rules.d/"}),". In this process it decides how to name the device, what symbolic links to create (to give it alternative names), and what commands to execute. All of these files are consulted, and the rules are all evaluated sequentially."]}),"\n",(0,s.jsx)(n.h2,{id:"rule-files",children:"Rule Files"}),"\n",(0,s.jsxs)(n.p,{children:["All rule files are located in ",(0,s.jsx)(n.code,{children:"/etc/udev/rules.d/$rulename.rules"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},28453:(e,n,d)=>{d.d(n,{R:()=>r,x:()=>c});var s=d(96540);const i={},o=s.createContext(i);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);