"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[60157],{58793:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>l});var i=t(74848),o=t(28453);const s={},a=void 0,r={id:"software/containerization/k8s/Custom Resource Definitions/Optional_Hooks",title:"Optional_Hooks",description:"Optional Hooks",source:"@site/docs/software/containerization/k8s/Custom Resource Definitions/5._Optional_Hooks.md",sourceDirName:"software/containerization/k8s/Custom Resource Definitions",slug:"/software/containerization/k8s/Custom Resource Definitions/Optional_Hooks",permalink:"/docs/software/containerization/k8s/Custom Resource Definitions/Optional_Hooks",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"New_Object_Definition",permalink:"/docs/software/containerization/k8s/Custom Resource Definitions/New_Object_Definition"},next:{title:"Understanding_Aggregated_APIs",permalink:"/docs/software/containerization/k8s/Custom Resource Definitions/Understanding_Aggregated_APIs"}},c={},l=[{value:"Optional Hooks",id:"optional-hooks",level:2}];function d(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"optional-hooks",children:"Optional Hooks"}),"\n",(0,i.jsxs)(n.p,{children:["Just as with built-in objects, you can use an asynchronous pre-delete hook known as a ",(0,i.jsx)(n.code,{children:"Finalizer"}),". If an API delete request is received, the object metadata field ",(0,i.jsx)(n.code,{children:"metadata.deletionTimestamp"})," is updated. The controller then triggers whichever finalizer has been configured. When the finalizer completes, it is removed from the list. The controller continues to complete and remove finalizers until the string is empty. Then, the object itself is deleted."]}),"\n",(0,i.jsx)(n.p,{children:"Finalizer:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"metadata:\n  finalizers:\n  - finalizer.stable.linux.com\n"})}),"\n",(0,i.jsx)(n.p,{children:"Validation:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"validation:\n    openAPIV3Schema:\n      properties:\n        spec:\n          properties:\n            timeSpec:\n              type: string \n              pattern: '^(\\d+|\\*)(/\\d+)?(\\s+(\\d+|\\*)(/\\d+)?){4}$'\n            replicas:\n              type: integer\n              minimum: 1\n              maximum: 10\n"})}),"\n",(0,i.jsxs)(n.p,{children:["A feature in beta starting with v1.9 allows for validation of custom objects via the OpenAPI v3 schema. This will check various properties of the object configuration being passed by the API server. In the example above, the ",(0,i.jsx)(n.code,{children:"timeSpec"})," must be a string matching a particular pattern and the number of allowed replicas is between 1 and 10. If the validation does not match, the error returned is the failed line of validation."]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var i=t(96540);const o={},s=i.createContext(o);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);