"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[51512],{3136:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var r=t(74848),o=t(28453);const i={},c="Transformation",a={permalink:"/blog/pico_2022/reverse_engineering/transformation/README",source:"@site/blog/pico_2022/reverse_engineering/transformation/README.md",title:"Transformation",description:"Given the following Python code:",date:"2024-09-26T20:59:28.000Z",tags:[],readingTime:.88,hasTruncateMarker:!1,authors:[],frontMatter:{},unlisted:!1,prevItem:{title:"unpackme",permalink:"/blog/pico_2022/reverse_engineering/unpackme/README"},nextItem:{title:"Forbidden Paths",permalink:"/blog/pico_2022/web_exploitation/forbidden_paths/README"}},s={authorsImageUrls:[]},d=[];function l(e){const n={code:"code",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"Given the following Python code:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"''.join([chr((ord(flag[i]) << 8) + ord(flag[i + 1])) for i in range(0, len(flag), 2)])\n"})}),"\n",(0,r.jsx)(n.p,{children:"and a file containing UTF-8 encoded Chinese characters:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"file enc&&cat enc\nenc: UTF-8 Unicode text, with no line terminators\n\u7069\u636f\u4354\u467b\u3136\u5f62\u6974\u735f\u696e\u7374\u3334\u645f\u6f66\u5f38\u5f32\u3636\u3834\u6332\u307d%\n"})}),"\n",(0,r.jsx)(n.p,{children:"Let's break down the supplied Python code:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"''.join(\n\t[\n\t\tchr((ord(flag[i]) << 8) + ord(flag[i + 1])) \n            for i in range(0, len(flag), 2)\n\t]\n)\n"})}),"\n",(0,r.jsxs)(n.p,{children:["We can see that we can see that the flag is being encoded with the code above. It's encoding it by constructing a string by ",(0,r.jsx)(n.code,{children:"join"}),"ing a ",(0,r.jsx)(n.code,{children:"list"})," of 2 characters (notice the last argument supplied to the ",(0,r.jsx)(n.code,{children:"range"})," function). These pairs of characters are calculated by adding the the Unicode characters (returned by ",(0,r.jsx)(n.code,{children:"ord"})," function) of the ",(0,r.jsx)(n.code,{children:"n"}),"th and ",(0,r.jsx)(n.code,{children:"n + 1"}),"th character. The ",(0,r.jsx)(n.code,{children:"n"}),"th character is shifted to the left by 8 bits before it's added."]}),"\n",(0,r.jsx)(n.p,{children:"This means that in order to get the flag, we would need to build a decoder"})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>a});var r=t(96540);const o={},i=r.createContext(o);function c(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);