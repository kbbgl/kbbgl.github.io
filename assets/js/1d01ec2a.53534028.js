"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[79242],{5941:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var r=n(74848),a=n(28453);const o={},t="Server Message Block (SMB)",i={id:"os/UNIX/Network/Network Filesystems/SMB",title:"Server Message Block (SMB)",description:"The Server Message Block (SMB) protocol was originally designed at IBM and later incorporated as the de facto networking file/print sharing system for Microsoft Windows.",source:"@site/docs/os/UNIX/Network/Network Filesystems/SMB.md",sourceDirName:"os/UNIX/Network/Network Filesystems",slug:"/os/UNIX/Network/Network Filesystems/SMB",permalink:"/docs/os/UNIX/Network/Network Filesystems/SMB",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Other Network Filesystems",permalink:"/docs/os/UNIX/Network/Network Filesystems/Other_Network_Filesystems"},next:{title:"Troubleshooting",permalink:"/docs/os/UNIX/Network/Network Filesystems/Troubleshooting"}},l={},c=[{value:"Samba",id:"samba",level:2},{value:"Features",id:"features",level:3},{value:"Configuration",id:"configuration",level:3},{value:"User Accounts",id:"user-accounts",level:3},{value:"<code>testparm</code>",id:"testparm",level:3},{value:"Clients",id:"clients",level:3}];function d(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"server-message-block-smb",children:"Server Message Block (SMB)"})}),"\n",(0,r.jsx)(s.p,{children:"The Server Message Block (SMB) protocol was originally designed at IBM and later incorporated as the de facto networking file/print sharing system for Microsoft Windows."}),"\n",(0,r.jsx)(s.p,{children:"In 1996, the latest version of the SMB protocol was renamed to Common Internet File System (CIFS), as many new features were added."}),"\n",(0,r.jsxs)(s.p,{children:["The Samba Project started as a reverse-engineered implementation of the SMB protocol for Solaris servers. To learn more about this, visit ",(0,r.jsx)(s.a,{href:"https://www.samba.org/",children:"Samba's website"}),"."]}),"\n",(0,r.jsx)(s.p,{children:"Samba is built to be an SMB/CIFS server which will run on any UNIX-like system."}),"\n",(0,r.jsx)(s.h2,{id:"samba",children:"Samba"}),"\n",(0,r.jsx)(s.h3,{id:"features",children:"Features"}),"\n",(0,r.jsx)(s.p,{children:"Samba features include the following:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Samba can create file or printer shares."}),"\n",(0,r.jsx)(s.li,{children:"Samba version 3.x can act as a WindowsNT domain controller."}),"\n",(0,r.jsx)(s.li,{children:"Samba version 4.x can act as an Active Directory domain controller."}),"\n",(0,r.jsx)(s.li,{children:"Samba version 4.x is available on most distributions."}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsxs)(s.p,{children:["The default location for the Samba configuration file is ",(0,r.jsx)(s.code,{children:"/etc/samba/smb.conf"}),", which uses an INI-file-like syntax, with section headers enclosed in square brackets."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ini",children:"[global]\n    workgroup = MYGROUP\n    server string = Samba Server Version %v\n    log file = /var/log/samba/log.%m\n    max log size = 50\n    cups options = raw\n"})}),"\n",(0,r.jsx)(s.p,{children:"Each individual share then goes into its own section:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ini",children:"[mainshare]\n    path = /srv/exports/\n    read only = yes\n    comment = Main exports share\n"})}),"\n",(0,r.jsx)(s.h3,{id:"user-accounts",children:"User Accounts"}),"\n",(0,r.jsx)(s.p,{children:"Due to the difference in system password hashing mechanisms, Samba cannot verify some user passwords without additional help."}),"\n",(0,r.jsxs)(s.p,{children:["The ",(0,r.jsx)(s.code,{children:"smbpasswd"})," command allows you to manage your passwords in both the Samba password file and in directory services."]}),"\n",(0,r.jsx)(s.p,{children:"To create a new password entry for Samba, do:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"smbpasswd -a geoff\n"})}),"\n",(0,r.jsxs)(s.p,{children:["To change the password for ",(0,r.jsx)(s.code,{children:"geoff"}),", do:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"smbpasswd geoff\n"})}),"\n",(0,r.jsxs)(s.p,{children:["In the event that the UNIX username does not match the Samba username, the ",(0,r.jsx)(s.code,{children:"/etc/samba/smbusers"})," file allows for the translation."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"UNIXNAME = SMBNAME SMBNAME2\n"})}),"\n",(0,r.jsx)(s.h3,{id:"testparm",children:(0,r.jsx)(s.code,{children:"testparm"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"testparm"})," is the syntax checker for ",(0,r.jsx)(s.code,{children:"smb.conf"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["Once you have created your ",(0,r.jsx)(s.code,{children:"smb.conf"})," file, test the syntax with the testparm command:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'testparm\n\nLoad smb configuration files from /etc/samba/smb.conf\nrlimit_max: increasing rlimit_max (1024) to minimum Windows limit\n(16384)\nProcessing section "[mainshare]"\nLoaded services file OK.\nServer role: ROLE_STANDALONE\nPress enter to see a dump of your service definitions\n'})}),"\n",(0,r.jsx)(s.p,{children:"When you press Enter, you will get a parsed copy of the configuration file."}),"\n",(0,r.jsx)(s.h3,{id:"clients",children:"Clients"}),"\n",(0,r.jsx)(s.p,{children:"There are several ways to interface with a Samba server:"}),"\n",(0,r.jsx)(s.p,{children:"Query the shares on a server:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"smbclient -L 172.16.104.131 -U student\n\n\nEnter SAMBA\\student's password:\nDomain=[UBUNTU] OS=[Windows 6.1] Server=[Samba 4.5.8-Ubuntu]\n      Sharename     Type          Comment\n      -------       ----          ---------\n      cifs-share    Disk          Example share for testing home-export-cifs\n      IPC$          IPC           IPC Service (ubuntu server (Samba, Ubuntu))\n\nDomain=[UBUNTU] OS=[Windows 6.1] Server=[Samba 4.5.8-Ubuntu]\n      Server                 Comment\n      ---------              -------\n      Workgroup              Master\n      -------                -------\n      LFLAB                  UBUNTU\n"})}),"\n",(0,r.jsx)(s.p,{children:"Using the FTP-like interface:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"smbclient //SERVER/mainshare\nsmb: \\> get /foo\n"})}),"\n",(0,r.jsx)(s.p,{children:"Mount the SMB/CIFS share into your name space:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mount -t cifs -o username,password //SERVER/share/ /mnt/point/\n"})}),"\n",(0,r.jsxs)(s.p,{children:["To avoid putting usernames and passwords into a world-readable file (",(0,r.jsx)(s.code,{children:"/etc/fstab"}),"), the CIFS mount command takes the credentials=filename option."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"mount -t cifs -o credentials=filename //SERVER/share/ /mnt/point/\n"})}),"\n",(0,r.jsx)(s.p,{children:"The credentials file has the following syntax:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"username=value\npassword=value\ndomain=value\n"})})]})}function h(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>i});var r=n(96540);const a={},o=r.createContext(a);function t(e){const s=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),r.createElement(o.Provider,{value:s},e.children)}}}]);