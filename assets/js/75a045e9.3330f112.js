"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[82659],{51920:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>l});var s=t(74848),i=t(28453);const r={},a=void 0,c={id:"cybersecurity/Offensive/Exploit Development/stack",title:"stack",description:"Stack",source:"@site/docs/cybersecurity/Offensive/Exploit Development/stack.md",sourceDirName:"cybersecurity/Offensive/Exploit Development",slug:"/cybersecurity/Offensive/Exploit Development/stack",permalink:"/docs/cybersecurity/Offensive/Exploit Development/stack",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Creating Shellcode",permalink:"/docs/cybersecurity/Offensive/Exploit Development/shellcode/creating_shellcode"},next:{title:"Linux_passwd_shadow_file",permalink:"/docs/cybersecurity/Offensive/Password Cracking/Linux_passwd_shadow_file"}},o={},l=[{value:"Stack",id:"stack",level:3},{value:"Registers",id:"registers",level:4},{value:"Instructions",id:"instructions",level:4},{value:"Heap",id:"heap",level:3},{value:"Data",id:"data",level:3}];function d(e){const n={code:"code",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://miro.medium.com/max/1122/1*CtL4OiSQFvSrK8mIOkb5zQ.png",alt:""})}),"\n",(0,s.jsx)(n.h3,{id:"stack",children:"Stack"}),"\n",(0,s.jsx)(n.p,{children:"The stack space is located just under the OS kernel space, generally opposite the heap area and grows downwards to lower addresses."}),"\n",(0,s.jsx)(n.p,{children:"The stack is LIFO ( last-in-first-out ) data structure. In computer science, a stack is an abstract data type that serves as a collection of elements, with two principal operations:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"push"}),", which adds an element to the collection, and"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"pop"}),", which removes the most recently added element that was not yet removed."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"This area is devoted to storing all the data needed by a function call in a program. Calling a function is the same as pushing the called function execution onto the top of the stack, and once that function completes, the results are returned popping the function off the stack. The dataset pushed for function call is named a stack frame, and it contains the following data:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"the arguments (parameter values) passed to the routine"}),"\n",(0,s.jsx)(n.li,{children:"the return address back to the routine\u2019s caller\nspace for the local variables of the routine"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:"https://miro.medium.com/max/2000/1*hmEHkEhWWZHJQFN7CAeYpw.png",alt:""})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-c",children:"int main() {\n  int result = getResult();\n}\nint getResult() {\n  int num1 = getNum1();\n  int num2 = getNum2();\n  return num1 + num2;\n}\nint getNum1() {\n  return 10;\n}\nint getNum2() {\n  return 20;\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"registers",children:"Registers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"esp"})," - register containing the address at the top of the stack."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"ebp"})," - register containing the address at the bottom of the stack frame."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"eip"})," - register containing the address of instruction to be executed."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"instructions",children:"Instructions"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"mov dest, src"}),": copy 4 bytes from src to dest.\nFor registers, move their value, and for\naddresses, move the data at the address.\n(Intel notation)\n",(0,s.jsx)(n.code,{children:"jmp address"}),": execute the instruction at\naddress\n",(0,s.jsx)(n.code,{children:"pop reg"})," = mov reg, ESP; add ESP, 4\n``push data",(0,s.jsx)(n.code,{children:"= sub ESP, 4; mov data, ESP"}),"enter N bytes",(0,s.jsx)(n.code,{children:"= push EBP; mov EBP, ESP; sub ESP, N bytes (required for locals) "}),"call func",(0,s.jsx)(n.code,{children:"="}),"push EIP; jmp func address",(0,s.jsx)(n.code,{children:" "}),"leave",(0,s.jsx)(n.code,{children:"="}),"mov ESP, EBP; pop EBP",(0,s.jsx)(n.code,{children:" "}),"ret",(0,s.jsx)(n.code,{children:"="}),"pop EIP; jmp EIP`"]}),"\n",(0,s.jsx)(n.h3,{id:"heap",children:"Heap"}),"\n",(0,s.jsx)(n.p,{children:"The Heap is the segment where dynamic memory allocation usually takes place."}),"\n",(0,s.jsx)(n.p,{children:"The allocation to the heap area occurs, in the following cases."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"memory size is dynamically allocated at run-time"}),"\n",(0,s.jsx)(n.li,{children:"scope is not limited. (i.g., variables referenced from several places)"}),"\n",(0,s.jsx)(n.li,{children:"memory size is very large."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"It\u2019s our responsibility to free memory on the heap. The objects on the heap lead to memory leaks if they are not freed. In garbage-collected languages, the garbage collector frees memory on the heap and prevents memory leaks."}),"\n",(0,s.jsx)(n.h3,{id:"data",children:"Data"}),"\n",(0,s.jsx)(n.p,{children:"The data segment contains initialized global and static variables which have a pre-defined value and can be modified. it\u2019s divided into a read-only and a read-write space."})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>c});var s=t(96540);const i={},r=s.createContext(i);function a(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);