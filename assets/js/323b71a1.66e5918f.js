"use strict";(globalThis.webpackChunkkgkb=globalThis.webpackChunkkgkb||[]).push([[38977],{60588:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var t=i(74848),l=i(28453);const s={slug:"buildkit",title:"BuildKit",authors:["kbbgl"],tags:["docker","buildkit","buildx","caching"]},r=void 0,a={id:"software/containerization/docker/buildkit",title:"BuildKit",description:"BuildKit is the build engine used by docker build (and docker buildx build). It\u2019s more than \u201ca Dockerfile builder\u201d: it executes a content-addressed DAG of build steps, which enables aggressive caching and parallel execution.",source:"@site/docs/software/containerization/docker/buildkit.md",sourceDirName:"software/containerization/docker",slug:"/software/containerization/docker/buildkit",permalink:"/docs/software/containerization/docker/buildkit",draft:!1,unlisted:!1,tags:[{inline:!0,label:"docker",permalink:"/docs/tags/docker"},{inline:!0,label:"buildkit",permalink:"/docs/tags/buildkit"},{inline:!0,label:"buildx",permalink:"/docs/tags/buildx"},{inline:!0,label:"caching",permalink:"/docs/tags/caching"}],version:"current",frontMatter:{slug:"buildkit",title:"BuildKit",authors:["kbbgl"],tags:["docker","buildkit","buildx","caching"]},sidebar:"docsSidebar",previous:{title:"stop_all_containers",permalink:"/docs/software/containerization/docker/admin/stop-all-containers"},next:{title:"Architecture",permalink:"/docs/software/containerization/docker/architecture"}},d={},c=[{value:"Key concepts",id:"key-concepts",level:2},{value:"LLB (Low-Level Build definition)",id:"llb-low-level-build-definition",level:3},{value:"Frontends (bring your own syntax)",id:"frontends-bring-your-own-syntax",level:3},{value:"Solver + cache",id:"solver--cache",level:3},{value:"Outputs (BuildKit can build \u201cmore than images\u201d)",id:"outputs-buildkit-can-build-more-than-images",level:2},{value:"Using a custom frontend (example pattern)",id:"using-a-custom-frontend-example-pattern",level:2},{value:"Practical caching notes",id:"practical-caching-notes",level:2},{value:"Related ecosystem",id:"related-ecosystem",level:2},{value:"Sources",id:"sources",level:2}];function o(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["BuildKit is the build engine used by ",(0,t.jsx)(n.code,{children:"docker build"})," (and ",(0,t.jsx)(n.code,{children:"docker buildx build"}),"). It\u2019s more than \u201ca Dockerfile builder\u201d: it executes a ",(0,t.jsx)(n.strong,{children:"content-addressed DAG"})," of build steps, which enables aggressive caching and parallel execution."]}),"\n",(0,t.jsx)(n.h2,{id:"key-concepts",children:"Key concepts"}),"\n",(0,t.jsx)(n.h3,{id:"llb-low-level-build-definition",children:"LLB (Low-Level Build definition)"}),"\n",(0,t.jsxs)(n.p,{children:["BuildKit\u2019s internal \u201cIR\u201d is ",(0,t.jsx)(n.strong,{children:"LLB"}),", which represents build steps as a directed acyclic graph (DAG) of filesystem operations (run, copy, mount, etc.). Because the vertices are content-addressed, identical steps (same inputs) can be reused from cache."]}),"\n",(0,t.jsx)(n.h3,{id:"frontends-bring-your-own-syntax",children:"Frontends (bring your own syntax)"}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.strong,{children:"frontend"})," translates some build definition format into LLB. The default is the Dockerfile frontend (selected via a ",(0,t.jsx)(n.code,{children:"# syntax="})," directive), but frontends can be custom (YAML, JSON, HCL, etc.) as long as they emit valid LLB via the BuildKit Gateway API."]}),"\n",(0,t.jsx)(n.h3,{id:"solver--cache",children:"Solver + cache"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"solver"})," executes the LLB graph. Caching happens at the operation level (not just linear layers), which is why independent branches can be executed in parallel and reused across builds."]}),"\n",(0,t.jsx)(n.h2,{id:"outputs-buildkit-can-build-more-than-images",children:"Outputs (BuildKit can build \u201cmore than images\u201d)"}),"\n",(0,t.jsxs)(n.p,{children:["BuildKit can export build results in several formats via ",(0,t.jsx)(n.code,{children:"--output"}),", for example:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Image"}),": ",(0,t.jsx)(n.code,{children:"type=image"})," (build/push an image)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Local directory"}),": ",(0,t.jsx)(n.code,{children:"type=local,dest=./out"})," (write the final filesystem to a folder)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Tarball"}),": ",(0,t.jsx)(n.code,{children:"type=tar,dest=./out.tar"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"OCI tarball"}),": ",(0,t.jsx)(n.code,{children:"type=oci,dest=./out-oci.tar"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Example (export build output to a local directory instead of producing an image):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker buildx build --output type=local,dest=./out .\n"})}),"\n",(0,t.jsx)(n.h2,{id:"using-a-custom-frontend-example-pattern",children:"Using a custom frontend (example pattern)"}),"\n",(0,t.jsxs)(n.p,{children:["If a project provides a frontend image that can parse a non-Dockerfile spec, you can point BuildKit at it and still use ",(0,t.jsx)(n.code,{children:"docker buildx build"}),". One common pattern is passing a build file (e.g. ",(0,t.jsx)(n.code,{children:"spec.yml"}),") and choosing the frontend via a build arg:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker buildx build \\\n  -f spec.yml \\\n  --build-arg BUILDKIT_SYNTAX=example/frontend-image \\\n  --output type=local,dest=./out \\\n  .\n"})}),"\n",(0,t.jsx)(n.h2,{id:"practical-caching-notes",children:"Practical caching notes"}),"\n",(0,t.jsx)(n.p,{children:"BuildKit caches can be:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Local"}),": reused on the same machine/runner"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Inline"}),": embedded in the image metadata"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Remote/registry"}),": shareable across CI runners by pushing cache to a registry"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"related-ecosystem",children:"Related ecosystem"}),"\n",(0,t.jsx)(n.p,{children:"Several tools build on BuildKit/LLB (e.g. Earthly, Dagger, Depot). If you like \u201cbuild pipelines as code\u201d with strong caching, they\u2019re worth exploring."}),"\n",(0,t.jsx)(n.h2,{id:"sources",children:"Sources"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://tuananh.net/2026/02/25/buildkit-docker-hidden-gem/",children:"BuildKit: Docker's Hidden Gem That Can Build Almost Anything (Tuan-Anh Tran, 2026-02-25)"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>a});var t=i(96540);const l={},s=t.createContext(l);function r(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);