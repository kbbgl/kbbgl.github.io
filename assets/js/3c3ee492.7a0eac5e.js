"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[3887],{38584:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>o});var i=s(74848),t=s(28453);const l={},r="iptables Command",a={id:"os/UNIX/Network/Firewalls/iptables_Command",title:"iptables Command",description:"The iptables command can be broken into multiple pieces:",source:"@site/docs/os/UNIX/Network/Firewalls/iptables_Command.md",sourceDirName:"os/UNIX/Network/Firewalls",slug:"/os/UNIX/Network/Firewalls/iptables_Command",permalink:"/docs/os/UNIX/Network/Firewalls/iptables_Command",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"TCP Wrappers",permalink:"/docs/os/UNIX/Network/Firewalls/TCP_Wrappers"},next:{title:"netfilter Vocabulary",permalink:"/docs/os/UNIX/Network/Firewalls/netfilter"}},c={},o=[{value:"Match Criteria",id:"match-criteria",level:2},{value:"Targets",id:"targets",level:2},{value:"Distribution Defaults",id:"distribution-defaults",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsxs)(n.h1,{id:"iptables-command",children:[(0,i.jsx)(n.code,{children:"iptables"})," Command"]})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"iptables"})," command can be broken into multiple pieces:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The table using the ",(0,i.jsx)(n.code,{children:"-t"})," switch. If no table is specified, the default is ",(0,i.jsx)(n.code,{children:"filter"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["The command, which is one of the following:\n",(0,i.jsx)(n.code,{children:"'-I' (insert)"})]}),"\n",(0,i.jsxs)(n.li,{children:["Create a new rule at the top of the chain.\n",(0,i.jsx)(n.code,{children:"'-I #' (insert)"})]}),"\n",(0,i.jsxs)(n.li,{children:["Create a new rule at position # of the chain.\n",(0,i.jsx)(n.code,{children:"'-A' (append)"})]}),"\n",(0,i.jsxs)(n.li,{children:["Create a new rule at the bottom of the chain.\n",(0,i.jsx)(n.code,{children:"'-P' (policy)"})]}),"\n",(0,i.jsxs)(n.li,{children:["Change the chain's policy.\n",(0,i.jsx)(n.code,{children:"'-D' (delete)"})]}),"\n",(0,i.jsxs)(n.li,{children:["Delete a rule.\n",(0,i.jsx)(n.code,{children:"'-D #' (delete)"})]}),"\n",(0,i.jsxs)(n.li,{children:["Delete rule number #.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The chain name."}),"\n",(0,i.jsx)(n.li,{children:"The match criteria."}),"\n",(0,i.jsx)(n.li,{children:"The target."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"An example rule is as follows:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"iptables -t filter -A INPUT -m tcp -p tcp --dport 22 -j ACCEPT\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This rule appends the rule to the bottom of the ",(0,i.jsx)(n.code,{children:"INPUT"})," chain, loads the ",(0,i.jsx)(n.code,{children:"tcp"})," module, matches the TCP protocol destination port 22 and jumps to the ",(0,i.jsx)(n.code,{children:"ACCEPT"})," target."]}),"\n",(0,i.jsx)(n.p,{children:"Here is another example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"iptables -t <TABLE> <command> <CHAIN> <match criteria> -j <TARGET>\n"})}),"\n",(0,i.jsx)(n.p,{children:"Insert a new rule at the top of a chain:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"iptables -I INPUT -m udp -p udp --dport 53 -j ACCEPT\n"})}),"\n",(0,i.jsx)(n.p,{children:"Set the INPUT chain policy to DROP:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"iptables -P INPUT DROP\n"})}),"\n",(0,i.jsx)(n.p,{children:"Delete the third rule from the INPUT chain:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"iptables -D INPUT 3\n"})}),"\n",(0,i.jsx)(n.h2,{id:"match-criteria",children:"Match Criteria"}),"\n",(0,i.jsxs)(n.p,{children:["The match criteria is the essence of the iptables system, and allows for a lot of flexibility. By default, if you use the ",(0,i.jsx)(n.code,{children:"-p"})," or ",(0,i.jsx)(n.code,{children:"--protocol"})," switch, the corresponding module is loaded."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"state"}),"\nAllows for matching for stateful firewalls."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tcp"}),"\nAllows for matches on the TCP information (source port, destination port, tcp flags)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"udp"}),"\nAllows for matches on UDP information (source port, destination port)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"icmp"}),"\nAllows for matches on ICMP query types."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"targets",children:"Targets"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ACCEPT"}),": Pass the packet along to the next stage."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"DROP"}),": Send no response to this packet and ignore it."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RETURN"}),": Go back to the calling CHAIN and start processing on the next rule."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"REJECT"}),": Send a message back explaining why the packet is not allowed."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"distribution-defaults",children:"Distribution Defaults"}),"\n",(0,i.jsx)(n.p,{children:"Each distribution has its own method for storing the iptables state. Some make it easy to manage it with generic tools, while some provide easy-to-use tools for firewall management."}),"\n",(0,i.jsxs)(n.p,{children:["CentOS:\nCentOS 7 has a package called ",(0,i.jsx)(n.code,{children:"iptables-services"})," which provides the historical program service and ",(0,i.jsx)(n.code,{children:"systemd"})," with scripts to assist in managing ",(0,i.jsx)(n.code,{children:"iptables"}),".\nFirewall rules are saved in ",(0,i.jsx)(n.code,{children:"/etc/sysconfig/iptables"}),".\nEasiest management is done with ",(0,i.jsx)(n.code,{children:"iptables"})," and service ",(0,i.jsx)(n.code,{children:"iptables"})," save."]}),"\n",(0,i.jsxs)(n.p,{children:["OpenSUSE:\nOpenSUSE has a standalone firewall management tool called ",(0,i.jsx)(n.code,{children:"SuSEfirewall2"})," that also works in conjunction with ",(0,i.jsx)(n.code,{children:"systemd"}),". This solution requires an administrator to save the configuration, but automates restarting the firewall at boot time.\nFirewall rules are saved in ",(0,i.jsx)(n.code,{children:"/etc/sysconfig/scripts/SuSEfirewall2-*"}),".\nEasiest management is done with ",(0,i.jsx)(n.code,{children:"yast"})," and ",(0,i.jsx)(n.code,{children:"SuSEfirewall2"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Ubuntu:\nUbuntu has two packages, ",(0,i.jsx)(n.code,{children:"iptables-persistent"})," and ",(0,i.jsx)(n.code,{children:"netfilter-persistent"}),", which are available to make the ",(0,i.jsx)(n.code,{children:"iptables"})," rules persistent by using ",(0,i.jsx)(n.code,{children:"systemd"}),". The default location is ",(0,i.jsx)(n.code,{children:"/etc/iptables/rules.v4"}),".\nThe default firewall is managed with ",(0,i.jsx)(n.code,{children:"ufw"}),".\nCustom rules are stored in ",(0,i.jsx)(n.code,{children:"/etc/ufw/*.rules"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>a});var i=s(96540);const t={},l=i.createContext(t);function r(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);