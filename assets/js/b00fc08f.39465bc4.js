"use strict";(globalThis.webpackChunkkgkb=globalThis.webpackChunkkgkb||[]).push([[77736],{63544:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>r});var i=s(74848),c=s(28453);const t={},a="Pluggable Authentication Modules",o={id:"os/UNIX/Account Management/pam",title:"Pluggable Authentication Modules",description:"Provide mechanism to ensure that users/applications are properly identified and authenticated.",source:"@site/docs/os/UNIX/Account Management/pam.md",sourceDirName:"os/UNIX/Account Management",slug:"/os/UNIX/Account Management/pam",permalink:"/docs/os/UNIX/Account Management/pam",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Group Management",permalink:"/docs/os/UNIX/Account Management/groups"},next:{title:"SSH",permalink:"/docs/os/UNIX/Account Management/ssh"}},l={},r=[{value:"PAM Rules",id:"pam-rules",level:2},{value:"Steps Involved in Authentication",id:"steps-involved-in-authentication",level:3},{value:"LDAP",id:"ldap",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"pluggable-authentication-modules",children:"Pluggable Authentication Modules"})}),"\n",(0,i.jsx)(n.p,{children:"Provide mechanism to ensure that users/applications are properly identified and authenticated."}),"\n",(0,i.jsxs)(n.p,{children:["Various applications have used ",(0,i.jsx)(n.code,{children:"libpam"})," to be able to configure a uniform authentication method. Its modules provide flexibility in authenticating, password and session management."]}),"\n",(0,i.jsx)(n.p,{children:"Each PAM-aware application or service can be configured in a configuration file in:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"/etc/pam.d/\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Each file in ",(0,i.jsx)(n.code,{children:"/etc/pam.d"})," corresponds to a service and each line in the file specifies a rule. The rule is formatted as:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"type control module-path module-arguments\n"})}),"\n",(0,i.jsx)(n.h2,{id:"pam-rules",children:"PAM Rules"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"type"}),": specifies management group is associated with. Possible values are:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"auth"}),": Instructs app to prompt for identification."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"account"}),": Checks user's account such as password aging, ACL."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"password"}),": Update user authentication token."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"session"}),": Used to provide functions before and after the session is established (e.g., setting up environment, logging)."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"control"}),": controls success or failure of module on the rest of the flow:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"required"}),": Must return success."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"requesite"}),": Same as ",(0,i.jsx)(n.code,{children:"required"})," except failure in any module termninates stack and sends application return status."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"optional"}),": module is not required."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"sufficient"}),": if module succeeds, no subsequent modules are executed. If it fails and is the only module in the stack, it will fail."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"module-path"}),": gives file name of the library that can be found in ",(0,i.jsx)(n.code,{children:"/lib*/security"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"module-arguments"}),": given to modify the PAM module's behavior."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"steps-involved-in-authentication",children:"Steps Involved in Authentication"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["User invokes PAM-aware application, e.g. ",(0,i.jsx)(n.code,{children:"login"}),", ",(0,i.jsx)(n.code,{children:"ssh"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["The application calls ",(0,i.jsx)(n.code,{children:"libpam"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["The library checks for configuration files in ",(0,i.jsx)(n.code,{children:"/etc/pam.d/"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Each referenced module is executed according to the configuration."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"ldap",children:"LDAP"}),"\n",(0,i.jsxs)(n.p,{children:["LDAP can be integrated using PAM.\nDAP uses PAM and ",(0,i.jsx)(n.code,{children:"system-config-authentication"})," or ",(0,i.jsx)(n.code,{children:"authconfig-tui"}),". One has to specify the server, search base DN (domain name) and TLS (Transport Layer Security). Also required is ",(0,i.jsx)(n.code,{children:"openldap-clients"}),", ",(0,i.jsx)(n.code,{children:"pam ldap"})," and ",(0,i.jsx)(n.code,{children:"nss-pam-ldapd"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"When you configure a system for LDAP authentication, five files are changed:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"/etc/openldap/ldap.conf\n/etc/pam_ldap.conf\n/etc/nslcd.conf\n/etc/sssd/sssd.conf\n/etc/nsswitch.conf\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You can edit these files manually or use one of the utility programs available (",(0,i.jsx)(n.code,{children:"system-config-authentication"})," or ",(0,i.jsx)(n.code,{children:"authconfig-tui"}),")."]}),"\n",(0,i.jsx)(n.p,{children:"We can use LDAP search to check for successful client authentication:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'ldapsearch -H ldaps://ldap.kbbgl.github.io:636/ -b "DC=kbbgl,DC=io" -D "CN=kbbgl.gh.io,OU=svcacct,DC=kbbgl,DC=io" -w "$PASSWORD" -ZZ -x -v -d 1 -o nettimeout=10 -o tls_cacert=./ca-chain.pem tls ca cert "cn=*" dn\n'})})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var i=s(96540);const c={},t=i.createContext(c);function a(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:a(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);