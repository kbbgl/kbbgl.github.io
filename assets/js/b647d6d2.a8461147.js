"use strict";(globalThis.webpackChunkkgkb=globalThis.webpackChunkkgkb||[]).push([[25708],{66156:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>c,toc:()=>l});var o=n(74848),i=n(28453);const a={},r=void 0,c={id:"software/containerization/k8s/Network/calico/calico_architecture",title:"calico_architecture",description:"What Calico does",source:"@site/docs/software/containerization/k8s/Network/calico/calico_architecture.md",sourceDirName:"software/containerization/k8s/Network/calico",slug:"/software/containerization/k8s/Network/calico/calico_architecture",permalink:"/docs/software/containerization/k8s/Network/calico/calico_architecture",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"How to Deploy Prometheus and Grafana in Kubernetes",permalink:"/docs/software/containerization/k8s/Monitoring/how-to-deploy-prometheus-grafana-k8s"},next:{title:"calico_cheatsheet",permalink:"/docs/software/containerization/k8s/Network/calico/calico_cheatsheet"}},s={},l=[{value:"What Calico does",id:"what-calico-does",level:3},{value:"Architecture",id:"architecture",level:3},{value:"Datastore (<code>etcd</code>)",id:"datastore-etcd",level:4},{value:"Container Network Interface (CNI)",id:"container-network-interface-cni",level:4},{value:"BIRD (BGP Client)",id:"bird-bgp-client",level:4},{value:"FELIX",id:"felix",level:4},{value:"IPAM (IP Address Management)",id:"ipam-ip-address-management",level:4}];function d(e){const t={code:"code",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h3,{id:"what-calico-does",children:"What Calico does"}),"\n",(0,o.jsx)(t.p,{children:"It uses Layer 3 (network) to manage Kubernetes networking."}),"\n",(0,o.jsx)(t.h3,{id:"architecture",children:"Architecture"}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{src:"https://miro.medium.com/max/700/1*XvDzIPDcDrJqK4WJsR28UA.png",alt:""})}),"\n",(0,o.jsxs)(t.h4,{id:"datastore-etcd",children:["Datastore (",(0,o.jsx)(t.code,{children:"etcd"}),")"]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"etcd"})," holds all cluster status information and is the entrypoint for ",(0,o.jsx)(t.code,{children:"calicoctl"}),"."]}),"\n",(0,o.jsx)(t.h4,{id:"container-network-interface-cni",children:"Container Network Interface (CNI)"}),"\n",(0,o.jsx)(t.p,{children:"A CNI plugin is a set of libraries that allow creation of network interfaces in containers."}),"\n",(0,o.jsx)(t.p,{children:"In Calico, the CNI assigns a virtual ethernet pair and an IP address to a container/Pod. This manages communication between the container and the host."}),"\n",(0,o.jsx)(t.p,{children:"The Pod will have a default route to the host's ethernet interface."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-bash",children:"\u276f kubectl exec calico-node-tlzzh -it -- bash\n\nip route | grep default\n\n# default via 10.50.0.1 dev ens160 proto dhcp src 10.50.43.145 metric 100\n"})}),"\n",(0,o.jsx)(t.p,{children:"The packet sent from container to host machine will hit the host's routing table."}),"\n",(0,o.jsx)(t.h4,{id:"bird-bgp-client",children:"BIRD (BGP Client)"}),"\n",(0,o.jsx)(t.p,{children:"BGP (Border Gateway Protocol) is a standard protocol for exchanging routing information between two routers in a network. Each router running BGP has one or more BGP peers - other routers which they are communicating with over BGP."}),"\n",(0,o.jsx)(t.p,{children:"Calico uses BIRD as the GDP client to establish sessions between nodes and share their routes to allow communication to and from nodes within a Kubernetes cluster."}),"\n",(0,o.jsx)(t.p,{children:"When the CNI assigns an IP address to a Pod, it will also add them to the routing table. When this addition is done, BIRD will also advertise the new route to the BGP peers."}),"\n",(0,o.jsx)(t.h4,{id:"felix",children:"FELIX"}),"\n",(0,o.jsxs)(t.p,{children:["Felix is used in Calico for policy enforcement. It will use the ",(0,o.jsx)(t.code,{children:"etcd"})," to manage Node status, endpoints and network policies. It's a daemon running on each host node or container, communicates with Calico, BGP clients and kernel routing."]}),"\n",(0,o.jsx)(t.h4,{id:"ipam-ip-address-management",children:"IPAM (IP Address Management)"}),"\n",(0,o.jsx)(t.p,{children:"Used during the process of creating a Calico network. It will monitor the IP addresses assigned and in use."})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>c});var o=n(96540);const i={},a=o.createContext(i);function r(e){const t=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(a.Provider,{value:t},e.children)}}}]);