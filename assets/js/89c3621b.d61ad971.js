"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[67569],{19144:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});var s=t(74848),i=t(28453);const o={},c="How to Create Custom GitHub Actions",r={id:"software/version_control_systems/gh/Actions/creating_custom_actions",title:"How to Create Custom GitHub Actions",description:"We can create our own actions that utilize JavaScript or Docker containers.",source:"@site/docs/software/version_control_systems/gh/Actions/creating_custom_actions.md",sourceDirName:"software/version_control_systems/gh/Actions",slug:"/software/version_control_systems/gh/Actions/creating_custom_actions",permalink:"/docs/software/version_control_systems/gh/Actions/creating_custom_actions",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"GitHub Actions",permalink:"/docs/software/version_control_systems/gh/Actions/"},next:{title:"How to Publish Actions to GitHub Actions Marketplace",permalink:"/docs/software/version_control_systems/gh/Actions/publish_actions"}},a={},l=[{value:"JavaScript",id:"javascript",level:2},{value:"Dependencies",id:"dependencies",level:3},{value:"Docker",id:"docker",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"how-to-create-custom-github-actions",children:"How to Create Custom GitHub Actions"})}),"\n",(0,s.jsx)(n.p,{children:"We can create our own actions that utilize JavaScript or Docker containers."}),"\n",(0,s.jsx)(n.h2,{id:"javascript",children:"JavaScript"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mkdir .github/actions/hello\n\ntouch .github/actions/hello/action.yml\n"})}),"\n",(0,s.jsx)(n.p,{children:"An example of a Javascript custom action:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yml",metastring:"title='action.yml'",children:"name: Greet\nauthor: Kobbi Gal\ndescription: This is a custom action\ninputs:\n  who-to-greet:\n    description: 'Who to greet'\n    required: true\n    default: Kobbi\noutputs:\n  time:\n    description: \"Time of greeting\"\nruns:\n  using: 'node12'\n  main: 'dist/index.js'\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Some very useful actions for JavaScript can be found in ",(0,s.jsx)(n.a,{href:"https://github.com/actions/toolkit",children:"toolkit"}),". For example, in order to get inputs and set outputs, we would need to install the ",(0,s.jsx)(n.code,{children:"core"})," and ",(0,s.jsx)(n.code,{children:"github"})," packages:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install @actions/core\nnpm install @actions/github\n"})}),"\n",(0,s.jsxs)(n.p,{children:["And then use them in ",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(70880).A+"",children:(0,s.jsx)(n.code,{children:"index.js"})})]}),"\n",(0,s.jsx)(n.h3,{id:"dependencies",children:"Dependencies"}),"\n",(0,s.jsxs)(n.p,{children:["Since the job will run in a VM, NPM packages will not be available. We can push the ",(0,s.jsx)(n.code,{children:"node_modules"})," folder but a better solution is to use ",(0,s.jsx)(n.a,{href:"https://github.com/vercel/ncc",children:(0,s.jsx)(n.code,{children:"ncc"})})," and compile all dependencies into one bundle."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npm install -D @zeit/ncc\n\nnpx ncc build .github/actions/greet/index.js -o .github/actions/greet/dist\n"})}),"\n",(0,s.jsx)(n.p,{children:"And change the action to use the bundle:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"runs:\n  using: 'node12'\n  main: 'dist/index.js' # reference the bundle\n"})}),"\n",(0,s.jsx)(n.h2,{id:"docker",children:"Docker"}),"\n",(0,s.jsx)(n.p,{children:"To create an action that will run in a Docker container, we need to create:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["An ",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(42462).A+"",children:"action YAML"})," that will hold the inputs, outputs and Docker run specification:"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"runs:\nusing: 'docker'\n# We can use a docker image and tag from DockerHub or a Dockerfile\n# image: '$IMAGE_NAME:$TAG_NAME'\nimage: 'Dockerfile'\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["A ",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(61345).A+"",children:(0,s.jsx)(n.code,{children:"Dockerfile"})})]}),"\n",(0,s.jsxs)(n.li,{children:["An ",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:t(61345).A+"",children:(0,s.jsx)(n.code,{children:"entrypoint.sh"})})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},42462:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/files/action-6375dec1429e87e9bd5b68b1d07921c4.yml"},61345:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/files/entrypoint-9153184e979f707d4586c3df3f2ff9be.sh"},70880:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/files/index-b56edcef466092d71321845e1b2af3f1.js"},28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>r});var s=t(96540);const i={},o=s.createContext(i);function c(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);