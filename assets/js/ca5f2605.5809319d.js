"use strict";(globalThis.webpackChunkkgkb=globalThis.webpackChunkkgkb||[]).push([[86039],{82315:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>o});var d=s(74848),i=s(28453);const r={slug:"os-linux-disk-raid",title:"RAID",authors:["kbbgl"],tags:["os","linux","disk","raid"]},a="RAID",l={id:"os/linux/disk/RAID",title:"RAID",description:"RAID (Redundant Array of Independent Disks) is a data storage virtualization technology.",source:"@site/docs/os/linux/disk/RAID.md",sourceDirName:"os/linux/disk",slug:"/os/linux/disk/os-linux-disk-raid",permalink:"/docs/os/linux/disk/os-linux-disk-raid",draft:!1,unlisted:!1,tags:[{inline:!0,label:"os",permalink:"/docs/tags/os"},{inline:!0,label:"linux",permalink:"/docs/tags/linux"},{inline:!0,label:"disk",permalink:"/docs/tags/disk"},{inline:!0,label:"raid",permalink:"/docs/tags/raid"}],version:"current",frontMatter:{slug:"os-linux-disk-raid",title:"RAID",authors:["kbbgl"],tags:["os","linux","disk","raid"]},sidebar:"docsSidebar",previous:{title:"Getting Started with the Kernel",permalink:"/docs/os/linux/development/linux_kernel_development/getting-started-kernel"},next:{title:"Backing up and Restoring Partition Tables",permalink:"/docs/os/linux/disk/os-linux-disk-backup-restore"}},t={},o=[{value:"Levels",id:"levels",level:2},{value:"Configuring RAID",id:"configuring-raid",level:2},{value:"Monitoring",id:"monitoring",level:2},{value:"Hot Spares",id:"hot-spares",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"raid",children:"RAID"})}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.strong,{children:"RAID"})," (Redundant Array of Independent Disks) is a data storage virtualization technology."]}),"\n",(0,d.jsx)(n.p,{children:"RAID allows:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"To spread I/O across multiple disks to increase performance and fault tolerance."}),"\n",(0,d.jsx)(n.li,{children:"Implemetation on the either HW/SW level."}),"\n",(0,d.jsx)(n.li,{children:"Mirroring: writing the same data to more than one disk."}),"\n",(0,d.jsx)(n.li,{children:"Striping: splitting data to more than one disk."}),"\n",(0,d.jsx)(n.li,{children:"Parity: extra data is stored to allow problem detection and repair."}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"RAID creates filesystems which spans more than one disk. RAID devices are created by combining partitions from several disks together."}),"\n",(0,d.jsx)(n.p,{children:"To manage RAID devices:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"mdadm\n"})}),"\n",(0,d.jsxs)(n.p,{children:["Raid device can then be used like any filesystem (",(0,d.jsx)(n.code,{children:"/dev/mdX"}),")"]}),"\n",(0,d.jsx)(n.h2,{id:"levels",children:"Levels"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"RAID 0"}),": only striping so gives performance boost. no redundancy so any disk fail will cause total lost."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"RAID 1"}),": only mirroring. each disk has a duplicate so at least two disks required. good for recovery."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"RAID 5"}),": rotating parity stripe. single disk failure will cause no data loss, only performance drop. must have 3 disks."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"RAID 6"}),": striping with dual parity. can handle 2 disk failures and requires 4 disk. RAID 6 is preferred to RAID 5."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"RAID 10"}),": mirrored and striped. at least 4 disks needed."]}),"\n"]}),"\n",(0,d.jsx)(n.h2,{id:"configuring-raid",children:"Configuring RAID"}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:["Create partitions using ",(0,d.jsx)(n.code,{children:"fdisk"})," ((t)ype ",(0,d.jsx)(n.code,{children:"fd"}),")"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"sudo fdisk /dev/sdb\nsudo fdisk /dev/sdc\n"})}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:["Create RAID device using ",(0,d.jsx)(n.code,{children:"mmdadm"}),"."]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"sudo mdadm --create /dev/md0 --level=1 --raid-disks=2 /dev/sdb1 /dev/dev/sdc1\n"})}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsx)(n.p,{children:"Format RAID device."}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"sudo mkfs.ext4 /dev/md0\n"})}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:["Add device to ",(0,d.jsx)(n.code,{children:"/etc/fstab"})," and capture configuration to file:"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:'echo "/dev/md0 /myraid ext4 defaults 0 2" >> /etc/fstab\nsudo bash -c "mdadm --detail --scan >> /etc/mdadm.conf"\n'})}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsx)(n.p,{children:"Mount RAID device."}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"sudo mkdir /myraid\nsudo mount /dev/md0 /myraid\n"})}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsx)(n.p,{children:"Check RAID device"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"cat /proc/mdstat\n"})}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"To stop RAID device:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"sudo mdadm -S /dev/md0\n"})}),"\n",(0,d.jsx)(n.h2,{id:"monitoring",children:"Monitoring"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"sudo mdadm --detail /dev/md0\n\n# OR \ncat /proc/mdstat\n\n# OR (requires configuring /etc/mdadm.conf, can set MAILADDR me@domain.com to receive email.\n# need to turn on \nsudo systemctl start mdmonitor\nsudo systemctl enable mdmonitor\nmdmonitor \n"})}),"\n",(0,d.jsx)(n.h2,{id:"hot-spares",children:"Hot Spares"}),"\n",(0,d.jsx)(n.p,{children:"Can use hot spares for redundancy to fix an issue ASAP."}),"\n",(0,d.jsx)(n.p,{children:"To initialize a RAID device with hot spare:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# -x 1 tells mdadm to configure one psare device.\nsudo mdadm --create /dev/md0 -l 5 -n3 -x 1 /dev/sda8 /dev/sda9 /dev/sda10 /dev/sd11\n"})}),"\n",(0,d.jsx)(n.p,{children:"To add it later:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"sudo mdadm --fail /dev/md0 /dev/sdb2\n"})}),"\n",(0,d.jsx)(n.p,{children:"To replace faulty with spare:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"sudo mdadm --remove /dev/md0 /dev/sdb2\nsudo mdadm --add /dev/md0 /dev/sdc2\n"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var d=s(96540);const i={},r=d.createContext(i);function a(e){const n=d.useContext(r);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),d.createElement(r.Provider,{value:n},e.children)}}}]);