"use strict";(self.webpackChunkkgkb=self.webpackChunkkgkb||[]).push([[17440],{14342:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>c});var t=n(74848),i=n(28453);const l={slug:"pytest",title:"pytest",description:"Using pytest",authors:["kbbgl"],tags:["testing","unit_testing","dev","tests"]},r="Python Testing with pytest",a={id:"software/languages/python/Testing/pytest",title:"pytest",description:"Using pytest",source:"@site/docs/software/languages/python/Testing/pytest.md",sourceDirName:"software/languages/python/Testing",slug:"/software/languages/python/Testing/pytest",permalink:"/docs/software/languages/python/Testing/pytest",draft:!1,unlisted:!1,tags:[{inline:!0,label:"testing",permalink:"/docs/tags/testing"},{inline:!0,label:"unit_testing",permalink:"/docs/tags/unit-testing"},{inline:!0,label:"dev",permalink:"/docs/tags/dev"},{inline:!0,label:"tests",permalink:"/docs/tags/tests"}],version:"current",frontMatter:{slug:"pytest",title:"pytest",description:"Using pytest",authors:["kbbgl"],tags:["testing","unit_testing","dev","tests"]},sidebar:"tutorialSidebar",previous:{title:"Property-Based Testing",permalink:"/docs/software/languages/python/Testing/property-based"},next:{title:"Time Python Command",permalink:"/docs/software/languages/python/Testing/time_cmd"}},d={},c=[{value:"1. Getting Started with pytest",id:"1-getting-started-with-pytest",level:2},{value:"Using Options",id:"using-options",level:3},{value:"2. Writing Test Functions",id:"2-writing-test-functions",level:2},{value:"Testing a Package",id:"testing-a-package",level:3},{value:"Installing a Package Locally",id:"installing-a-package-locally",level:4},{value:"Using <code>assert</code> Statements",id:"using-assert-statements",level:3},{value:"Expecting Exceptions",id:"expecting-exceptions",level:3},{value:"Marking Test Functions",id:"marking-test-functions",level:3},{value:"Skipping Tests",id:"skipping-tests",level:3},{value:"Marking Tests as Expecting to Fail",id:"marking-tests-as-expecting-to-fail",level:3},{value:"Running a Subset of Tests",id:"running-a-subset-of-tests",level:3},{value:"A Single Directory",id:"a-single-directory",level:4},{value:"A Single Test File/Module",id:"a-single-test-filemodule",level:4},{value:"A Single Test Function",id:"a-single-test-function",level:4},{value:"A Single Test Class",id:"a-single-test-class",level:4},{value:"A Single Test Method of a Test Class",id:"a-single-test-method-of-a-test-class",level:4},{value:"A Set of Tests Based on Test Name",id:"a-set-of-tests-based-on-test-name",level:4},{value:"Parametrized Testing",id:"parametrized-testing",level:3},{value:"One Parameter",id:"one-parameter",level:4},{value:"Multiple Parameters",id:"multiple-parameters",level:4},{value:"Arguments Assigned to a Variable",id:"arguments-assigned-to-a-variable",level:4},{value:"<code>ids</code> Optional Parameter to Make Our Own Identifiers",id:"ids-optional-parameter-to-make-our-own-identifiers",level:4},{value:"<code>parametrize()</code> on Classes",id:"parametrize-on-classes",level:4},{value:"Identify Parameters with an <code>id</code>",id:"identify-parameters-with-an-id",level:4},{value:"3. pytest Fixtures",id:"3-pytest-fixtures",level:2},{value:"Sharing Fixtures Through conftest.py",id:"sharing-fixtures-through-conftestpy",level:3},{value:"Using Fixtures for Setup and Teardown",id:"using-fixtures-for-setup-and-teardown",level:3},{value:"Tracing Fixture Execution with <code>--setup-show</code>",id:"tracing-fixture-execution-with---setup-show",level:3},{value:"Using Fixtures for Test Data",id:"using-fixtures-for-test-data",level:3},{value:"Using Multiple Fixtures",id:"using-multiple-fixtures",level:3},{value:"Specifying Fixture Scope",id:"specifying-fixture-scope",level:3},{value:"Specifying Fixtures with usefixtures",id:"specifying-fixtures-with-usefixtures",level:3},{value:"Using <code>autouse</code> for Fixtures That Always Get Used",id:"using-autouse-for-fixtures-that-always-get-used",level:3},{value:"Renaming Fixtures",id:"renaming-fixtures",level:3},{value:"Parametrizing Fixtures",id:"parametrizing-fixtures",level:3},{value:"4. Builtin Fixtures",id:"4-builtin-fixtures",level:2},{value:"Using <code>tmpdir</code> and <code>tmpdir_factory</code>",id:"using-tmpdir-and-tmpdir_factory",level:3},{value:"Using <code>pytestconfig</code>",id:"using-pytestconfig",level:3},{value:"Using <code>cache</code>",id:"using-cache",level:3},{value:"Using <code>capsys</code>",id:"using-capsys",level:3},{value:"Using <code>monkeypatch</code>",id:"using-monkeypatch",level:3},{value:"Using <code>doctest_namespace</code>",id:"using-doctest_namespace",level:3},{value:"Using <code>recwarn</code>",id:"using-recwarn",level:3},{value:"5.Plugins",id:"5plugins",level:2},{value:"Finding Plugins",id:"finding-plugins",level:3},{value:"Installing Plugins",id:"installing-plugins",level:3},{value:"Install from PyPI",id:"install-from-pypi",level:4},{value:"Install from a .tar.gz or .whl",id:"install-from-a-targz-or-whl",level:4},{value:"Install from a Local Directory",id:"install-from-a-local-directory",level:4},{value:"Install from a Git Repository",id:"install-from-a-git-repository",level:4},{value:"Writing Your Own Plugins",id:"writing-your-own-plugins",level:3},{value:"Creating an Installable Plugin",id:"creating-an-installable-plugin",level:3},{value:"Testing Plugins",id:"testing-plugins",level:3},{value:"Creating a Distribution",id:"creating-a-distribution",level:3},{value:"Distributing Plugins Through a Shared Directory",id:"distributing-plugins-through-a-shared-directory",level:4},{value:"Distributing Plugins Through PyPI",id:"distributing-plugins-through-pypi",level:4},{value:"6. Configuration",id:"6-configuration",level:2},{value:"Understanding pytest Configuration Files",id:"understanding-pytest-configuration-files",level:3},{value:"Changing the Default Command-Line Options",id:"changing-the-default-command-line-options",level:3},{value:"Registering Markers to Avoid Marker Typos",id:"registering-markers-to-avoid-marker-typos",level:3},{value:"Requiring a Minimum pytest Version",id:"requiring-a-minimum-pytest-version",level:3},{value:"Stopping pytest from Looking in the Wrong Places",id:"stopping-pytest-from-looking-in-the-wrong-places",level:3},{value:"Specifying Test Directory Locations",id:"specifying-test-directory-locations",level:3},{value:"Changing Test Discovery Rules",id:"changing-test-discovery-rules",level:3},{value:"Disallowing XPASS",id:"disallowing-xpass",level:3},{value:"Avoiding Filename Collisions",id:"avoiding-filename-collisions",level:3},{value:"7. Using pytest with Other Tools",id:"7-using-pytest-with-other-tools",level:2},{value:"pdb: Debugging Test Failures",id:"pdb-debugging-test-failures",level:3},{value:"Coverage.py: Determining How Much Code Is Tested",id:"coveragepy-determining-how-much-code-is-tested",level:3},{value:"mock: Swapping Out Part of the System",id:"mock-swapping-out-part-of-the-system",level:3},{value:"tox: Testing Multiple Configurations",id:"tox-testing-multiple-configurations",level:3},{value:"A3. Plugin Sampler Pack",id:"a3-plugin-sampler-pack",level:2},{value:"Plugins That Change the Normal Test Run Flow",id:"plugins-that-change-the-normal-test-run-flow",level:3},{value:"pytest-repeat: Run Tests More Than Once",id:"pytest-repeat-run-tests-more-than-once",level:4},{value:"pytest-xdist: Run Tests in Parallel",id:"pytest-xdist-run-tests-in-parallel",level:4},{value:"pytest-timeout: Put Time Limits on Your Tests",id:"pytest-timeout-put-time-limits-on-your-tests",level:4},{value:"Plugins That Alter or Enhance Output",id:"plugins-that-alter-or-enhance-output",level:3},{value:"pytest-instafail: See Details of Failures and Errors as They Happen",id:"pytest-instafail-see-details-of-failures-and-errors-as-they-happen",level:4},{value:"pytest-sugar: Instafail + Colors + Progress Bar",id:"pytest-sugar-instafail--colors--progress-bar",level:4},{value:"pytest-emoji: Add Some Fun to Your Tests",id:"pytest-emoji-add-some-fun-to-your-tests",level:4},{value:"pytest-html: Generate HTML Reports for Test Sessions",id:"pytest-html-generate-html-reports-for-test-sessions",level:4},{value:"Plugins for Static Analysis",id:"plugins-for-static-analysis",level:3},{value:"pytest-pycodestyle, pytest-pep8: Comply with Python&#39;s Style Guide",id:"pytest-pycodestyle-pytest-pep8-comply-with-pythons-style-guide",level:4},{value:"pytest-flake8: Check for Style Plus Linting",id:"pytest-flake8-check-for-style-plus-linting",level:4},{value:"Plugins for Web Development",id:"plugins-for-web-development",level:3},{value:"pytest-selenium: Test with a Web Browser",id:"pytest-selenium-test-with-a-web-browser",level:4},{value:"pytest-django: Test Django Applications",id:"pytest-django-test-django-applications",level:4},{value:"pytest-flask: Test Flask Applications",id:"pytest-flask-test-flask-applications",level:4},{value:"A4. Packaging and Distributing Python Projects",id:"a4-packaging-and-distributing-python-projects",level:2},{value:"Creating an Installable Module",id:"creating-an-installable-module",level:3},{value:"Creating an Installable Package",id:"creating-an-installable-package",level:3},{value:"Creating a Source Distribution and Wheel",id:"creating-a-source-distribution-and-wheel",level:3},{value:"Sources",id:"sources",level:2}];function o(e){const s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"python-testing-with-pytest",children:"Python Testing with pytest"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#python-testing-with-pytest",children:"Python Testing with pytest"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#1-getting-started-with-pytest",children:"1. Getting Started with pytest"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#using-options",children:"Using Options"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#2-writing-test-functions",children:"2. Writing Test Functions"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#testing-a-package",children:"Testing a Package"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#installing-a-package-locally",children:"Installing a Package Locally"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#using-assert-statements",children:["Using ",(0,t.jsx)(s.code,{children:"assert"})," Statements"]})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#expecting-exceptions",children:"Expecting Exceptions"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#marking-test-functions",children:"Marking Test Functions"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#skipping-tests",children:"Skipping Tests"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#marking-tests-as-expecting-to-fail",children:"Marking Tests as Expecting to Fail"})}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#running-a-subset-of-tests",children:"Running a Subset of Tests"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#a-single-directory",children:"A Single Directory"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#a-single-test-filemodule",children:"A Single Test File/Module"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#a-single-test-function",children:"A Single Test Function"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#a-single-test-class",children:"A Single Test Class"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#a-single-test-method-of-a-test-class",children:"A Single Test Method of a Test Class"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#a-set-of-tests-based-on-test-name",children:"A Set of Tests Based on Test Name"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#parametrized-testing",children:"Parametrized Testing"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#one-parameter",children:"One Parameter"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#multiple-parameters",children:"Multiple Parameters"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#arguments-assigned-to-a-variable",children:"Arguments Assigned to a Variable"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#ids-optional-parameter-to-make-our-own-identifiers",children:[(0,t.jsx)(s.code,{children:"ids"})," Optional Parameter to Make Our Own Identifiers"]})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#parametrize-on-classes",children:[(0,t.jsx)(s.code,{children:"parametrize()"})," on Classes"]})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#identify-parameters-with-an-id",children:["Identify Parameters with an ",(0,t.jsx)(s.code,{children:"id"})]})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#3-pytest-fixtures",children:"3. pytest Fixtures"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#sharing-fixtures-through-conftestpy",children:"Sharing Fixtures Through conftest.py"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#using-fixtures-for-setup-and-teardown",children:"Using Fixtures for Setup and Teardown"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#tracing-fixture-execution-with---setup-show",children:["Tracing Fixture Execution with ",(0,t.jsx)(s.code,{children:"--setup-show"})]})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#using-fixtures-for-test-data",children:"Using Fixtures for Test Data"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#using-multiple-fixtures",children:"Using Multiple Fixtures"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#specifying-fixture-scope",children:"Specifying Fixture Scope"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#specifying-fixtures-with-usefixtures",children:"Specifying Fixtures with usefixtures"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#using-autouse-for-fixtures-that-always-get-used",children:["Using ",(0,t.jsx)(s.code,{children:"autouse"})," for Fixtures That Always Get Used"]})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#renaming-fixtures",children:"Renaming Fixtures"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#parametrizing-fixtures",children:"Parametrizing Fixtures"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#4-builtin-fixtures",children:"4. Builtin Fixtures"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#using-tmpdir-and-tmpdir_factory",children:["Using ",(0,t.jsx)(s.code,{children:"tmpdir"})," and ",(0,t.jsx)(s.code,{children:"tmpdir_factory"})]})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#using-pytestconfig",children:["Using ",(0,t.jsx)(s.code,{children:"pytestconfig"})]})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#using-cache",children:["Using ",(0,t.jsx)(s.code,{children:"cache"})]})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#using-capsys",children:["Using ",(0,t.jsx)(s.code,{children:"capsys"})]})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#using-monkeypatch",children:["Using ",(0,t.jsx)(s.code,{children:"monkeypatch"})]})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#using-doctest_namespace",children:["Using ",(0,t.jsx)(s.code,{children:"doctest_namespace"})]})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsxs)(s.a,{href:"#using-recwarn",children:["Using ",(0,t.jsx)(s.code,{children:"recwarn"})]})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#5plugins",children:"5.Plugins"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#finding-plugins",children:"Finding Plugins"})}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#installing-plugins",children:"Installing Plugins"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#install-from-pypi",children:"Install from PyPI"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#install-from-a-targz-or-whl",children:"Install from a .tar.gz or .whl"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#install-from-a-local-directory",children:"Install from a Local Directory"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#install-from-a-git-repository",children:"Install from a Git Repository"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#writing-your-own-plugins",children:"Writing Your Own Plugins"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#creating-an-installable-plugin",children:"Creating an Installable Plugin"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#testing-plugins",children:"Testing Plugins"})}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#creating-a-distribution",children:"Creating a Distribution"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#distributing-plugins-through-a-shared-directory",children:"Distributing Plugins Through a Shared Directory"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#distributing-plugins-through-pypi",children:"Distributing Plugins Through PyPI"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#6-configuration",children:"6. Configuration"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#understanding-pytest-configuration-files",children:"Understanding pytest Configuration Files"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#changing-the-default-command-line-options",children:"Changing the Default Command-Line Options"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#registering-markers-to-avoid-marker-typos",children:"Registering Markers to Avoid Marker Typos"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#requiring-a-minimum-pytest-version",children:"Requiring a Minimum pytest Version"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#stopping-pytest-from-looking-in-the-wrong-places",children:"Stopping pytest from Looking in the Wrong Places"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#specifying-test-directory-locations",children:"Specifying Test Directory Locations"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#changing-test-discovery-rules",children:"Changing Test Discovery Rules"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#disallowing-xpass",children:"Disallowing XPASS"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#avoiding-filename-collisions",children:"Avoiding Filename Collisions"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#7-using-pytest-with-other-tools",children:"7. Using pytest with Other Tools"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pdb-debugging-test-failures",children:"pdb: Debugging Test Failures"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#coveragepy-determining-how-much-code-is-tested",children:"Coverage.py: Determining How Much Code Is Tested"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#mock-swapping-out-part-of-the-system",children:"mock: Swapping Out Part of the System"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#tox-testing-multiple-configurations",children:"tox: Testing Multiple Configurations"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#a3-plugin-sampler-pack",children:"A3. Plugin Sampler Pack"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#plugins-that-change-the-normal-test-run-flow",children:"Plugins That Change the Normal Test Run Flow"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pytest-repeat-run-tests-more-than-once",children:"pytest-repeat: Run Tests More Than Once"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pytest-xdist-run-tests-in-parallel",children:"pytest-xdist: Run Tests in Parallel"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pytest-timeout-put-time-limits-on-your-tests",children:"pytest-timeout: Put Time Limits on Your Tests"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#plugins-that-alter-or-enhance-output",children:"Plugins That Alter or Enhance Output"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pytest-instafail-see-details-of-failures-and-errors-as-they-happen",children:"pytest-instafail: See Details of Failures and Errors as They Happen"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pytest-sugar-instafail--colors--progress-bar",children:"pytest-sugar: Instafail + Colors + Progress Bar"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pytest-emoji-add-some-fun-to-your-tests",children:"pytest-emoji: Add Some Fun to Your Tests"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pytest-html-generate-html-reports-for-test-sessions",children:"pytest-html: Generate HTML Reports for Test Sessions"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#plugins-for-static-analysis",children:"Plugins for Static Analysis"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pytest-pycodestyle-pytest-pep8-comply-with-pythons-style-guide",children:"pytest-pycodestyle, pytest-pep8: Comply with Python's Style Guide"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pytest-flake8-check-for-style-plus-linting",children:"pytest-flake8: Check for Style Plus Linting"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#plugins-for-web-development",children:"Plugins for Web Development"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pytest-selenium-test-with-a-web-browser",children:"pytest-selenium: Test with a Web Browser"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pytest-django-test-django-applications",children:"pytest-django: Test Django Applications"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#pytest-flask-test-flask-applications",children:"pytest-flask: Test Flask Applications"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"#a4-packaging-and-distributing-python-projects",children:"A4. Packaging and Distributing Python Projects"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#creating-an-installable-module",children:"Creating an Installable Module"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#creating-an-installable-package",children:"Creating an Installable Package"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#creating-a-source-distribution-and-wheel",children:"Creating a Source Distribution and Wheel"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"#sources",children:"Sources"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"1-getting-started-with-pytest",children:"1. Getting Started with pytest"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"\u200b$ pytest --help\u200b\nusage: pytest [options] [file_or_dir] [file_or_dir] [...]\n...\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Given no arguments, pytest looks at your current directory and all subdirectories for test files and runs the test code it finds"}),"\n",(0,t.jsx)(s.li,{children:"If you give pytest a filename, a directory name, or a list of those, it looks there instead of the current directory"}),"\n",(0,t.jsx)(s.li,{children:"Each directory listed on the command line is recursively traversed to look for test code"}),"\n",(0,t.jsxs)(s.li,{children:["The part of pytest execution where pytest goes off and finds which tests to run is called ",(0,t.jsx)(s.em,{children:"test discovery"})]}),"\n",(0,t.jsxs)(s.li,{children:["Naming conventions to keep your test code discoverable:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["test files: ",(0,t.jsx)(s.code,{children:"test_<something>.py"})," or ",(0,t.jsx)(s.code,{children:"<something>_test.py"})]}),"\n",(0,t.jsxs)(s.li,{children:["test methods and functions: ",(0,t.jsx)(s.code,{children:"test_<something>"})]}),"\n",(0,t.jsxs)(s.li,{children:["test classes: ",(0,t.jsx)(s.code,{children:"Test<Something>"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["There are ways to alter these discovery rules","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.em,{children:"Configuration"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Running only one test:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"pytest <directory>/<file.py>::<test_name>"})}),"\n",(0,t.jsxs)(s.li,{children:["e.g., ",(0,t.jsx)(s.code,{children:"pytest tasks/test_four.py::test_asdict"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"using-options",children:"Using Options"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Some useful pytest command line options"}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--collect-only"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"shows you which tests will be run with the given options and configuration"}),"\n",(0,t.jsxs)(s.li,{children:["e.g., when used in conjunction with ",(0,t.jsx)(s.code,{children:"-k"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-k"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"use an expression to find what test functions to run"}),"\n",(0,t.jsxs)(s.li,{children:["e.g., ",(0,t.jsx)(s.code,{children:'pytest -k "asdict or defaults"'}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["run the ",(0,t.jsx)(s.code,{children:"test_asdict()"})," and ",(0,t.jsx)(s.code,{children:"test_defaults()"})," tests"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-m MARKEXPR"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"markers allow you to mark a subset of your test functions so that they can be run together"}),"\n",(0,t.jsxs)(s.li,{children:["e.g., ",(0,t.jsx)(s.code,{children:"pytest -m run_these_please"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["will run tests with the ",(0,t.jsx)(s.code,{children:"@pytest.mark.run_these_please"})," marker"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["further examples:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:'-m "mark1 and mark2"'})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:'-m "mark1 and not mark2"'})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:'-m "mark1 or mark2"'})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-x, --exitfirst"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"stop the entire test session immediately when a test fails"}),"\n",(0,t.jsx)(s.li,{children:"useful when debugging a problem"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-s"})," and ",(0,t.jsx)(s.code,{children:"--capture=method"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-s"})," flag allows anything that normally would be printed to stdout to actually be printed to stdout while the tests are running","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["shortcut for ",(0,t.jsx)(s.code,{children:"--capture=no"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["example: without and with ",(0,t.jsx)(s.code,{children:"-s"}),":"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'def test_fail():\n    a = 1\n    print("--- a is " + str(a))\n    assert a == 2\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:'$ pytest\n====================== test session starts =======================\n...\ncollected 1 item\n\ntests/test_s_option.py F                                   [100%]\n\n============================ FAILURES ============================\n___________________________ test_fail ____________________________\n\n    def test_fail():\n        a = 1\n        print("--- a is " + str(a))\n>       assert a == 2\nE       assert 1 == 2\n\ntests/test_s_option.py:4: AssertionError\n---------------------- Captured stdout call ----------------------\n--- a is 1\n==================== short test summary info =====================\nFAILED tests/test_s_option.py::test_fail - assert 1 == 2\n======================= 1 failed in 0.02s ========================\n\n$ pytest -s\n====================== test session starts =======================\n...\ncollected 1 item\n\ntests/test_s_option.py --- a is 1\nF\n\n============================ FAILURES ============================\n___________________________ test_fail ____________________________\n\n    def test_fail():\n        a = 1\n        print("--- a is " + str(a))\n>       assert a == 2\nE       assert 1 == 2\n\ntests/test_s_option.py:4: AssertionError\n==================== short test summary info =====================\nFAILED tests/test_s_option.py::test_fail - assert 1 == 2\n======================= 1 failed in 0.02s ========================\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-lf"}),", ",(0,t.jsx)(s.code,{children:"--last-failed"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"when one or more tests fails, run just the failing tests"}),"\n",(0,t.jsx)(s.li,{children:"helpful for debugging"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-ff"}),", ",(0,t.jsx)(s.code,{children:"--failed-first"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"run all tests but run the last failures first"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-v"}),", ",(0,t.jsx)(s.code,{children:"--verbose"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"report more information than without it"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-q"}),", ",(0,t.jsx)(s.code,{children:"--quiet"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["opposite of ",(0,t.jsx)(s.code,{children:"-v"}),"/",(0,t.jsx)(s.code,{children:"--verbose"})]}),"\n",(0,t.jsx)(s.li,{children:"decrease the information reported"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-l"}),", ",(0,t.jsx)(s.code,{children:"--showlocals"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"local variables and their values are displayed with tracebacks for failing tests"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--tb=style"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"modify the way tracebacks for failures are output"}),"\n",(0,t.jsxs)(s.li,{children:["useful styles:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"short"}),": prints just the ",(0,t.jsx)(s.code,{children:"assert"})," line and the ",(0,t.jsx)(s.code,{children:"E"})," evaluated line with no context"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"line"}),": keep the failure to one line"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"no"}),": remove the traceback entirely"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--durations=N"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"report the slowest N number of tests/setups/teardowns after the tests run"}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--durations=0"})," reports everything in order of slowest to fastest"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"2-writing-test-functions",children:"2. Writing Test Functions"}),"\n",(0,t.jsx)(s.h3,{id:"testing-a-package",children:"Testing a Package"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"File structure for the Tasks project:"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"\u200btasks_proj/\n\u200b\u251c\u2500\u2500 CHANGELOG.rst\n\u200b\u251c\u2500\u2500 LICENSE\n\u200b\u251c\u2500\u2500 MANIFEST.in\n\u200b\u251c\u2500\u2500 README.rst\n\u200b\u251c\u2500\u2500 setup.py\n\u200b\u251c\u2500\u2500 src\n\u2502   \u2514\u2500\u2500 tasks\n\u200b\u2502       \u251c\u2500\u2500 __init__.py\n\u200b\u2502       \u251c\u2500\u2500 api.py\n\u200b\u2502       \u251c\u2500\u2500 cli.py\n\u200b\u2502       \u251c\u2500\u2500 config.py\n\u200b\u2502       \u251c\u2500\u2500 tasksdb_pymongo.py\n\u200b\u2502       \u2514\u2500\u2500 tasksdb_tinydb.py\n\u200b\u2514\u2500\u2500 tests\n\u200b    \u251c\u2500\u2500 conftest.py\n\u200b    \u251c\u2500\u2500 pytest.ini\n\u200b    \u251c\u2500\u2500 func\n\u200b    \u2502   \u251c\u2500\u2500 __init__.py\n\u200b    \u2502   \u251c\u2500\u2500 test_add.py\n\u200b    \u2502   \u2514\u2500\u2500 ...\n\u200b    \u2514\u2500\u2500 unit\n\u200b        \u251c\u2500\u2500 __init__.py\n\u200b        \u251c\u2500\u2500 test_task.py\n\u200b        \u2514\u2500\u2500 ...\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["All of the tests are kept in ",(0,t.jsx)(s.code,{children:"tests"})," and separate from the package source files in ",(0,t.jsx)(s.code,{children:"src"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"not a requirement of pytest, but a best practice"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Functional (",(0,t.jsx)(s.code,{children:"func"}),") and unit (",(0,t.jsx)(s.code,{children:"unit"}),") tests are separated into their own directories","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["allows you to easily run a subset of tests","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"functional tests should only break if we are intentionally changing functionality of the system"}),"\n",(0,t.jsx)(s.li,{children:"unit tests could break during a refactoring or an implementation change"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Two types of ",(0,t.jsx)(s.code,{children:"__init__.py"})," files","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["under the ",(0,t.jsx)(s.code,{children:"src/"})," directory","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"src/tasks/__init__.py"})," tells Python that the directory is a package"]}),"\n",(0,t.jsxs)(s.li,{children:["acts as the main interface to the package when someone uses ",(0,t.jsx)(s.code,{children:"import tasks"})]}),"\n",(0,t.jsxs)(s.li,{children:["contains code to import specific functions from ",(0,t.jsx)(s.code,{children:"api.py"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"cli.py"})," and our test files can access package functionality like ",(0,t.jsx)(s.code,{children:"tasks.add()"})," instead of having to do ",(0,t.jsx)(s.code,{children:"tasks.api.add()"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["under ",(0,t.jsx)(s.code,{children:"tests/"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"tests/func/__init__.py"})," and ",(0,t.jsx)(s.code,{children:"tests/unit/__init__.py"})," files are empty","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["tell pytest to go up one directory to look for the root of the test directory and to look for the ",(0,t.jsx)(s.code,{children:"pytest.ini"})," file"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"pytest.ini"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"optional"}),"\n",(0,t.jsxs)(s.li,{children:["contains project-wide pytest configuration, at most only one of these in your project","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"directives that change the behaviour of pytest"}),"\n",(0,t.jsx)(s.li,{children:"e.g., a list of options that will always be used"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"conftest.py"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"optional"}),"\n",(0,t.jsx)(s.li,{children:'considered by pytest as a "local plugin" and can contain hook functions and fixtures'}),"\n",(0,t.jsxs)(s.li,{children:["hook functions","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"a way to insert code into part of the pytest execution process to alter how pytest works"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["fixtures","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"setup and teardown functions that run before and after test functions"}),"\n",(0,t.jsx)(s.li,{children:"can be used to represent resources and data used by the tests"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["hook functions and fixtures that are used by tests in multiple subdirectories should be contained in ",(0,t.jsx)(s.code,{children:"tests/conftest.py"})]}),"\n",(0,t.jsxs)(s.li,{children:["can have multiple ",(0,t.jsx)(s.code,{children:"conftest.py"})," files","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["e.g., you can have one at ",(0,t.jsx)(s.code,{children:"tests"})," and one for each subdirectory under ",(0,t.jsx)(s.code,{children:"tests"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"installing-a-package-locally",children:"Installing a Package Locally"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The best way to allow the tests to be able to ",(0,t.jsx)(s.code,{children:"import tasks"})," or ",(0,t.jsx)(s.code,{children:"from tasks import something"})," is to install ",(0,t.jsx)(s.code,{children:"tasks"})," locally using pip","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["possible because there's a ",(0,t.jsx)(s.a,{href:"tasks_proj/setup.py",children:(0,t.jsx)(s.code,{children:"setup.py"})})," file present to direct pip"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Install ",(0,t.jsx)(s.code,{children:"tasks"})," either by running ",(0,t.jsx)(s.code,{children:"pip install ."})," or ",(0,t.jsx)(s.code,{children:"pip install -e ."})," from the ",(0,t.jsx)(s.code,{children:"tasks_proj"})," directory","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["or you can run ",(0,t.jsx)(s.code,{children:"pip install -e tasks_proj"})," from one directory up"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-e, --editable <path/url>"}),': Install a project in editable mode (i.e. setuptools "develop mode") from a local project path or a VCS url',"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["be able to modify the source code while ",(0,t.jsx)(s.code,{children:"tasks"})," is installed"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.li,{children:"Run tests:"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"\u200b$ cd /path/to/code/ch2/tasks_proj/tests/unit\u200b\n$ pytest test_task.py\u200b\n"})}),"\n",(0,t.jsxs)(s.h3,{id:"using-assert-statements",children:["Using ",(0,t.jsx)(s.code,{children:"assert"})," Statements"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The normal Python ",(0,t.jsx)(s.code,{children:"assert"})," statement is your primary tool to communicate test failure"]}),"\n",(0,t.jsxs)(s.li,{children:["The following is a list of a few of the ",(0,t.jsx)(s.code,{children:"assert"})," forms and ",(0,t.jsx)(s.code,{children:"assert"})," helper functions:"]}),"\n"]}),"\n",(0,t.jsxs)(s.table,{children:[(0,t.jsx)(s.thead,{children:(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.th,{children:"pytest"}),(0,t.jsx)(s.th,{children:"unittest"})]})}),(0,t.jsxs)(s.tbody,{children:[(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"assert something"})}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"assertTrue(something)"})})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"assert a == b"})}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"assertEqual(a, b)"})})]}),(0,t.jsxs)(s.tr,{children:[(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"assert a <= b"})}),(0,t.jsx)(s.td,{children:(0,t.jsx)(s.code,{children:"assertLessEqual(a, b)"})})]})]})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["You can use ",(0,t.jsx)(s.code,{children:"assert <expression>"})," with any expression","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["if the expression would evaluate to ",(0,t.jsx)(s.code,{children:"False"})," if converted to a ",(0,t.jsx)(s.code,{children:"bool"}),", the test would fail"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["pytest includes a feature called ",(0,t.jsx)(s.code,{children:"assert"})," rewriting that intercepts ",(0,t.jsx)(s.code,{children:"assert"})," calls and replaces them with something that can tell you more about why your assertions failed"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest test_task_fail.py\n============================= test session starts ==============================\nplatform linux -- Python 3.6.9, pytest-5.4.1, py-1.8.1, pluggy-0.13.1\nrootdir: /.../ch2/tasks_proj/tests, inifile: pytest.ini\ncollected 2 items\n\ntest_task_fail.py FF                                                     [100%]\n\n=================================== FAILURES ===================================\n______________________________ test_task_equality ______________________________\n\n    def test_task_equality():\n        \"\"\"Different tasks should not be equal.\"\"\"\n        t1 = Task('sit there', 'brian')\n        t2 = Task('do something', 'okken')\n>       assert t1 == t2\nE       AssertionError: assert Task(summary=...alse, id=None) == Task(summary=...alse, id=None)\nE         At index 0 diff: 'sit there' != 'do something'\nE         Use -v to get the full diff\n\ntest_task_fail.py:9: AssertionError\n______________________________ test_dict_equality ______________________________\n...\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["See:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"ch2/tasks_proj/tests/unit/test_task_fail.py",children:(0,t.jsx)(s.code,{children:"unit/test_task_fail.py"})})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://docs.pytest.org/en/latest/example/reportingdemo.html",children:"Demo of Python failure reports with pytest"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"expecting-exceptions",children:"Expecting Exceptions"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Check for the type of exception","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["use the wrong type in a test function to intentionally cause ",(0,t.jsx)(s.code,{children:"TypeError"})," exceptions, and use ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"with pytest.raises(<expected exception>)"})})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'def test_add_raises():\n    """add() should raise an exception with wrong type param."""\n    with pytest.raises(TypeError):\n        tasks.add(task="not a Task object")\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Check the parameters to the exception","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["you can check to make sure the exception message is correct by adding ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"as excinfo"})})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'def test_start_tasks_db_raises():\n    """Make sure unsupported db raises an exception."""\n    with pytest.raises(ValueError) as excinfo:\n        tasks.start_tasks_db("some/great/path", "mysql")\n    exception_msg = excinfo.value.args[0]\n    assert exception_msg == "db_type must be a \'tiny\' or \'mongo\'"\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"ch2/tasks_proj/tests/func/test_api_exceptions.py",children:(0,t.jsx)(s.code,{children:"func/test_api_exceptions.py"})})]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"marking-test-functions",children:"Marking Test Functions"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"A test can have more than one marker, and a marker can be on multiple tests"}),"\n",(0,t.jsxs)(s.li,{children:["E.g., to add a smoke test suite to the Tasks project, we can add ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"@mark.pytest.smoke"})})," to some of the tests"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.mark.smoke\ndef test_list_raises():\n    """One marker: \'smoke\'"""\n    ...\n\n\n@pytest.mark.get\n@pytest.mark.smoke\ndef test_get_raises():\n    """Two markers: \'get\' and \'smoke\'"""\n    ...\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Run just those tests that are marked with ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"-m marker_name"})})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest -v -m 'smoke or get' test_api_exceptions.py\n\n============================= test session starts ==============================\n...\ncollected 7 items / 5 deselected / 2 selected\n\ntest_api_exceptions.py::test_list_raises PASSED                          [ 50%]\ntest_api_exceptions.py::test_get_raises PASSED                           [100%]\n"})}),"\n",(0,t.jsx)(s.h3,{id:"skipping-tests",children:"Skipping Tests"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["pytest includes a few helpful builtin markers: ",(0,t.jsx)(s.code,{children:"skip"}),", ",(0,t.jsx)(s.code,{children:"skipif"}),", and ",(0,t.jsx)(s.code,{children:"xfail"})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"skip"})," and ",(0,t.jsx)(s.code,{children:"skipif"})," markers enable you to skip tests you don't want to run"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"skip"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.a,{href:"ch2/tasks_proj/tests/func/test_unique_id_2.py",children:(0,t.jsx)(s.code,{children:"func/test_unique_id_2.py"})})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.mark.skip(reason="misunderstood the API")\ndef test_unique_id_1():\n    """s (skipped)"""\n    ...\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest test_unique_id_2.py\n============================= test session starts ==============================\n...\ncollected 2 items\n\ntest_unique_id_2.py s.                                                   [100%]\n\n========================= 1 passed, 1 skipped in 0.48s =========================\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"skipif"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"let's say we decide the test should be valid, and we intend to make that work in version 0.2.0 of the package"}),"\n",(0,t.jsxs)(s.li,{children:["the expression we pass into ",(0,t.jsx)(s.code,{children:"skipif()"})," can be any valid Python expression"]}),"\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.a,{href:"ch2/tasks_proj/tests/func/test_unique_id_3.py",children:(0,t.jsx)(s.code,{children:"func/test_unique_id_3.py"})})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.mark.skipif(\n    tasks.__version__ < "0.2.0", reason="not supported until version 0.2.0"\n)\ndef test_unique_id_1():\n    """s (skipped): skipped because we\'re currently at version 0.1.0"""\n    ...\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest -r s test_unique_id_3.py\n============================= test session starts ==============================\n...\ncollected 2 items\n\ntest_unique_id_3.py s.                                                   [100%]\n\n=========================== short test summary info ============================\nSKIPPED [1] func/test_unique_id_3.py:8: not supported until version 0.2.0\n========================= 1 passed, 1 skipped in 0.31s =========================\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"reason"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["not required in ",(0,t.jsx)(s.code,{children:"skip"}),", but it is required in ",(0,t.jsx)(s.code,{children:"skipif"})]}),"\n",(0,t.jsxs)(s.li,{children:["show skip reason in test output with ",(0,t.jsx)(s.code,{children:"pytest -r s"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"  -r chars              show extra test summary info as specified by chars:\n                        (f)ailed, (E)rror, (s)kipped, (x)failed, (X)passed,\n                        (p)assed, (P)assed with output, (a)ll except passed\n                        (p/P), or (A)ll. (w)arnings are enabled by default (see\n                        --disable-warnings), 'N' can be used to reset the list.\n                        (default: 'fE').\n"})}),"\n",(0,t.jsx)(s.h3,{id:"marking-tests-as-expecting-to-fail",children:"Marking Tests as Expecting to Fail"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["With the ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"xfail"})})," marker, we are telling pytest to run a test function, but that we expect it to fail"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"ch2/tasks_proj/tests/func/test_unique_id_4.py",children:(0,t.jsx)(s.code,{children:"func/test_unique_id_4.py"})})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.mark.xfail(\n    tasks.__version__ < "0.2.0", reason="not supported until version 0.2.0"\n)\ndef test_unique_id_1():\n    """x (xfail): expected to fail"""\n    ...\n\n\n@pytest.mark.xfail()\ndef test_unique_id_is_a_duck():\n    """x (xfail): expected to fail"""\n    ...\n\n\n@pytest.mark.xfail()\ndef test_unique_id_not_a_duck():\n    """X (xpass): expected to fail but passed """\n    ...\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest -r sxX test_unique_id_4.py\n============================= test session starts ==============================\n...\ncollected 4 items\n\ntest_unique_id_4.py xxX.                                                 [100%]\n\n=========================== short test summary info ============================\nXFAIL test_unique_id_4.py::test_unique_id_1\n  not supported until version 0.2.0\nXFAIL test_unique_id_4.py::test_unique_id_is_a_duck\nXPASS test_unique_id_4.py::test_unique_id_not_a_duck\n=================== 1 passed, 2 xfailed, 1 xpassed in 0.43s ====================\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["You can configure pytest to report the tests that pass but were marked with ",(0,t.jsx)(s.code,{children:"xfail"})," to be reported as ",(0,t.jsx)(s.code,{children:"FAIL"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["done in a ",(0,t.jsx)(s.code,{children:"pytest.ini"})," file:"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-ini",children:"[pytest]\nxfail_strict=true\n"})}),"\n",(0,t.jsx)(s.h3,{id:"running-a-subset-of-tests",children:"Running a Subset of Tests"}),"\n",(0,t.jsx)(s.h4,{id:"a-single-directory",children:"A Single Directory"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["To run all the tests from one directory, use the directory as a parameter to pytest","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"\u200bpytest tests/func"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --disable-warnings -v tests/func\n============================= test session starts ==============================\n...\ncollected 50 items\n\ntests/func/test_add.py::test_add_returns_valid_id PASSED                 [  2%]\ntests/func/test_add.py::test_added_task_has_id_set PASSED                [  4%]\n...\ntests/func/test_api_exceptions.py::test_add_raises PASSED                [ 70%]\ntests/func/test_api_exceptions.py::test_list_raises PASSED               [ 72%]\ntests/func/test_api_exceptions.py::test_get_raises PASSED                [ 74%]\ntests/func/test_api_exceptions.py::TestUpdate::test_bad_id PASSED        [ 76%]\ntests/func/test_api_exceptions.py::TestUpdate::test_bad_task PASSED      [ 78%]\ntests/func/test_api_exceptions.py::test_delete_raises PASSED             [ 80%]\ntests/func/test_api_exceptions.py::test_start_tasks_db_raises PASSED     [ 82%]\n...\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Using ",(0,t.jsx)(s.code,{children:"-v"})," gives you the syntax for how to run a specific directory, class, and test"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"a-single-test-filemodule",children:"A Single Test File/Module"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["To run a file full of tests, list the file with the relative path as a parameter","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"pytest tests/func/test_add.py"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"a-single-test-function",children:"A Single Test Function"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["To run a single test function, add ",(0,t.jsx)(s.code,{children:"::"})," and the test function name","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"pytest\u200b tests/func/test_add.py::test_add_returns_valid_id\u200b"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"a-single-test-class",children:"A Single Test Class"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Test classes are a way to group tests that make sense to be grouped together","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.a,{href:"ch2/tasks_proj/tests/func/test_api_exceptions.py",children:(0,t.jsx)(s.code,{children:"func/test_api_exceptions.py"})})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'class TestUpdate:\n    """Test expected exceptions with tasks.update()."""\n\n    def test_bad_id(self):\n        """A non-int id should raise an exception."""\n        ...\n\n    def test_bad_task(self):\n        """A non-Task task should raise an exception."""\n        ...\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["To run just this class, add ",(0,t.jsx)(s.code,{children:"::"}),", then the class name to the file parameter","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"pytest tests/func/test_api_exceptions.py::TestUpdate"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Note: Running pylint on the above will result in ",(0,t.jsx)(s.code,{children:"R0201: Method could be a function (no-self-use)"})," messages","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"fix as folllows:"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'class TestUpdate:\n    """Test expected exceptions with tasks.update()."""\n\n    @staticmethod\n    def test_bad_id():\n        """A non-int id should raise an exception."""\n        ...\n'})}),"\n",(0,t.jsx)(s.h4,{id:"a-single-test-method-of-a-test-class",children:"A Single Test Method of a Test Class"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["If you want to run just one method, add another ",(0,t.jsx)(s.code,{children:"::"})," and the method name","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"pytest tests/func/test_api_exceptions.py::TestUpdate::test_bad_id\u200b"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"a-set-of-tests-based-on-test-name",children:"A Set of Tests Based on Test Name"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"-k"})," option enables you to pass in an expression to run tests that have certain names specified by the expression as a substring of the test name","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["you can use ",(0,t.jsx)(s.code,{children:"and"}),", ",(0,t.jsx)(s.code,{children:"or"}),", and ",(0,t.jsx)(s.code,{children:"not"})," in your expression"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:'$ pytest -v -k "_raises and not delete"\n============================= test session starts ==============================\n...\ncollected 56 items / 52 deselected / 4 selected\n\ntests/func/test_api_exceptions.py::test_add_raises PASSED                [ 25%]\ntests/func/test_api_exceptions.py::test_list_raises PASSED               [ 50%]\ntests/func/test_api_exceptions.py::test_get_raises PASSED                [ 75%]\ntests/func/test_api_exceptions.py::test_start_tasks_db_raises PASSED     [100%]\n'})}),"\n",(0,t.jsx)(s.h3,{id:"parametrized-testing",children:"Parametrized Testing"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Parametrized testing is a way to send multiple sets of data through the same test and have pytest report if any of the sets failed"}),"\n",(0,t.jsxs)(s.li,{children:["We can use ",(0,t.jsx)(s.code,{children:"@pytest.mark.parametrize(argnames, argvalues)"})," to pass lots of data through the same test","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"first argument is a string with a comma-separated list of names"}),"\n",(0,t.jsx)(s.li,{children:"second argument is a list of values"}),"\n",(0,t.jsx)(s.li,{children:"pytest will run this test once for each value and report each as a separate test"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"ch2/tasks_proj/tests/func/test_add_variety.py",children:(0,t.jsx)(s.code,{children:"func/test_add_variety.py"})})]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"one-parameter",children:"One Parameter"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.mark.parametrize(\n    "task",\n    [\n        Task("sleep", done=True),\n        Task("wake", "brian"),\n        Task("breathe", "BRIAN", True),\n        Task("exercise", "BrIaN", False),\n    ],\n)\ndef test_add_2(task):\n    """parametrize with one parameter."""\n    task_id = tasks.add(task)\n    t_from_db = tasks.get(task_id)\n    assert equivalent(t_from_db, task)\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest -v tests/func/test_add_variety.py::test_add_2\n============================= test session starts ==============================\n...\ncollected 4 items\n\ntests/func/test_add_variety.py::test_add_2[task0] PASSED                 [ 25%]\ntests/func/test_add_variety.py::test_add_2[task1] PASSED                 [ 50%]\ntests/func/test_add_variety.py::test_add_2[task2] PASSED                 [ 75%]\ntests/func/test_add_variety.py::test_add_2[task3] PASSED                 [100%]\n\n============================== 4 passed in 0.51s ===============================\n"})}),"\n",(0,t.jsx)(s.h4,{id:"multiple-parameters",children:"Multiple Parameters"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.mark.parametrize(\n    "summary, owner, done",\n    [\n        ("sleep", None, False),\n        ("wake", "brian", False),\n        ("breathe", "BRIAN", True),\n        ("eat eggs", "BrIaN", False),\n    ],\n)\ndef test_add_3(summary, owner, done):\n    ...\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest -v tests/func/test_add_variety.py::test_add_3\n============================= test session starts ==============================\n...\ncollected 4 items\n\ntests/func/test_add_variety.py::test_add_3[sleep-None-False] PASSED      [ 25%]\ntests/func/test_add_variety.py::test_add_3[wake-brian-False] PASSED      [ 50%]\ntests/func/test_add_variety.py::test_add_3[breathe-BRIAN-True] PASSED    [ 75%]\ntests/func/test_add_variety.py::test_add_3[eat eggs-BrIaN-False] PASSED  [100%]\n\n============================== 4 passed in 0.47s ===============================\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["You can use that whole test identifier (",(0,t.jsx)(s.strong,{children:"node"}),") to re-run a test","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"use quotes if there are spaces in the identifier"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:'$ pytest -v "tests/func/test_add_variety.py::test_add_3[eat eggs-BrIaN-False]"\n============================= test session starts ==============================\n...\ncollected 1 item\n\ntests/func/test_add_variety.py::test_add_3[eat eggs-BrIaN-False] PASSED  [100%]\n\n============================== 1 passed in 0.15s ===============================\n'})}),"\n",(0,t.jsx)(s.h4,{id:"arguments-assigned-to-a-variable",children:"Arguments Assigned to a Variable"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'tasks_to_try = (\n    Task("sleep", done=True),\n    Task("wake", "brian"),\n    Task("wake", "brian"),\n    Task("breathe", "BRIAN", True),\n    Task("exercise", "BrIaN", False),\n)\n\n\n@pytest.mark.parametrize("task", tasks_to_try)\ndef test_add_4(task):\n    ...\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest -v tests/func/test_add_variety.py::test_add_4\n============================= test session starts ==============================\n...\ncollected 5 items\n\ntests/func/test_add_variety.py::test_add_4[task0] PASSED                 [ 20%]\ntests/func/test_add_variety.py::test_add_4[task1] PASSED                 [ 40%]\ntests/func/test_add_variety.py::test_add_4[task2] PASSED                 [ 60%]\ntests/func/test_add_variety.py::test_add_4[task3] PASSED                 [ 80%]\ntests/func/test_add_variety.py::test_add_4[task4] PASSED                 [100%]\n\n============================== 5 passed in 1.07s ===============================\n"})}),"\n",(0,t.jsxs)(s.h4,{id:"ids-optional-parameter-to-make-our-own-identifiers",children:[(0,t.jsx)(s.code,{children:"ids"})," Optional Parameter to Make Our Own Identifiers"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Use the ",(0,t.jsx)(s.code,{children:"ids"})," optional parameter to ",(0,t.jsx)(s.code,{children:"parametrize()"})," to make our own identifiers for each data set","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"a list of strings the same length as the number of data sets"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'tasks_to_try = (\n    Task("sleep", done=True),\n    Task("wake", "brian"),\n    Task("wake", "brian"),\n    Task("breathe", "BRIAN", True),\n    Task("exercise", "BrIaN", False),\n)\n\n\ntask_ids = ["Task({},{},{})".format(t.summary, t.owner, t.done) for t in tasks_to_try]\n\n\n@pytest.mark.parametrize("task", tasks_to_try, ids=task_ids)\ndef test_add_5(task):\n    ...\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest -v tests/func/test_add_variety.py::test_add_5\n============================= test session starts ==============================\n...\ncollected 5 items\n\ntests/func/test_add_variety.py::test_add_5[Task(sleep,None,True)] PASSED [ 20%]\ntests/func/test_add_variety.py::test_add_5[Task(wake,brian,False)0] PASSED [ 40%]\ntests/func/test_add_variety.py::test_add_5[Task(wake,brian,False)1] PASSED [ 60%]\ntests/func/test_add_variety.py::test_add_5[Task(breathe,BRIAN,True)] PASSED [ 80%]\ntests/func/test_add_variety.py::test_add_5[Task(exercise,BrIaN,False)] PASSED [100%]\n\n============================== 5 passed in 0.57s ===============================\n"})}),"\n",(0,t.jsxs)(s.h4,{id:"parametrize-on-classes",children:[(0,t.jsx)(s.code,{children:"parametrize()"})," on Classes"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"The same data sets will be sent to all test methods in the class"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.mark.parametrize("task", tasks_to_try, ids=task_ids)\nclass TestAdd:\n    """parametrize and test classes"""\n\n    def test_equivalent(self, task):\n        ...\n\n    def test_valid_id(self, task):\n        ...\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest -v tests/func/test_add_variety.py::TestAdd\n============================= test session starts ==============================\n...\ncollected 10 items\n\ntests/func/test_add_variety.py::TestAdd::test_equivalent[Task(sleep,None,True)] PASSED [ 10%]\ntests/func/test_add_variety.py::TestAdd::test_equivalent[Task(wake,brian,False)0] PASSED [ 20%]\ntests/func/test_add_variety.py::TestAdd::test_equivalent[Task(wake,brian,False)1] PASSED [ 30%]\ntests/func/test_add_variety.py::TestAdd::test_equivalent[Task(breathe,BRIAN,True)] PASSED [ 40%]\ntests/func/test_add_variety.py::TestAdd::test_equivalent[Task(exercise,BrIaN,False)] PASSED [ 50%]\ntests/func/test_add_variety.py::TestAdd::test_valid_id[Task(sleep,None,True)] PASSED [ 60%]\ntests/func/test_add_variety.py::TestAdd::test_valid_id[Task(wake,brian,False)0] PASSED [ 70%]\ntests/func/test_add_variety.py::TestAdd::test_valid_id[Task(wake,brian,False)1] PASSED [ 80%]\ntests/func/test_add_variety.py::TestAdd::test_valid_id[Task(breathe,BRIAN,True)] PASSED [ 90%]\ntests/func/test_add_variety.py::TestAdd::test_valid_id[Task(exercise,BrIaN,False)] PASSED [100%]\n\n============================== 10 passed in 1.34s ==============================\n"})}),"\n",(0,t.jsxs)(s.h4,{id:"identify-parameters-with-an-id",children:["Identify Parameters with an ",(0,t.jsx)(s.code,{children:"id"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Identify parameters by including an ",(0,t.jsx)(s.code,{children:"id"})," right alongside the parameter value","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["syntax: ",(0,t.jsx)(s.code,{children:'pytest.param(<value>, id="something")'})]}),"\n",(0,t.jsxs)(s.li,{children:["useful when the ",(0,t.jsx)(s.code,{children:"id"})," cannot be derived from the parameter value"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.mark.parametrize(\n    "task",\n    [\n        pytest.param(Task("create"), id="just summary"),\n        pytest.param(Task("inspire", "Michelle"), id="summary/owner"),\n        pytest.param(Task("encourage", "Michelle", True), id="summary/owner/done"),\n    ],\n)\ndef test_add_6(task):\n    ...\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest -v tests/func/test_add_variety.py::test_add_6\n============================= test session starts ==============================\n...\ncollected 3 items\n\ntests/func/test_add_variety.py::test_add_6[just summary] PASSED          [ 33%]\ntests/func/test_add_variety.py::test_add_6[summary/owner] PASSED         [ 66%]\ntests/func/test_add_variety.py::test_add_6[summary/owner/done] PASSED    [100%]\n\n============================== 3 passed in 0.46s ===============================\n"})}),"\n",(0,t.jsx)(s.h2,{id:"3-pytest-fixtures",children:"3. pytest Fixtures"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Fixtures are functions that are run by pytest before (and sometimes after) the actual test functions","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:'the mechanism pytest provides to allow the separation of "getting ready for" and "cleaning up after" code from your test functions'}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["You can use fixtures to","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"get a data set for the tests to work on"}),"\n",(0,t.jsx)(s.li,{children:"get a system into a known state before running a test"}),"\n",(0,t.jsx)(s.li,{children:"get data ready for multiple tests"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"@pytest.fixture()"})," decorator is used to tell pytest that a function is a fixture"]}),"\n",(0,t.jsx)(s.li,{children:"When you include the fixture name in the parameter list of a test function, pytest knows to run it before running the test"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.fixture()\ndef\u200b some_data():\n    """Return answer to ultimate question."""\n    \u200breturn\u200b 42\n\n\n\u200bdef\u200b test_some_data(some_data):\n    """Use fixture return value in a test."""\n    \u200bassert\u200b some_data == 42\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"test_some_data()"})," has the name of the fixture, ",(0,t.jsx)(s.code,{children:"some_data"}),", as a parameter","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"pytest will look for a fixture with this name in the module of the test"}),"\n",(0,t.jsxs)(s.li,{children:["or in ",(0,t.jsx)(s.code,{children:"conftest.py"})," files if it doesn't find it in this file"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"sharing-fixtures-through-conftestpy",children:"Sharing Fixtures Through conftest.py"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["To share fixtures among multiple test files","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["use a ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"conftest.py"})})," file somewhere centrally located for all of the tests"]}),"\n",(0,t.jsxs)(s.li,{children:["for the Tasks project: ",(0,t.jsx)(s.code,{children:"tasks_proj/tests/conftest.py"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["You can put fixtures in individual test files","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"to only be used by tests in that file"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["You can have other ",(0,t.jsx)(s.code,{children:"conftest.py"})," files in subdirectories of the top tests directory","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"will be available to tests in that directory and subdirectories"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Although ",(0,t.jsx)(s.code,{children:"conftest.py"})," is a Python module, it should ",(0,t.jsx)(s.em,{children:"not"})," be imported by test files","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["gets read by pytest, and is considered a local ",(0,t.jsx)(s.em,{children:"plugin"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"using-fixtures-for-setup-and-teardown",children:"Using Fixtures for Setup and Teardown"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["pytest includes a fixture called ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"tmpdir"})})," that we can use for testing and don't have to worry about cleaning up"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.fixture()\ndef tasks_db(tmpdir):\n    """Connect to db before tests, disconnect after."""\n    # Setup : start db\n    tasks.start_tasks_db(str(tmpdir), "tiny")\n\n    yield  # this is where the testing happens\n\n    # Teardown : stop db\n    tasks.stop_tasks_db()\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["If there is a ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"yield"})})," in the function","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"fixture execution stops there"}),"\n",(0,t.jsx)(s.li,{children:"passes control to the tests"}),"\n",(0,t.jsx)(s.li,{children:"picks up on the next line after the tests are done"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Code after the ",(0,t.jsx)(s.code,{children:"yield"})," is guaranteed to run regardless of what happens during the tests"]}),"\n",(0,t.jsxs)(s.li,{children:["We're not returning any data with the ",(0,t.jsx)(s.code,{children:"yield"})," in this fixture, but you can"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"ch3/a/tasks_proj/tests/conftest.py",children:(0,t.jsx)(s.code,{children:"tests/conftest.py"})})]}),"\n"]}),"\n",(0,t.jsxs)(s.h3,{id:"tracing-fixture-execution-with---setup-show",children:["Tracing Fixture Execution with ",(0,t.jsx)(s.code,{children:"--setup-show"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Use ",(0,t.jsx)(s.code,{children:"--setup-show"})," to see what fixtures are run"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"def test_add_returns_valid_id(tasks_db):\n    ...\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --setup-show func/test_add.py -k valid_id\n============================= test session starts ==============================\n...\ncollected 3 items / 2 deselected / 1 selected\n\nfunc/test_add.py\nSETUP    S tmp_path_factory\n        SETUP    F tmp_path (fixtures used: tmp_path_factory)\n        SETUP    F tmpdir (fixtures used: tmp_path)\n        SETUP    F tasks_db (fixtures used: tmpdir)\n        func/test_add.py::test_add_returns_valid_id (fixtures used: request, tasks_db, tmp_path, tmp_path_factory, tmpdir).\n        TEARDOWN F tasks_db\n        TEARDOWN F tmpdir\n        TEARDOWN F tmp_path\nTEARDOWN S tmp_path_factory\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"F"})," and ",(0,t.jsx)(s.code,{children:"S"})," in front of the fixture names indicate scope","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"F"})," for function scope"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"S"})," for session scope"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"using-fixtures-for-test-data",children:"Using Fixtures for Test Data"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Fixtures are a great place to store data to use for testing","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"you can return anything"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.li,{children:"When an exception occurs in a fixture:"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:'$ pytest test_fixtures.py::test_other_data\n============================= test session starts ==============================\n...\ncollected 1 item\n\ntest_fixtures.py E                                                       [100%]\n\n==================================== ERRORS ====================================\n______________________ ERROR at setup of test_other_data _______________________\n\n    @pytest.fixture()\n    def some_other_data():\n        """Raise an exception from fixture."""\n>       return 1 / 0\nE       ZeroDivisionError: division by zero\n\ntest_fixtures.py:20: ZeroDivisionError\n=========================== short test summary info ============================\nERROR test_fixtures.py::test_other_data - ZeroDivisionError: division by zero\n=============================== 1 error in 0.02s ===============================\n'})}),"\n",(0,t.jsx)(s.h3,{id:"using-multiple-fixtures",children:"Using Multiple Fixtures"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"ch3/a/tasks_proj/tests/conftest.py",children:(0,t.jsx)(s.code,{children:"tests/conftest.py"})}),":"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.fixture()\ndef tasks_db(tmpdir):\n    """Connect to db before tests, disconnect after."""\n    # Setup : start db\n    tasks.start_tasks_db(str(tmpdir), "tiny")\n\n    yield  # this is where the testing happens\n\n    # Teardown : stop db\n    tasks.stop_tasks_db()\n\n\n@pytest.fixture()\ndef tasks_just_a_few():\n    """All summaries and owners are unique."""\n    return (\n        Task("Write some code", "Brian", True),\n        Task("Code review Brian\'s code", "Katie", False),\n        Task("Fix what Brian did", "Michelle", False),\n    )\n\n\n@pytest.fixture()\ndef db_with_3_tasks(tasks_db, tasks_just_a_few):\n    """Connected db with 3 tasks, all unique."""\n    for t in tasks_just_a_few:\n        tasks.add(t)\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"ch3/a/tasks_proj/tests/func/test_add.py",children:(0,t.jsx)(s.code,{children:"func/test_add.py"})}),":"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'def test_add_increases_count(db_with_3_tasks):\n    """Test tasks.add() affect on tasks.count()."""\n    # GIVEN a db with 3 tasks\n    #  WHEN another task is added\n    tasks.add(Task("throw a party"))\n\n    #  THEN the count increases by 1\n    assert tasks.count() == 4\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --setup-show func/test_add.py::test_add_increases_count\n============================= test session starts ==============================\n...\ncollected 1 item\n\nfunc/test_add.py\nSETUP    S tmp_path_factory\n        SETUP    F tmp_path (fixtures used: tmp_path_factory)\n        SETUP    F tmpdir (fixtures used: tmp_path)\n        SETUP    F tasks_db (fixtures used: tmpdir)\n        SETUP    F tasks_just_a_few\n        SETUP    F db_with_3_tasks (fixtures used: tasks_db, tasks_just_a_few)\n        func/test_add.py::test_add_increases_count (fixtures used: db_with_3_tasks, request, tasks_db, tasks_just_a_few, tmp_path, tmp_path_factory, tmpdir).\n        TEARDOWN F db_with_3_tasks\n        TEARDOWN F tasks_just_a_few\n        TEARDOWN F tasks_db\n        TEARDOWN F tmpdir\n        TEARDOWN F tmp_path\nTEARDOWN S tmp_path_factory\n"})}),"\n",(0,t.jsx)(s.h3,{id:"specifying-fixture-scope",children:"Specifying Fixture Scope"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Fixtures include an optional parameter called ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"scope"})}),", which controls how often a fixture gets set up and torn down","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:'scope="function"'}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"run once per test function"}),"\n",(0,t.jsxs)(s.li,{children:["default scope used when no ",(0,t.jsx)(s.code,{children:"scope"})," parameter is specified"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:'scope="class"'}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"run once per test class, regardless of how many test methods are in the class"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:'scope="module"'}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"run once per module, regardless of how many test functions or methods or other fixtures in the module use it"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:'scope="session"'}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"run once per session"}),"\n",(0,t.jsx)(s.li,{children:"all test methods and functions using a fixture of session scope share one setup and teardown call"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["The scope is set at the definition of a fixture, and not at the place where it's called","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"test functions that use a fixture don't control how often a fixture is set up and torn down"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.li,{children:"Fixtures can only depend on other fixtures of their same scope or wider"}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"ch3/b/tasks_proj/tests/conftest.py",children:(0,t.jsx)(s.code,{children:"tests/conftest.py"})}),":"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.fixture(scope="session")\ndef tasks_just_a_few():\n    """All summaries and owners are unique."""\n    return (\n        Task("Write some code", "Brian", True),\n        Task("Code review Brian\'s code", "Katie", False),\n        Task("Fix what Brian did", "Michelle", False),\n    )\n\n\n@pytest.fixture(scope="session")\ndef tasks_db_session(tmpdir_factory):\n    """Connect to db before tests, disconnect after."""\n    temp_dir = tmpdir_factory.mktemp("temp")\n    tasks.start_tasks_db(str(temp_dir), "tiny")\n    yield\n    tasks.stop_tasks_db()\n\n\n@pytest.fixture()\ndef tasks_db(tasks_db_session):\n    """An empty tasks db."""\n    tasks.delete_all()\n\n\n@pytest.fixture()\ndef db_with_3_tasks(tasks_db, tasks_just_a_few):\n    """Connected db with 3 tasks, all unique."""\n    for t in tasks_just_a_few:\n        tasks.add(t)\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"ch3/b/tasks_proj/tests/func/test_add.py",children:(0,t.jsx)(s.code,{children:"func/test_add.py"})}),":"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'def test_add_increases_count(db_with_3_tasks):\n    """Test tasks.add() affect on tasks.count()."""\n    # GIVEN a db with 3 tasks\n    #  WHEN another task is added\n    tasks.add(Task("throw a party"))\n\n    #  THEN the count increases by 1\n    assert tasks.count() == 4\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --setup-show func/test_add.py::test_add_increases_count\n============================= test session starts ==============================\n...\ncollected 1 item\n\nfunc/test_add.py\nSETUP    S tasks_just_a_few\nSETUP    S tmp_path_factory\nSETUP    S tmpdir_factory (fixtures used: tmp_path_factory)\nSETUP    S tasks_db_session (fixtures used: tmpdir_factory)\n        SETUP    F tasks_db (fixtures used: tasks_db_session)\n        SETUP    F db_with_3_tasks (fixtures used: tasks_db, tasks_just_a_few)\n        func/test_add.py::test_add_increases_count (fixtures used: db_with_3_tasks, request, tasks_db, tasks_db_session, tasks_just_a_few, tmp_path_factory, tmpdir_factory).\n        TEARDOWN F db_with_3_tasks\n        TEARDOWN F tasks_db\nTEARDOWN S tasks_db_session\nTEARDOWN S tmpdir_factory\nTEARDOWN S tmp_path_factory\nTEARDOWN S tasks_just_a_few\n"})}),"\n",(0,t.jsx)(s.h3,{id:"specifying-fixtures-with-usefixtures",children:"Specifying Fixtures with usefixtures"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["You can also mark a test or a class with ",(0,t.jsx)(s.code,{children:"@pytest.mark.usefixtures('fixture1', 'fixture2')"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"takes a string that is composed of a comma-separated list of fixtures to use"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["A test using a fixture due to ",(0,t.jsx)(s.code,{children:"usefixtures"})," cannot use the fixture's return value"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"ch3/test_scope.py",children:(0,t.jsx)(s.code,{children:"ch3/test_scope.py"})})]}),"\n"]}),"\n",(0,t.jsxs)(s.h3,{id:"using-autouse-for-fixtures-that-always-get-used",children:["Using ",(0,t.jsx)(s.code,{children:"autouse"})," for Fixtures That Always Get Used"]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["You can use ",(0,t.jsx)(s.code,{children:"autouse=True"})," to get a fixture to run all of the time"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"ch3/test_autouse.py",children:(0,t.jsx)(s.code,{children:"ch3/test_autouse.py"})})]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"renaming-fixtures",children:"Renaming Fixtures"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["pytest allows you to rename fixtures with a ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.code,{children:"name"})})," parameter to ",(0,t.jsx)(s.code,{children:"@pytest.fixture()"})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@pytest.fixture(name="lue")\ndef ultimate_answer_to_life_the_universe_and_everything():\n    """Return ultimate answer."""\n    return 42\n\n\ndef test_everything(lue):\n    """Use the shorter name."""\n    assert lue == 42\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --setup-show test_rename_fixture.py\n============================= test session starts ==============================\n...\ncollected 1 item\n\ntest_rename_fixture.py\n        SETUP    F lue\n        test_rename_fixture.py::test_everything (fixtures used: lue).\n        TEARDOWN F lue\n\n============================== 1 passed in 0.00s ===============================\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Use the ",(0,t.jsx)(s.code,{children:"--fixtures"})," pytest option to find out where ",(0,t.jsx)(s.code,{children:"lue"})," is defined","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"lists all the fixtures available for the test, including ones that have been renamed"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"--fixtures, --funcargs\n                        show available fixtures, sorted by plugin appearance\n                        (fixtures with leading '_' are only shown with '-v')\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --fixtures test_rename_fixture.py\n============================= test session starts ==============================\n...\ncollected 1 item\ncache\n    Return a cache object that can persist state between testing sessions.\n    ...\n...\n------------------ fixtures defined from test_rename_fixture -------------------\nlue\n    Return ultimate answer.\n\n\n============================ no tests ran in 0.00s =============================\n"})}),"\n",(0,t.jsx)(s.h3,{id:"parametrizing-fixtures",children:"Parametrizing Fixtures"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"ch3/b/tasks_proj/tests/func/test_add_variety2.py",children:(0,t.jsx)(s.code,{children:"func/test_add_variety2.py"})})}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'tasks_to_try = (\n    Task("sleep", done=True),\n    Task("wake", "brian"),\n    Task("breathe", "BRIAN", True),\n    Task("exercise", "BrIaN", False),\n)\n\n\n@pytest.fixture(params=tasks_to_try)\ndef a_task(request):\n    """Using no ids."""\n    return request.param\n\n\ndef test_add_a(tasks_db, a_task):\n    """Using a_task fixture (no ids)."""\n    task_id = tasks.add(a_task)\n    t_from_db = tasks.get(task_id)\n    assert equivalent(t_from_db, a_task)\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"request"})," is a built-in fixture that represents the calling state of the fixture","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["has a field ",(0,t.jsx)(s.code,{children:"param"})," that is filled in with one element from the list assigned to ",(0,t.jsx)(s.code,{children:"params"})," in ",(0,t.jsx)(s.code,{children:"@pytest.fixture(params=tasks_to_try)"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --setup-show test_add_variety2.py::test_add_a\n============================= test session starts ==============================\n...\ncollected 4 items\n\ntest_add_variety2.py\nSETUP    S tmp_path_factory\nSETUP    S tmpdir_factory (fixtures used: tmp_path_factory)\nSETUP    S tasks_db_session (fixtures used: tmpdir_factory)\n        SETUP    F tasks_db (fixtures used: tasks_db_session)\n        SETUP    F a_task[Task(summary='sleep', owner=None, done=True, id=None)]\n        func/test_add_variety2.py::test_add_a[a_task0] (fixtures used: a_task, request, tasks_db, tasks_db_session, tmp_path_factory, tmpdir_factory).\n        TEARDOWN F a_task[Task(summary='sleep', owner=None, done=True, id=None)]\n        TEARDOWN F tasks_db\n        SETUP    F tasks_db (fixtures used: tasks_db_session)\n        SETUP    F a_task[Task(summary='wake', owner='brian', done=False, id=None)]\n        func/test_add_variety2.py::test_add_a[a_task1] (fixtures used: a_task, request, tasks_db, tasks_db_session, tmp_path_factory, tmpdir_factory).\n        TEARDOWN F a_task[Task(summary='wake', owner='brian', done=False, id=None)]\n        TEARDOWN F tasks_db\n        SETUP    F tasks_db (fixtures used: tasks_db_session)\n        SETUP    F a_task[Task(summary='breathe', owner='BRIAN', done=True, id=None)]\n        func/test_add_variety2.py::test_add_a[a_task2] (fixtures used: a_task, request, tasks_db, tasks_db_session, tmp_path_factory, tmpdir_factory).\n        TEARDOWN F a_task[Task(summary='breathe', owner='BRIAN', done=True, id=None)]\n        TEARDOWN F tasks_db\n        SETUP    F tasks_db (fixtures used: tasks_db_session)\n        SETUP    F a_task[Task(summary='exercise', owner='BrIaN', done=False, id=None)]\n        func/test_add_variety2.py::test_add_a[a_task3] (fixtures used: a_task, request, tasks_db, tasks_db_session, tmp_path_factory, tmpdir_factory).\n        TEARDOWN F a_task[Task(summary='exercise', owner='BrIaN', done=False, id=None)]\n        TEARDOWN F tasks_db\nTEARDOWN S tasks_db_session\nTEARDOWN S tmpdir_factory\nTEARDOWN S tmp_path_factory\n\n============================== 4 passed in 0.67s ===============================\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"ids"}),": list of string ids each corresponding to the params so that they are part of the test id"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'task_ids = ["Task({},{},{})".format(t.summary, t.owner, t.done) for t in tasks_to_try]\n\n\n@pytest.fixture(params=tasks_to_try, ids=task_ids)\ndef b_task(request):\n    """Using a list of ids."""\n    return request.param\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["We can also set the ",(0,t.jsx)(s.code,{children:"ids"})," parameter to a function that provides the identifiers"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'def id_func(fixture_value):\n    """A function for generating ids."""\n    t = fixture_value\n    return "Task({},{},{})".format(t.summary, t.owner, t.done)\n\n\n@pytest.fixture(params=tasks_to_try, ids=id_func)\ndef c_task(request):\n    """Using a function (id_func) to generate ids."""\n    return request.param\n\n\ndef test_add_c(tasks_db, c_task):\n    """Use fixture with generated ids."""\n    task_id = tasks.add(c_task)\n    t_from_db = tasks.get(task_id)\n    assert equivalent(t_from_db, c_task)\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Since the parametrization is a list of ",(0,t.jsx)(s.code,{children:"Task"})," objects, ",(0,t.jsx)(s.code,{children:"id_func()"})," will be called with a ",(0,t.jsx)(s.code,{children:"Task"})," object, which allows us to use the ",(0,t.jsx)(s.code,{children:"namedtuple"})," accessor methods to access a single ",(0,t.jsx)(s.code,{children:"Task"})," object to generate the identifier for one ",(0,t.jsx)(s.code,{children:"Task"})," object at a time"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"4-builtin-fixtures",children:"4. Builtin Fixtures"}),"\n",(0,t.jsxs)(s.h3,{id:"using-tmpdir-and-tmpdir_factory",children:["Using ",(0,t.jsx)(s.code,{children:"tmpdir"})," and ",(0,t.jsx)(s.code,{children:"tmpdir_factory"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"tmpdir"})," and ",(0,t.jsx)(s.code,{children:"tmpdir_factory"})," builtin fixtures are used to create a temporary file system directory before your test runs, and remove the directory when your test is finished"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"https://docs.pytest.org/en/stable/reference.html#tmpdir",children:(0,t.jsx)(s.code,{children:"tmpdir"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"to create files or directories used by a single test"}),"\n",(0,t.jsx)(s.li,{children:"function scope"}),"\n",(0,t.jsxs)(s.li,{children:["the value returned from ",(0,t.jsx)(s.code,{children:"tmpdir"})," is an object of type ",(0,t.jsx)(s.a,{href:"https://py.readthedocs.io/en/latest/path.html",children:(0,t.jsx)(s.code,{children:"py.path.local"})})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"https://docs.pytest.org/en/stable/reference.html#tmpdir-factory",children:(0,t.jsx)(s.code,{children:"tmpdir_factory"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"to set up a directory for many tests"}),"\n",(0,t.jsx)(s.li,{children:"session scope"}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"mktemp()"}),": creates a directory"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"getbasetemp()"}),": returns the base directory used for this session","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"base directory is left alone after a session, but only the most recent few temporary base directories are left on the system"}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"pytest --basetemp=mydir"})," to specify your own base directory"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"ch4/test_tmpdir.py",children:(0,t.jsx)(s.code,{children:"ch4/test_tmpdir.py"})})]}),"\n",(0,t.jsxs)(s.li,{children:["Temporary directories for other scopes","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["create another fixture of the scope we want and have it use ",(0,t.jsx)(s.code,{children:"tmpdir_factory"})]}),"\n",(0,t.jsxs)(s.li,{children:["e.g., put a ",(0,t.jsx)(s.code,{children:"module"})," scope fixture in either the module itself, or in a ",(0,t.jsx)(s.code,{children:"conftest.py"})," file"]}),"\n",(0,t.jsxs)(s.li,{children:["see:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"ch4/authors/conftest.py",children:(0,t.jsx)(s.code,{children:"authors/conftest.py"})})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"ch4/authors/test_authors.py",children:(0,t.jsx)(s.code,{children:"authors/test_authors.py"})})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.h3,{id:"using-pytestconfig",children:["Using ",(0,t.jsx)(s.code,{children:"pytestconfig"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["With the ",(0,t.jsx)(s.code,{children:"pytestconfig"})," builtin fixture, you can control how pytest runs through command-line arguments and options, configuration files, plugins, and the directory from which you launched pytest"]}),"\n",(0,t.jsxs)(s.li,{children:["Shortcut to ",(0,t.jsx)(s.code,{children:"request.config"})]}),"\n",(0,t.jsx)(s.li,{children:'Sometimes referred to in the pytest documentation as "the pytest config object"'}),"\n",(0,t.jsxs)(s.li,{children:["Adding a custom command-line option and read the option value from within a test","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["read the value of command-line options directly from ",(0,t.jsx)(s.code,{children:"pytestconfig"})]}),"\n",(0,t.jsxs)(s.li,{children:["add the option and have pytest parse it using a ",(0,t.jsx)(s.em,{children:"hook function"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["should be done via plugins or in the ",(0,t.jsx)(s.code,{children:"conftest.py"})," file at the top of your project directory structure"]}),"\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.a,{href:"ch4/pytestconfig/conftest.py",children:(0,t.jsx)(s.code,{children:"pytestconfig/conftest.py"})})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --help\nusage: pytest [options] [file_or_dir] [file_or_dir] [...]\n\n...\ncustom options:\n  --myopt               some boolean option\n  --foo=FOO             foo: bar or baz\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["You can then","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"access options from a test"}),"\n",(0,t.jsxs)(s.li,{children:["access ",(0,t.jsx)(s.code,{children:"pytestconfig"})," from a fixture"]}),"\n",(0,t.jsx)(s.li,{children:"make fixture for the option name"}),"\n",(0,t.jsx)(s.li,{children:"access builtin options as well as information about how pytest was started (the directory, the arguments, and so on)"}),"\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.a,{href:"ch4/pytestconfig/test_config.py",children:(0,t.jsx)(s.code,{children:"pytestconfig/test_config.py"})})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:'$ pytest -s -q --myopt --foo baz test_config.py::test_option\n"foo" set to: baz\n"myopt" set to: True\n.\n1 passed in 0.07s\n\n$ pytest -s -q --myopt --foo baz test_config.py::test_pytestconfig\nargs            : [\'test_config.py::test_pytestconfig\']\ninifile         : None\ninvocation_dir  : /.../ch4/pytestconfig\nrootdir         : /.../ch4/pytestconfig\n-k EXPRESSION   :\n-v, --verbose   : -1\n-q, --quiet     : 1\n-l, --showlocals: False\n--tb=style      : auto\n.\n1 passed in 0.00s\n'})}),"\n",(0,t.jsxs)(s.h3,{id:"using-cache",children:["Using ",(0,t.jsx)(s.code,{children:"cache"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Sometimes passing information from one test session to the next can be quite useful","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["with the ",(0,t.jsx)(s.code,{children:"cache"})," builtin fixture"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"cache"})," is used for the ",(0,t.jsx)(s.code,{children:"--last-failed"})," and ",(0,t.jsx)(s.code,{children:"--failed-first"})," builtin functionality"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --cache-clear cache/test_pass_fail.py\n============================= test session starts ==============================\n...\ncollected 2 items\n\ncache/test_pass_fail.py .F                                               [100%]\n\n=================================== FAILURES ===================================\n_______________________________ test_this_fails ________________________________\n\n    def test_this_fails():\n>       assert 1 == 2\nE       assert 1 == 2\n\ncache/test_pass_fail.py:6: AssertionError\n=========================== short test summary info ============================\nFAILED cache/test_pass_fail.py::test_this_fails - assert 1 == 2\n========================= 1 failed, 1 passed in 0.02s ==========================\n\n$ pytest --cache-show\n============================= test session starts ==============================\n...\ncachedir: /.../ch4/.pytest_cache\n----------------------------- cache values for '*' -----------------------------\ncache/lastfailed contains:\n  {'cache/test_pass_fail.py::test_this_fails': True}\ncache/nodeids contains:\n  ['cache/test_pass_fail.py::test_this_passes',\n   'cache/test_pass_fail.py::test_this_fails']\ncache/stepwise contains:\n  []\n\n============================ no tests ran in 0.00s =============================\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The interface for the ",(0,t.jsx)(s.code,{children:"cache"})," fixture:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"cache.get(key, default)"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"cache.set(key, value)"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["By convention, key names start with the name of your application or plugin, followed by a ",(0,t.jsx)(s.code,{children:"/"}),", and continuing to separate sections of the key name with ",(0,t.jsx)(s.code,{children:"/"}),"s","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"the value you store can be anything that is convertible to json"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Example: a fixture that records how long tests take, saves the times, and on the next run, reports an error on tests that take longer than, say, twice as long as last time","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.a,{href:"ch4/cache/test_slower.py",children:(0,t.jsx)(s.code,{children:"cache/test_slower.py"})})]}),"\n",(0,t.jsxs)(s.li,{children:["see also: ",(0,t.jsx)(s.a,{href:"ch4/cache/test_slower_2.py",children:(0,t.jsx)(s.code,{children:"cache/test_slower_2.py"})})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.h3,{id:"using-capsys",children:["Using ",(0,t.jsx)(s.code,{children:"capsys"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"capsys"})," builtin fixture provides two bits of functionality:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["retrieve ",(0,t.jsx)(s.code,{children:"stdout"})," and ",(0,t.jsx)(s.code,{children:"stderr"})," from some code"]}),"\n",(0,t.jsx)(s.li,{children:"disables output capture temporarily"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["The captured ",(0,t.jsx)(s.code,{children:"stdout"})," and ",(0,t.jsx)(s.code,{children:"stderr"})," are retrieved from ",(0,t.jsx)(s.code,{children:"capsys.readouterr()"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"return value is whatever has been captured since the beginning of the function, or from the last time it was called"}),"\n",(0,t.jsxs)(s.li,{children:["see ",(0,t.jsx)(s.a,{href:"ch4/cap/test_capsys.py",children:(0,t.jsx)(s.code,{children:"cap/test_capsys.py"})})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Use ",(0,t.jsx)(s.code,{children:"with capsys.disabled()"})," to temporarily let output get past the capture mechanism"]}),"\n"]}),"\n",(0,t.jsxs)(s.h3,{id:"using-monkeypatch",children:["Using ",(0,t.jsx)(s.code,{children:"monkeypatch"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:['A "monkey patch" is a dynamic modification of a class or module during runtime',"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"a convenient way to take over part of the runtime environment of the code under test and replace either input dependencies or output dependencies with objects or functions that are more convenient for testing"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"monkeypatch"})," fixture provides the following functions:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"setattr(target, name, value=<notset>, raising=True)"}),": Set an attribute"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"delattr(target, name=<notset>, raising=True)"}),": Delete an attribute"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"setitem(dic, name, value)"}),": Set a dictionary entry"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"delitem(dic, name, raising=True)"}),": Delete a dictionary entry"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"setenv(name, value, prepend=None)"}),": Set an environmental variable"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"delenv(name, raising=True)"}),": Delete an environmental variable"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"syspath_prepend(path)"}),": Prepend path to sys.path, which is Python's list of import locations"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"chdir(path)"}),": Change the current working directory"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"https://docs.pytest.org/en/latest/reference.html#monkeypatch",children:"https://docs.pytest.org/en/latest/reference.html#monkeypatch"})]}),"\n",(0,t.jsxs)(s.li,{children:["Consider (see: ",(0,t.jsx)(s.a,{href:"ch4/monkey/cheese.py",children:(0,t.jsx)(s.code,{children:"monkey/cheese.py"})}),"):"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'def write_cheese_preferences(prefs):\n    full_path = os.path.expanduser("~/.cheese.json")\n    with open(full_path, "w") as f:\n        json.dump(prefs, f, indent=4)\n\n\ndef write_default_cheese_preferences():\n    write_cheese_preferences(_default_prefs)\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"write_default_cheese_preferences()"})," is a function that takes no parameters and doesn't return anything","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"has a side effect that we can test - it writes a file to the current user's home directory"}),"\n",(0,t.jsxs)(s.li,{children:["patch ",(0,t.jsx)(s.code,{children:"expanduser"})," so that anything in the ",(0,t.jsx)(s.code,{children:"cheese"})," module that calls ",(0,t.jsx)(s.code,{children:"os.path.expanduser()"})," gets our lambda expression instead"]}),"\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.code,{children:"test_def_prefs_change_expanduser(tmpdir, monkeypatch)"})," in ",(0,t.jsx)(s.a,{href:"ch4/monkey/test_cheese.py",children:(0,t.jsx)(s.code,{children:"monkey/test_cheese.py"})})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'monkeypatch.setattr(\n    cheese.os.path, "expanduser", (lambda x: x.replace("~", str(fake_home_dir)))\n)\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Use ",(0,t.jsx)(s.code,{children:"monkeypatch.setitem()"})," to change dictionary items just for the duration of the test","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.code,{children:"test_def_prefs_change_defaults(tmpdir, monkeypatch)"})," in ",(0,t.jsx)(s.a,{href:"ch4/monkey/test_cheese.py",children:(0,t.jsx)(s.code,{children:"monkey/test_cheese.py"})})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"syspath_prepend(path)"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"puts your new path at the head of the line for module import directories"}),"\n",(0,t.jsx)(s.li,{children:"one use would be to replace a system-wide module or package with a stub version, and the code under test will find the stub version first"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"chdir(path)"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"changes the current working directory during the test"}),"\n",(0,t.jsx)(s.li,{children:"useful for testing command-line scripts and other utilities that depend on what the current working directory is by setting up a temporary directory with whatever contents make sense for your script"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["You can also use the ",(0,t.jsx)(s.code,{children:"monkeypatch"})," fixture functions in conjunction with ",(0,t.jsx)(s.code,{children:"unittest.mock"})," to temporarily replace attributes with mock objects"]}),"\n"]}),"\n",(0,t.jsxs)(s.h3,{id:"using-doctest_namespace",children:["Using ",(0,t.jsx)(s.code,{children:"doctest_namespace"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"doctest"})," module is part of the standard Python library and allows you to put little code examples inside docstrings for a function and test them to make sure they work"]}),"\n",(0,t.jsxs)(s.li,{children:["You can have pytest look for and run doctest tests within your Python code by using the ",(0,t.jsx)(s.code,{children:"--doctest-modules"})," flag"]}),"\n",(0,t.jsxs)(s.li,{children:["With the ",(0,t.jsx)(s.code,{children:"doctest_namespace"})," fixture, you can build ",(0,t.jsx)(s.code,{children:"autouse"})," fixtures to add symbols to the namespace pytest uses while running doctest tests","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"commonly used to add module imports into the namespace"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"ch4/dt/3/unnecessary_math.py",children:(0,t.jsx)(s.code,{children:"3/unnecessary_math.py"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["since the name ",(0,t.jsx)(s.code,{children:"unnecessary_math"})," is long, we decide to use ",(0,t.jsx)(s.code,{children:"um"})," instead by using ",(0,t.jsx)(s.code,{children:"import unnecessary_math as um"})," in the top docstring"]}),"\n",(0,t.jsxs)(s.li,{children:["code in the docstrings of the functions doesn't include the ",(0,t.jsx)(s.code,{children:"import"})," statement, but continue with the ",(0,t.jsx)(s.code,{children:"um"})," convention"]}),"\n",(0,t.jsx)(s.li,{children:"the problem is that pytest treats each docstring with code as a different test"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"doctest_namespace"}),", used in an ",(0,t.jsx)(s.code,{children:"autouse"})," fixture at a top-level ",(0,t.jsx)(s.code,{children:"conftest.py"})," file, will fix the problem without changing the source code","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.a,{href:"ch4/dt/3/conftest.py",children:(0,t.jsx)(s.code,{children:"3/conftest.py"})})]}),"\n",(0,t.jsxs)(s.li,{children:["any doctests found within the scope of this ",(0,t.jsx)(s.code,{children:"conftest.py"})," file will have the ",(0,t.jsx)(s.code,{children:"um"})," symbol defined"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest -v --doctest-modules dt/3/unnecessary_math.py\n============================= test session starts ==============================\n...\ncollected 3 items\n\ndt/3/unnecessary_math.py::unnecessary_math PASSED                        [ 33%]\ndt/3/unnecessary_math.py::unnecessary_math.divide PASSED                 [ 66%]\ndt/3/unnecessary_math.py::unnecessary_math.multiply PASSED               [100%]\n\n============================== 3 passed in 0.02s ===============================\n"})}),"\n",(0,t.jsxs)(s.h3,{id:"using-recwarn",children:["Using ",(0,t.jsx)(s.code,{children:"recwarn"})]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Warnings work a lot like assertions, but are used for things that don't need to stop execution"}),"\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"recwarn"})," fixture is used to examine warnings generated by code under test","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.a,{href:"ch4/test_warnings.py",children:(0,t.jsx)(s.code,{children:"ch4/test_warnings.py"})})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"recwarn"})," value acts like a list of warnings, and each warning in the list has a ",(0,t.jsx)(s.code,{children:"category"}),", ",(0,t.jsx)(s.code,{children:"message"}),", ",(0,t.jsx)(s.code,{children:"filename"}),", and ",(0,t.jsx)(s.code,{children:"lineno"})," defined"]}),"\n",(0,t.jsxs)(s.li,{children:["The warnings are collected at the beginning of the test","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["if that is inconvenient because the portion of the test where you care about warnings is near the end, you can use ",(0,t.jsx)(s.code,{children:"recwarn.clear()"})," to clear out the list before the chunk of the test where you do care about collecting warnings"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["pytest can also check for warnings with ",(0,t.jsx)(s.code,{children:"pytest.warns()"})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"with pytest.warns(None) as warning_list:\n    lame_function()\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"recwarn"})," and the ",(0,t.jsx)(s.code,{children:"pytest.warns()"})," context manager provide similar functionality, so the decision of which to use is purely a matter of taste"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"5plugins",children:"5.Plugins"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"The pytest code base is structured with customization and extensions, and there are hooks available to allow modifications and improvements through plugins"}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"finding-plugins",children:"Finding Plugins"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"https://docs.pytest.org/en/latest/plugins.html",children:"https://docs.pytest.org/en/latest/plugins.html"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"lists a few common plugins"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"https://pypi.python.org",children:"https://pypi.python.org"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"the Python Package Index (PyPI) is a great place to find pytest plugins"}),"\n",(0,t.jsx)(s.li,{children:'enter "pytest," "pytest-," or "-pytest" into the search box'}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"https://github.com/pytest-dev",children:"https://github.com/pytest-dev"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"you can find some popular pytest plugins that are intended to be maintained long-term by the pytest core team"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"installing-plugins",children:"Installing Plugins"}),"\n",(0,t.jsx)(s.h4,{id:"install-from-pypi",children:"Install from PyPI"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"As PyPI is the default location for pip, installing plugins from PyPI is the easiest method"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pip install pytest-cov\u200b\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"This installs the latest stable version from PyPI."}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"install-from-a-targz-or-whl",children:"Install from a .tar.gz or .whl"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["File Packages on PyPI are distributed as zipped files with the extensions ",(0,t.jsx)(s.code,{children:".tar.gz"})," (tar balls) and/or ",(0,t.jsx)(s.code,{children:".whl"})," (wheels)","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"you can download and install from that"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pip install pytest-cov-2.4.0.tar.gz\u200b\n\u200b# or\n$ pip install pytest_cov-2.4.0-py2.py3-none-any.whl\u200b\n"})}),"\n",(0,t.jsx)(s.h4,{id:"install-from-a-local-directory",children:"Install from a Local Directory"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["You can keep a local stash of plugins (and other Python packages) in a local or shared directory in ",(0,t.jsx)(s.code,{children:".tar.gz"})," or ",(0,t.jsx)(s.code,{children:".whl"})," format, and use that instead"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ cp pytest_cov-2.4.0-py2.py3-none-any.whl some_plugins/\u200b\n$ pip install --no-index --find-links=./some_plugins/ pytest-cov\u200b\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--no-index"})," tells ",(0,t.jsx)(s.code,{children:"pip"})," to not connect to PyPI"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--find-links=./some_plugins/"})," tells ",(0,t.jsx)(s.code,{children:"pip"})," to look in the directory called some_plugins"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"install-from-a-git-repository",children:"Install from a Git Repository"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pip install git+https://github.com/pytest-dev/pytest-cov\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"With version tag:"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pip install git+https://github.com/pytest-dev/pytest-cov@v2.4.0\u200b\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Specify a branch:"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pip install git+https://github.com/pytest-dev/pytest-cov@master\u200b\n"})}),"\n",(0,t.jsx)(s.h3,{id:"writing-your-own-plugins",children:"Writing Your Own Plugins"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Plugins can include hook functions that alter pytest's behavior"}),"\n",(0,t.jsxs)(s.li,{children:["A lot of hook functions are available","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://docs.pytest.org/en/latest/_modules/_pytest/hookspec.html",children:"https://docs.pytest.org/en/latest/_modules/_pytest/hookspec.html"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://docs.pytest.org/en/latest/reference.html#hooks",children:"https://docs.pytest.org/en/latest/reference.html#hooks"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Frequently, changes you only intended to use on one project will become useful enough to share and grow into a plugin","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["therefore, we'll start by adding functionality to a ",(0,t.jsx)(s.code,{children:"conftest.py"})," file, then, after we get things working in ",(0,t.jsx)(s.code,{children:"conftest.py,"})," we'll move the code to a package"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"ch5/a/tasks_proj/tests/func/test_api_exceptions.py",children:(0,t.jsx)(s.code,{children:"func/test_api_exceptions.py"})})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest -v --tb=no func/test_api_exceptions.py::TestAdd\n============================= test session starts ==============================\n...\ncollected 2 items\n\nfunc/test_api_exceptions.py::TestAdd::test_missing_summary PASSED        [ 50%]\nfunc/test_api_exceptions.py::TestAdd::test_done_not_bool FAILED          [100%]\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Changes:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.a,{href:"ch5/c/tasks_proj/tests/conftest.py",children:(0,t.jsx)(s.code,{children:"tests/conftest.py"})})]}),"\n",(0,t.jsxs)(s.li,{children:['add "Thanks for running the tests" to the header',"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://docs.pytest.org/en/latest/reference.html#_pytest.hookspec.pytest_report_header",children:(0,t.jsx)(s.code,{children:"pytest_report_header()"})})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["change FAILED status indicators (",(0,t.jsx)(s.code,{children:"F"}),') to "OPPORTUNITY for improvement" (',(0,t.jsx)(s.code,{children:"O"}),")","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://docs.pytest.org/en/latest/reference.html#_pytest.hookspec.pytest_report_teststatus",children:(0,t.jsx)(s.code,{children:"pytest_report_teststatus(report)"})})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["use the ",(0,t.jsx)(s.code,{children:"--nice"})," option to turn the behavior on","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://docs.pytest.org/en/latest/reference.html#_pytest.hookspec.pytest_addoption",children:(0,t.jsx)(s.code,{children:"pytest_addoption(parser)"})})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --nice --tb=no func/test_api_exceptions.py::TestAdd\n============================= test session starts ==============================\n...\nThanks for running the tests.\n...\ncollected 2 items\n\nfunc/test_api_exceptions.py .O                                           [100%]\n\n=============================== warnings summary ===============================\n...\n=========================== short test summary info ============================\nOPPORTUNITY for improvement func/test_api_exceptions.py::TestAdd::test_done_not_bool\n=================== 1 failed, 1 passed, 3 warnings in 0.26s ====================\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --nice -v --tb=no func/test_api_exceptions.py::TestAdd\n============================= test session starts ==============================\n...\nThanks for running the tests.\n...\ncollected 2 items\n\nfunc/test_api_exceptions.py::TestAdd::test_missing_summary PASSED        [ 50%]\nfunc/test_api_exceptions.py::TestAdd::test_done_not_bool OPPORTUNITY for improvement [100%]\n\n=============================== warnings summary ===============================\n...\n=========================== short test summary info ============================\nOPPORTUNITY for improvement func/test_api_exceptions.py::TestAdd::test_done_not_bool\n=================== 1 failed, 1 passed, 3 warnings in 0.25s ====================\n"})}),"\n",(0,t.jsx)(s.h3,{id:"creating-an-installable-plugin",children:"Creating an Installable Plugin"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Directory structure:"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"pytest-nice\n\u200b\u251c\u2500\u2500 LICENSE\n\u200b\u251c\u2500\u2500 README.rst\n\u200b\u251c\u2500\u2500 pytest_nice.py\n\u200b\u251c\u2500\u2500 setup.py\n\u2514\u2500\u2500 tests\n    \u251c\u2500\u2500 conftest.py\n    \u2514\u2500\u2500 test_nice.py\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["See:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"ch5/pytest-nice/pytest_nice.py",children:(0,t.jsx)(s.code,{children:"pytest-nice/pytest_nice.py"})})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"ch5/pytest-nice/setup.py",children:(0,t.jsx)(s.code,{children:"pytest-nice/setup.py"})})}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"ch5/pytest-nice/README.rst",children:(0,t.jsx)(s.code,{children:"pytest-nice/README.rst"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Some form of README is a requirement by ",(0,t.jsx)(s.code,{children:"setuptools"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"testing-plugins",children:"Testing Plugins"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Test a plugin using a plugin called ",(0,t.jsx)(s.code,{children:"pytester"})," that ships with pytest but is disabled by default","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["to use ",(0,t.jsx)(s.code,{children:"pytester"}),", we need to add just one line to ",(0,t.jsx)(s.code,{children:"conftest.py"})]}),"\n",(0,t.jsxs)(s.li,{children:["a fixture called ",(0,t.jsx)(s.code,{children:"testdir"})," becomes available when pytester is enabled"]}),"\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.a,{href:"ch5/pytest-nice/tests/conftest.py",children:(0,t.jsx)(s.code,{children:"tests/conftest.py"})})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Tests: ",(0,t.jsx)(s.a,{href:"ch5/pytest-nice/tests/test_nice.py",children:(0,t.jsx)(s.code,{children:"tests/test_nice.py"})})]}),"\n",(0,t.jsx)(s.li,{children:"To run the tests:"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ cd /path/to/ch5/pytest-nice/\n$ pip install .\n...\n$ pytest -v\n...\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["We can uninstall it just like any other Python package or pytest plugin","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"\u200b\u200bpip\u200b\u200b \u200b\u200buninstall\u200b\u200b \u200b\u200bpytest-nice\u200b"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"creating-a-distribution",children:"Creating a Distribution"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["We can use the ",(0,t.jsx)(s.code,{children:"setup.py"})," file to create a distribution"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ cd /path/to/ch5/pytest-nice/\n$ python setup.py sdist\n...\n$ ls dist\npytest-nice-0.1.0.tar.gz\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Note: ",(0,t.jsx)(s.code,{children:"sdist"}),' stands for "source distribution"']}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"distributing-plugins-through-a-shared-directory",children:"Distributing Plugins Through a Shared Directory"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"#install-from-a-local-directory",children:"Install from a Local Directory"})]}),"\n",(0,t.jsxs)(s.li,{children:["If you've done some bug fixes and there are newer versions in myplugins, you can upgrade by adding ",(0,t.jsx)(s.code,{children:"--upgrade"}),":","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"pip install --upgrade --no-index --find-links myplugins pytest-nice"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"distributing-plugins-through-pypi",children:"Distributing Plugins Through PyPI"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["When you are contributing a pytest plugin, a great place to start is by using the ",(0,t.jsx)(s.code,{children:"cookiecutter-pytest-plugin"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see ",(0,t.jsx)(s.a,{href:"https://github.com/pytest-dev/cookiecutter-pytest-plugin",children:"https://github.com/pytest-dev/cookiecutter-pytest-plugin"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"6-configuration",children:"6. Configuration"}),"\n",(0,t.jsx)(s.h3,{id:"understanding-pytest-configuration-files",children:"Understanding pytest Configuration Files"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"pytest.ini"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"primary pytest configuration file that allows you to change default behavior"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"conftest.py"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["local plugin to allow hook functions and fixtures for the directory where the ",(0,t.jsx)(s.code,{children:"conftest.py"})," file exists and all subdirectories"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"__init__.py"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"when put into every test subdirectory, this file allows you to have identical test filenames in multiple test directories"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["If you use tox, ",(0,t.jsx)(s.code,{children:"tox.ini"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["similar to ",(0,t.jsx)(s.code,{children:"pytest.ini"}),", but for tox"]}),"\n",(0,t.jsxs)(s.li,{children:["you can put your pytest configuration here instead of having both a ",(0,t.jsx)(s.code,{children:"tox.ini"})," and a ",(0,t.jsx)(s.code,{children:"pytest.ini"})," file"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["If you want to distribute a Python package, ",(0,t.jsx)(s.code,{children:"setup.cfg"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["in ",(0,t.jsx)(s.code,{children:"ini"})," file format and affects the behavior of ",(0,t.jsx)(s.code,{children:"setup.py"})]}),"\n",(0,t.jsxs)(s.li,{children:["possible to add a couple of lines to ",(0,t.jsx)(s.code,{children:"setup.py"})," to allow you to run python ",(0,t.jsx)(s.code,{children:"setup.py test"})," and have it run all of your pytest tests"]}),"\n",(0,t.jsxs)(s.li,{children:["if you are distributing a package, you may already have a ",(0,t.jsx)(s.code,{children:"setup.cfg"})," file, and you can use that file to store pytest configuration"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["You can get a list of all the valid settings for ",(0,t.jsx)(s.code,{children:"pytest.ini"})," from ",(0,t.jsx)(s.code,{children:"pytest --help"})]}),"\n",(0,t.jsxs)(s.li,{children:["It is possible for plugins (and ",(0,t.jsx)(s.code,{children:"conftest.py"})," files) to add ",(0,t.jsx)(s.code,{children:"ini"})," file options","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["the added options will be added to the pytest ",(0,t.jsx)(s.code,{children:"--help"})," output as well"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"changing-the-default-command-line-options",children:"Changing the Default Command-Line Options"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["To always use some command line options for a project, set ",(0,t.jsx)(s.code,{children:"addopts"})," in ",(0,t.jsx)(s.code,{children:"pytest.ini"})," to the options you want:"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-ini",children:"[pytest]\naddopts = -rsxX -l --tb=short --strict\n"})}),"\n",(0,t.jsx)(s.h3,{id:"registering-markers-to-avoid-marker-typos",children:"Registering Markers to Avoid Marker Typos"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["It's too easy to misspell a marker and end up having some tests with different markers, e.g., ",(0,t.jsx)(s.code,{children:"@pytest.mark.smoke"})," and ",(0,t.jsx)(s.code,{children:"@pytest.mark.somke"})]}),"\n",(0,t.jsxs)(s.li,{children:["Register markers in ",(0,t.jsx)(s.code,{children:"pytest.ini"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.a,{href:"ch6/b/tasks_proj/tests/pytest.ini",children:(0,t.jsx)(s.code,{children:"tests/pytest.ini"})})]}),"\n",(0,t.jsxs)(s.li,{children:["if you use the ",(0,t.jsx)(s.code,{children:"--strict"})," command line option, any misspelled or unregistered markers show up as an error"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-ini",children:"[pytest]\n  smoke: Run the smoke test functions for tasks project\n  get: Run the test functions that test tasks.get()\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --markers\n@pytest.mark.smoke: Run the smoke test test functions\n\n@pytest.mark.get: Run the test functions that test tasks.get()\n\n@pytest.mark.filterwarnings(warning): add a warning filter to the given test. see https://docs.pytest.org/en/latest/warnings.html#pytest-mark-filterwarnings\n"})}),"\n",(0,t.jsx)(s.h3,{id:"requiring-a-minimum-pytest-version",children:"Requiring a Minimum pytest Version"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"minversion"})," setting enables you to specify a minimum pytest version you expect for your tests","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"approx()"})," for testing floating point numbers for was introduced into pytest version 3.0"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-ini",children:"[pytest]\nminversion = 3.0\n"})}),"\n",(0,t.jsx)(s.h3,{id:"stopping-pytest-from-looking-in-the-wrong-places",children:"Stopping pytest from Looking in the Wrong Places"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Test discovery traverses many directories recursively","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"there are some directories you don't want pytest looking in"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["The default setting for ",(0,t.jsx)(s.code,{children:"norecursedirs"})," is ",(0,t.jsx)(s.code,{children:".* build dist CVS _darcs {arch}"})," and ",(0,t.jsx)(s.code,{children:"*.egg"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["you can add ",(0,t.jsx)(s.code,{children:"venv"})," and ",(0,t.jsx)(s.code,{children:"src"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-ini",children:"norecursedirs = .* venv src *.egg dist build\n"})}),"\n",(0,t.jsx)(s.h3,{id:"specifying-test-directory-locations",children:"Specifying Test Directory Locations"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Opposite to ",(0,t.jsx)(s.code,{children:"norecursedirs"}),", ",(0,t.jsx)(s.code,{children:"testpaths"})," tells pytest where to look","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"a list of directories relative to the root directory"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.li,{children:"Example:"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"tasks_proj/\n\u200b\u251c\u2500\u2500 pytest.ini\n\u200b\u251c\u2500\u2500 src\n\u2502   \u2514\u2500\u2500 ...\n\u200b\u2514\u2500\u2500 tests\n\u200b    \u2514\u2500\u2500 ...\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-ini",children:"[pytest]\ntestpaths = tests\n"})}),"\n",(0,t.jsx)(s.h3,{id:"changing-test-discovery-rules",children:"Changing Test Discovery Rules"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Standard test discovery rules:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["start at one or more directory","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"you can specify filenames or directory names on the command line"}),"\n",(0,t.jsx)(s.li,{children:"if you don't specify anything, the current directory is used"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["look in the directory and all subdirectories recursively for test modules","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["a test module is a file with a name that looks like ",(0,t.jsx)(s.code,{children:"test_*.py"})," or ",(0,t.jsx)(s.code,{children:"*_test.py"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["look in test modules for functions that start with ",(0,t.jsx)(s.code,{children:"test_"})]}),"\n",(0,t.jsxs)(s.li,{children:["look for classes that start with ",(0,t.jsx)(s.code,{children:"Test"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["look for methods in those classes that start with ",(0,t.jsx)(s.code,{children:"test_"})," but don't have an ",(0,t.jsx)(s.code,{children:"__init__"})," method"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"python_classes"}),", ",(0,t.jsx)(s.code,{children:"python_files"})," and ",(0,t.jsx)(s.code,{children:"python_functions"})," allow us to name test classes, files and function/method names something else"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-ini",children:"[pytest]\npython_classes = *Test Test* *Suite\npython_files = test_* *_test check_*\npython_functions = test_* check_*\n"})}),"\n",(0,t.jsx)(s.h3,{id:"disallowing-xpass",children:"Disallowing XPASS"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Setting ",(0,t.jsx)(s.code,{children:"xfail_strict = true"})," causes tests marked with ",(0,t.jsx)(s.code,{children:"@pytest.mark.xfail"})," that don't fail to be reported as an error"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"avoiding-filename-collisions",children:"Avoiding Filename Collisions"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["If you have empty ",(0,t.jsx)(s.code,{children:"__init__.py"})," files in all of your test subdirectories, you can have the same test filename show up in multiple directories"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"7-using-pytest-with-other-tools",children:"7. Using pytest with Other Tools"}),"\n",(0,t.jsx)(s.h3,{id:"pdb-debugging-test-failures",children:"pdb: Debugging Test Failures"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["pytest options available to help speed up debugging test failures:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--tb=[auto/long/short/line/native/no]"}),": Controls the traceback style"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-v / --verbose"}),": Displays all the test names, passing or failing"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-l / --showlocals"}),": Displays local variables alongside the stacktrace"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-lf / --last-failed"}),": Runs just the tests that failed last"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-x / --exitfirst"}),": Stops the tests session with the first failure"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"--pdb"}),": Starts an interactive debugging session at the point of failure"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Commands that you can use when you are at the ",(0,t.jsx)(s.code,{children:"(Pdb)"})," prompt:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"p/print expr"}),": Prints the value of ",(0,t.jsx)(s.code,{children:"expr"})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"pp expr"}),": Pretty prints the value of ",(0,t.jsx)(s.code,{children:"expr"})]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"l/list"}),": Lists the point of failure and five lines of code above and below"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"l/list begin,end"}),": Lists specific line numbers"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"a/args"}),": Prints the arguments of the current function with their values (helpful when in a test helper function)"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"u/up"}),": Moves up one level in the stack trace"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"d/down"}),": Moves down one level in the stack trace"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"q/quit"}),": Quits the debugging session"]}),"\n",(0,t.jsxs)(s.li,{children:["other navigation commands like ",(0,t.jsx)(s.code,{children:"step"})," and ",(0,t.jsx)(s.code,{children:"next"})," aren't that useful since we are sitting right at an ",(0,t.jsx)(s.code,{children:"assert"})," statement"]}),"\n",(0,t.jsx)(s.li,{children:"you can also just type variable names and get the values"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:'$ pytest -x --pdb ch2/tasks_proj/tests\n============================= test session starts ==============================\n...\ncollected 56 items\n\nch2/tasks_proj/tests/func/test_add.py ..                                 [  3%]\nch2/tasks_proj/tests/func/test_add_variety.py .......................... [ 50%]\n......                                                                   [ 60%]\nch2/tasks_proj/tests/func/test_api_exceptions.py .......                 [ 73%]\nch2/tasks_proj/tests/func/test_unique_id_1.py F\n>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> traceback >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\n\n    def test_unique_id():\n        """Calling unique_id() twice should return different numbers."""\n        id_1 = tasks.unique_id()\n        id_2 = tasks.unique_id()\n>       assert id_1 != id_2\nE       assert 1 != 1\n\nch2/tasks_proj/tests/func/test_unique_id_1.py:11: AssertionError\n>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> entering PDB >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>\n\n>>>>>>>>>>>>>>>>>> PDB post_mortem (IO-capturing turned off) >>>>>>>>>>>>>>>>>>>\n> /path/to/ch2/tasks_proj/tests/func/test_unique_id_1.py(11)test_unique_id()\n-> assert id_1 != id_2\n(Pdb) p tasks.unique_id()\n1\n(Pdb) id_1\n1\n(Pdb) id_2\n1\n(Pdb) l\n  6\n  7  \tdef test_unique_id():\n  8  \t    """Calling unique_id() twice should return different numbers."""\n  9  \t    id_1 = tasks.unique_id()\n 10  \t    id_2 = tasks.unique_id()\n 11  ->\t    assert id_1 != id_2\n 12\n 13\n 14  \t@pytest.fixture(autouse=True)\n 15  \tdef initialized_tasks_db(tmpdir):\n 16  \t    """Connect to db before testing, disconnect after."""\n(Pdb) u\n> /path/to/venv/lib/python3.6/site-packages/_pytest/python.py(184)pytest_pyfunc_call()\n-> result = testfunction(**testargs)\n(Pdb) a\npyfuncitem = <Function test_unique_id>\n(Pdb) d\n> /path/to/ch2/tasks_proj/tests/func/test_unique_id_1.py(11)test_unique_id()\n-> assert id_1 != id_2\n(Pdb) q\n\n\n=============================== warnings summary ===============================\n...\n=========================== short test summary info ============================\nFAILED ch2/tasks_proj/tests/func/test_unique_id_1.py::test_unique_id - assert...\n!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!\n!!!!!!!!!!!!!!!!!!! _pytest.outcomes.Exit: Quitting debugger !!!!!!!!!!!!!!!!!!!\n============= 1 failed, 41 passed, 4 warnings in 60.26s (0:01:00) ==============\n'})}),"\n",(0,t.jsx)(s.h3,{id:"coveragepy-determining-how-much-code-is-tested",children:"Coverage.py: Determining How Much Code Is Tested"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Coverage.py is the preferred Python coverage tool that measures code coverage"}),"\n",(0,t.jsxs)(s.li,{children:["Installing ",(0,t.jsx)(s.code,{children:"pytest-cov"})," plugin will pull in ",(0,t.jsx)(s.code,{children:"coverage.py"})," since coverage is one its dependencies","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"pip install pytest-cov"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:'$ pytest --help\nusage: pytest [options] [file_or_dir] [file_or_dir] [...]\n\n...\ncoverage reporting with distributed testing support:\n  --cov=[SOURCE]        Path or package name to measure during execution (multi-\n                        allowed). Use --cov= to not do any source filtering and\n                        record everything.\n  --cov-report=TYPE     Type of report to generate: term, term-missing,\n                        annotate, html, xml (multi-allowed). term, term-missing\n                        may be followed by ":skip-covered". annotate, html and\n                        xml may be followed by ":DEST" where DEST specifies the\n                        output location. Use --cov-report= to not generate any\n                        output.\n  --cov-config=PATH     Config file for coverage. Default: .coveragerc\n  --no-cov-on-fail      Do not report coverage if test run fails. Default: False\n  --no-cov              Disable coverage report completely (useful for\n                        debuggers). Default: False\n  --cov-fail-under=MIN  Fail if the total coverage is less than MIN.\n  --cov-append          Do not delete coverage but append to current. Default:\n                        False\n  --cov-branch          Enable branch coverage.\n  --cov-context=CONTEXT\n                        Dynamic contexts to use. "test" for now.\n'})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --cov=src\n============================= test session starts ==============================\n...\nplugins: cov-2.8.1, mock-3.1.0\ncollected 62 items\n\ntests/func/test_add.py ...                                               [  4%]\ntests/func/test_add_variety.py ............................              [ 50%]\ntests/func/test_add_variety2.py ............                             [ 69%]\ntests/func/test_api_exceptions.py .........                              [ 83%]\ntests/func/test_unique_id.py .                                           [ 85%]\ntests/unit/test_cli.py .....                                             [ 93%]\ntests/unit/test_task.py ....                                             [100%]\n\n----------- coverage: platform linux, python 3.6.9-final-0 -----------\nName                           Stmts   Miss  Cover\n--------------------------------------------------\nsrc/tasks/__init__.py              2      0   100%\nsrc/tasks/api.py                  79     22    72%\nsrc/tasks/cli.py                  45     14    69%\nsrc/tasks/config.py               18     12    33%\nsrc/tasks/tasksdb_pymongo.py      74     74     0%\nsrc/tasks/tasksdb_tinydb.py       32      4    88%\n--------------------------------------------------\nTOTAL                            250    126    50%\n\n\n============================== 62 passed in 5.14s ==============================\n"})}),"\n",(0,t.jsx)(s.h3,{id:"mock-swapping-out-part-of-the-system",children:"mock: Swapping Out Part of the System"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"mock"})," package is shipped as part of the Python standard library as ",(0,t.jsx)(s.code,{children:"unittest.mock"})," as of Python 3.3"]}),"\n",(0,t.jsxs)(s.li,{children:["For use with pytest, a plugin called ",(0,t.jsx)(s.code,{children:"pytest-mock"})," has some conveniences"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"list_tasks(owner)"})," in ",(0,t.jsx)(s.a,{href:"ch7/tasks_proj_v2/src/tasks/cli.py",children:(0,t.jsx)(s.code,{children:"tasks/cli.py"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["depends on a couple of other functions","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"tasks_db()"}),", which is a context manager"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"tasks.list_tasks(owner)"}),", which is the API function in ",(0,t.jsx)(s.a,{href:"ch7/tasks_proj_v2/src/tasks/api.py",children:(0,t.jsx)(s.code,{children:"tasks/api.py"})})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["use mock to put fake functions in place for ",(0,t.jsx)(s.code,{children:"tasks_db()"})," and ",(0,t.jsx)(s.code,{children:"tasks.list_tasks()"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["we can call the ",(0,t.jsx)(s.code,{children:"list_tasks"})," method through the command-line interface and make sure it","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["calls the ",(0,t.jsx)(s.code,{children:"tasks.list_tasks()"})," function correctly"]}),"\n",(0,t.jsx)(s.li,{children:"deals with the return value correctly"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Stub ",(0,t.jsx)(s.code,{children:"_tasks_db()"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see ",(0,t.jsx)(s.code,{children:"stub_tasks_db()"})," in ",(0,t.jsx)(s.a,{href:"ch7/tasks_proj_v2/tests/unit/test_cli.py",children:(0,t.jsx)(s.code,{children:"unit/test_cli.py"})})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Use ",(0,t.jsx)(s.code,{children:"mocker"})," to replace the real context manager with our stub","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"mocker"})," is a fixture provided by the ",(0,t.jsx)(s.code,{children:"pytest-mock"})," plugin a convenience interface to ",(0,t.jsx)(s.code,{children:"unittest.mock"})]}),"\n",(0,t.jsxs)(s.li,{children:["see ",(0,t.jsx)(s.code,{children:"test_list_no_args(mocker)"})," in ",(0,t.jsx)(s.a,{href:"ch7/tasks_proj_v2/tests/unit/test_cli.py",children:(0,t.jsx)(s.code,{children:"unit/test_cli.py"})})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"MagicMock"})," class is a flexible subclass of ",(0,t.jsx)(s.code,{children:"unittest.Mock"})," with reasonable default behavior and the ability to specify a return value"]}),"\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"Mock"})," and ",(0,t.jsx)(s.code,{children:"MagicMock"})," classes (and others) are used to mimic the interface of other code with introspection methods built in to allow you to ask them how they were called"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:'@contextmanager\ndef stub_tasks_db():\n    yield\n\n\ndef test_list_no_args(mocker):\n    # Replace the _tasks_db() context manager with our stub that does nothing.\n    mocker.patch.object(tasks.cli, "_tasks_db", new=stub_tasks_db)\n\n    # Replace any calls to tasks.list_tasks() from within tasks.cli to a default\n    # MagicMock object with a return value of an empty list.\n    mocker.patch.object(tasks.cli.tasks, "list_tasks", return_value=[])\n\n    # Use the Click CliRunner to do the same thing as calling tasks list on the command\n    # line.\n    runner = CliRunner()\n    runner.invoke(tasks.cli.tasks_cli, ["list"])\n\n    # Use the mock object to make sure the API call was called correctly.\n    # assert_called_once_with() is part of unittest.mock.Mock objects.\n    tasks.cli.tasks.list_tasks.assert_called_once_with(None)\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["See:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://docs.python.org/dev/library/unittest.mock.html",children:"https://docs.python.org/dev/library/unittest.mock.html"})}),"\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.a,{href:"https://pypi.org/project/pytest-mock/",children:"https://pypi.org/project/pytest-mock/"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"tox-testing-multiple-configurations",children:"tox: Testing Multiple Configurations"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"tox is a command-line tool that allows you to run your complete suite of tests in multiple environments"}),"\n",(0,t.jsxs)(s.li,{children:["You can use it to test with different","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"versions of Python"}),"\n",(0,t.jsx)(s.li,{children:"dependency configurations"}),"\n",(0,t.jsx)(s.li,{children:"configurations for different operating systems"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["tox uses the ",(0,t.jsx)(s.code,{children:"setup.py"})," file for the package under test to create an installable source distribution of your package"]}),"\n",(0,t.jsxs)(s.li,{children:["It looks in ",(0,t.jsx)(s.code,{children:"tox.ini"})," for a list of environments and then for each environment, tox:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["creates a virtual environment in a ",(0,t.jsx)(s.code,{children:".tox"})," directory"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"pip"})," installs some dependencies"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"pip"})," installs your package from the ",(0,t.jsx)(s.code,{children:"sdist"})]}),"\n",(0,t.jsx)(s.li,{children:"runs your tests"}),"\n",(0,t.jsx)(s.li,{children:"reports a summary of how they all did"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Add a ",(0,t.jsx)(s.code,{children:"tox.ini"})," file at the same level as ",(0,t.jsx)(s.code,{children:"setup.py"})," - the top project directory","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["move anything that's in ",(0,t.jsx)(s.code,{children:"pytest.ini"})," into ",(0,t.jsx)(s.code,{children:"tox.ini"})]}),"\n",(0,t.jsxs)(s.li,{children:["see ",(0,t.jsx)(s.a,{href:"ch7/tasks_proj_v2/tox.ini",children:(0,t.jsx)(s.code,{children:"tasks_proj_v2/tox.ini"})})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Install tox (can be done within a virtual environment):","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"pip install tox"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["Run tox:","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:"tox"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"https://tox.readthedocs.io/en/latest/",children:"https://tox.readthedocs.io/en/latest/"})]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"a3-plugin-sampler-pack",children:"A3. Plugin Sampler Pack"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["All of the plugins featured here are available on PyPI and are installed with ",(0,t.jsx)(s.code,{children:"pip install <plugin-name>"})]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"plugins-that-change-the-normal-test-run-flow",children:"Plugins That Change the Normal Test Run Flow"}),"\n",(0,t.jsx)(s.h4,{id:"pytest-repeat-run-tests-more-than-once",children:"pytest-repeat: Run Tests More Than Once"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["To run tests more than once per session, use the ",(0,t.jsx)(s.code,{children:"pytest-repeat"})," plugin"]}),"\n",(0,t.jsx)(s.li,{children:"This plugin is useful if you have an intermittent failure in a test"}),"\n",(0,t.jsxs)(s.li,{children:["You can use ",(0,t.jsx)(s.code,{children:"--count=2"})," to run everything twice"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"https://pypi.org/project/pytest-repeat/",children:"https://pypi.org/project/pytest-repeat/"})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --help\nusage: pytest [options] [file_or_dir] [file_or_dir] [...]\n\n...\ncustom options:\n  --count=COUNT         Number of times to repeat each test\n  --repeat-scope={function,class,module,session}\n                        Scope for repeating tests\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --count=2 -v -k test_list\n============================= test session starts ==============================\n...\nplugins: repeat-0.8.0, cov-2.8.1, mock-3.1.0\ncollected 124 items / 112 deselected / 12 selected\n\ntests/func/test_api_exceptions.py::test_list_raises[1-2] PASSED          [  8%]\ntests/func/test_api_exceptions.py::test_list_raises[2-2] PASSED          [ 16%]\ntests/unit/test_cli.py::test_list_no_args[1-2] PASSED                    [ 25%]\ntests/unit/test_cli.py::test_list_no_args[2-2] PASSED                    [ 33%]\ntests/unit/test_cli.py::test_list_print_empty[1-2] PASSED                [ 41%]\ntests/unit/test_cli.py::test_list_print_empty[2-2] PASSED                [ 50%]\ntests/unit/test_cli.py::test_list_print_many_items[1-2] PASSED           [ 58%]\ntests/unit/test_cli.py::test_list_print_many_items[2-2] PASSED           [ 66%]\ntests/unit/test_cli.py::test_list_dash_o[1-2] PASSED                     [ 75%]\ntests/unit/test_cli.py::test_list_dash_o[2-2] PASSED                     [ 83%]\ntests/unit/test_cli.py::test_list_dash_dash_owner[1-2] PASSED            [ 91%]\ntests/unit/test_cli.py::test_list_dash_dash_owner[2-2] PASSED            [100%]\n\n====================== 12 passed, 112 deselected in 0.26s ======================\n"})}),"\n",(0,t.jsx)(s.h4,{id:"pytest-xdist-run-tests-in-parallel",children:"pytest-xdist: Run Tests in Parallel"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["If your tests do not need access to a shared resource, you could speed up test sessions by running multiple tests in parallel using the ",(0,t.jsx)(s.code,{children:"pytest-xdist"})," plugin"]}),"\n",(0,t.jsx)(s.li,{children:"You can specify multiple processors and run many tests in parallel"}),"\n",(0,t.jsx)(s.li,{children:"You can even push off tests onto other machines and use more than one computer"}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"appendices/xdist/test_parallel.py",children:(0,t.jsx)(s.code,{children:"xdist/test_parallel.py"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"a test that takes at least a second to run, with parametrization such that it runs ten times"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"https://pypi.org/project/pytest-xdist/",children:"https://pypi.org/project/pytest-xdist/"})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --help\nusage: pytest [options] [file_or_dir] [file_or_dir] [...]\n\n...\ndistributed and subprocess testing:\n  -n numprocesses, --numprocesses=numprocesses\n                        shortcut for '--dist=load --tx=NUM*popen', you can use\n                        'auto' here for auto detection CPUs number on host\n                        system and it will be 0 when used with --pdb\n  --maxprocesses=maxprocesses\n                        limit the maximum number of workers to process the tests\n                        when using --numprocesses=auto\n  --max-worker-restart=MAXWORKERRESTART, --max-slave-restart=MAXWORKERRESTART\n                        maximum number of workers that can be restarted when\n                        crashed (set to zero to disable this feature) '--max-\n                        slave-restart' option is deprecated and will be removed\n                        in a future release\n  --dist=distmode       set mode for distributing tests to exec environments.\n                        each: send each test to all available environments.\n                        load: load balance by sending any pending test to any\n                        available environment. loadscope: load balance by\n                        sending pending groups of tests in the same scope to any\n                        available environment. loadfile: load balance by sending\n                        test grouped by file to any available environment.\n                        (default) no: run tests inprocess, don't distribute.\n  --tx=xspec            add a test execution environment. some examples: --tx\n                        popen//python=python2.5 --tx socket=192.168.1.102:8888\n                        --tx ssh=user@codespeak.net//chdir=testcache\n  -d                    load-balance tests. shortcut for '--dist=load'\n  --rsyncdir=DIR        add directory for rsyncing to remote tx nodes.\n  --rsyncignore=GLOB    add expression for ignores when rsyncing to remote tx\n                        nodes.\n  --boxed               backward compatibility alias for pytest-forked --forked\n  --testrunuid=TESTRUNUID\n                        provide an identifier shared amongst all workers as the\n                        value of the 'testrun_uid' fixture, ,if not provided,\n                        'testrun_uid' is filled with a new unique string on\n                        every test run.\n  -f, --looponfail      run tests in subprocess, wait for modified files and re-\n                        run failing test set until all pass.\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest test_parallel.py\n============================= test session starts ==============================\nplugins: xdist-1.32.0, forked-1.1.3, repeat-0.8.0, cov-2.8.1, mock-3.1.0\ncollected 10 items\n\ntest_parallel.py ..........                                              [100%]\n\n============================= 10 passed in 10.08s ==============================\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["You can use","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-n numprocesses"})," to run each test in a subprocess"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"-n auto"})," to automatically detect the number of CPUs on the system"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest -n auto test_parallel.py\n============================= test session starts ==============================\nplugins: xdist-1.32.0, forked-1.1.3, repeat-0.8.0, cov-2.8.1, mock-3.1.0\ngw0 [10] / gw1 [10] / gw2 [10] / gw3 [10] / gw4 [10] / gw5 ok / gw6 [10] / gw7 ogw0 [10] / gw1 [10] / gw2 [10] / gw3 [10] / gw4 [10] / gw5 ok / gw6 [10] / gw7 [gw0 [10] / gw1 [10] / gw2 [10] / gw3 [10] / gw4 [10] / gw5 [10] / gw6 [10] / gw7 [10]\n..........                                                               [100%]\n============================== 10 passed in 3.02s ==============================\n"})}),"\n",(0,t.jsx)(s.h4,{id:"pytest-timeout-put-time-limits-on-your-tests",children:"pytest-timeout: Put Time Limits on Your Tests"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"pytest-timeout"})," plugin allows you pass a timeout period on the command line or mark individual tests with timeout periods in seconds","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["the mark overrides the command line timeout","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:(0,t.jsx)(s.code,{children:'pytest.mark.timeout(timeout=0, method="thread|signal")'})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"https://pypi.org/project/pytest-timeout/",children:"https://pypi.org/project/pytest-timeout/"})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --help\nusage: pytest [options] [file_or_dir] [file_or_dir] [...]\n\n...\nInterrupt test run and dump stacks of all threads after a test times out:\n  --timeout=TIMEOUT     Timeout in seconds before dumping the stacks. Default is\n                        0 which means no timeout.\n  --timeout_method={signal,thread}\n                        Deprecated, use --timeout-method\n  --timeout-method={signal,thread}\n                        Timeout mechanism to use. 'signal' uses SIGALRM if\n                        available, 'thread' uses a timer thread. The default is\n                        to use 'signal' and fall back to 'thread'.\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:'$ pytest --timeout=0.5 -x test_parallel.py\n============================= test session starts ==============================\n...\nplugins: timeout-1.3.4, xdist-1.32.0, forked-1.1.3, repeat-0.8.0, cov-2.8.1, mock-3.1.0\ntimeout: 0.5s\ntimeout method: signal\ntimeout func_only: False\ncollected 10 items\n\ntest_parallel.py F\n\n=================================== FAILURES ===================================\n______________________________ test_something[0] _______________________________\n\nx = 0\n\n    @pytest.mark.parametrize("x", list(range(10)))\n    def test_something(x):\n>       time.sleep(1)\nE       Failed: Timeout >0.5s\n\ntest_parallel.py:7: Failed\n=========================== short test summary info ============================\nFAILED test_parallel.py::test_something[0] - Failed: Timeout >0.5s\n!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!\n============================== 1 failed in 0.60s ===============================\n'})}),"\n",(0,t.jsx)(s.h3,{id:"plugins-that-alter-or-enhance-output",children:"Plugins That Alter or Enhance Output"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"These plugins don't change how test are run, but they do change the output you see"}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"pytest-instafail-see-details-of-failures-and-errors-as-they-happen",children:"pytest-instafail: See Details of Failures and Errors as They Happen"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"If your test suite takes quite a bit of time, you may want to see the tracebacks as they happen, rather than wait until the end"}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"https://pypi.org/project/pytest-instafail/",children:"https://pypi.org/project/pytest-instafail/"})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --help\nusage: pytest [options] [file_or_dir] [file_or_dir] [...]\n\n...\nreporting:\n  ...\n  --instafail           show failures and errors instantly as they occur\n                        (disabled by default).\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --instafail --timeout=0.5 --tb=line --maxfail=2 test_parallel.py\n============================= test session starts ==============================\n...\nplugins: cov-2.8.1, mock-3.1.0, instafail-0.4.1.post0\ntimeout: 0.5s\ntimeout method: signal\ntimeout func_only: False\ncollected 10 items\n\ntest_parallel.py F\n\n/path/to/appendices/xdist/test_parallel.py:7: Failed: Timeout >0.5s\n\ntest_parallel.py F\n\n/path/to/appendices/xdist/test_parallel.py:7: Failed: Timeout >0.5s\n\n=========================== short test summary info ============================\nFAILED test_parallel.py::test_something[0] - Failed: Timeout >0.5s\nFAILED test_parallel.py::test_something[1] - Failed: Timeout >0.5s\n!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 2 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!\n============================== 2 failed in 1.04s ===============================\n"})}),"\n",(0,t.jsx)(s.h4,{id:"pytest-sugar-instafail--colors--progress-bar",children:"pytest-sugar: Instafail + Colors + Progress Bar"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Lets you see status not just as characters, but also in color"}),"\n",(0,t.jsx)(s.li,{children:"Also shows failure and error tracebacks during execution, and has a cool progress bar to the right of the shell"}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"https://pypi.org/project/pytest-sugar/",children:"https://pypi.org/project/pytest-sugar/"})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --help\nusage: pytest [options] [file_or_dir] [file_or_dir] [...]\n\n...\nreporting:\n  ...\n  --old-summary         Show tests that failed instead of one-line tracebacks\n  --force-sugar         Force pytest-sugar output even when not in real terminal\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest test_parallel.py\nTest session starts (platform: linux, Python 3.6.9, pytest 5.4.1, pytest-sugar 0.9.3)\n...\nplugins: timeout-1.3.4, sugar-0.9.3, cov-2.8.1, mock-3.1.0\ncollecting ...\n test_parallel.py \u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713\u2713                                     100% \u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\n\nResults (10.09s):\n      10 passed\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --timeout=0.5 --tb=line --maxfail=2 test_parallel.py\nTest session starts (platform: linux, Python 3.6.9, pytest 5.4.1, pytest-sugar 0.9.3)\n...\nplugins: timeout-1.3.4, sugar-0.9.3, cov-2.8.1, mock-3.1.0\ntimeout: 0.5s\ntimeout method: signal\ntimeout func_only: False\ncollecting ...\n/home/jashburn/devel/sandbox/python/python-testing-with-pytest/appendices/xdist/test_parallel.py:7: Failed: Timeout >0.5s\n\n test_parallel.py \u2a2f                                               10% \u2588\n/home/jashburn/devel/sandbox/python/python-testing-with-pytest/appendices/xdist/test_parallel.py:7: Failed: Timeout >0.5s\n\n test_parallel.py \u2a2f                                               20% \u2588\u2588\n=========================== short test summary info ============================\nFAILED test_parallel.py::test_something[0] - Failed: Timeout >0.5s\nFAILED test_parallel.py::test_something[1] - Failed: Timeout >0.5s\n!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 2 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!\n\nResults (1.05s):\n       2 failed\n         - test_parallel.py:5 test_something[0]\n         - test_parallel.py:5 test_something[1]\n"})}),"\n",(0,t.jsx)(s.h4,{id:"pytest-emoji-add-some-fun-to-your-tests",children:"pytest-emoji: Add Some Fun to Your Tests"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Allows you to replace all of the test status characters with emojis"}),"\n",(0,t.jsx)(s.li,{children:"A small plugin and is a good example on which to base your own plugins"}),"\n",(0,t.jsxs)(s.li,{children:["Allows you to change the emoji using hook functions","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"one of the few pytest plugins that demonstrates how to add hook functions to plugin code"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"https://pypi.org/project/pytest-emoji/",children:"https://pypi.org/project/pytest-emoji/"})]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"pytest-html-generate-html-reports-for-test-sessions",children:"pytest-html: Generate HTML Reports for Test Sessions"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"Useful in conjunction with continuous integration, or in systems with large, long-running test suites"}),"\n",(0,t.jsx)(s.li,{children:"Creates a webpage to view the test results for a pytest session"}),"\n",(0,t.jsxs)(s.li,{children:["See: ",(0,t.jsx)(s.a,{href:"https://pypi.org/project/pytest-html/",children:"https://pypi.org/project/pytest-html/"})]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --help\nusage: pytest [options] [file_or_dir] [file_or_dir] [...]\n\n...\nreporting:\n  ...\n  --html=path           create html report file at given path.\n  --self-contained-html\n                        create a self-contained html file containing all\n                        necessary styles, scripts, and images - this means that\n                        the report may not render or function where CSP\n                        restrictions are in place (see\n                        https://developer.mozilla.org/docs/Web/Security/CSP)\n  --css=path            append given css file content to report style file.\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pytest --html=report.html\n============================= test session starts ==============================\n...\nplugins: metadata-1.9.0, timeout-1.3.4, cov-2.8.1, mock-3.1.0, html-2.1.1\ncollected 6 items\n\ntest_outcomes.py .FxXsE                                                  [100%]\n\n==================================== ERRORS ====================================\n_________________________ ERROR at setup of test_error _________________________\n\n    @pytest.fixture()\n    def flaky_fixture():\n>       assert 1 == 2\nE       assert 1 == 2\n\ntest_outcomes.py:29: AssertionError\n=================================== FAILURES ===================================\n__________________________________ test_fail ___________________________________\n\n    def test_fail():\n>       assert 1 == 2\nE       assert 1 == 2\n\ntest_outcomes.py:9: AssertionError\n- generated html file: file:///path/to/appendices/outcomes/report.html -\n=========================== short test summary info ============================\nFAILED test_outcomes.py::test_fail - assert 1 == 2\nERROR test_outcomes.py::test_error - assert 1 == 2\n==== 1 failed, 1 passed, 1 skipped, 1 xfailed, 1 xpassed, 1 error in 0.16s =====\n"})}),"\n",(0,t.jsx)(s.h3,{id:"plugins-for-static-analysis",children:"Plugins for Static Analysis"}),"\n",(0,t.jsx)(s.h4,{id:"pytest-pycodestyle-pytest-pep8-comply-with-pythons-style-guide",children:"pytest-pycodestyle, pytest-pep8: Comply with Python's Style Guide"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Use the ",(0,t.jsx)(s.code,{children:"pytest-pycodestyle"})," plugin to run ",(0,t.jsx)(s.code,{children:"pycodestyle"})," on code in your project, including test code, with the ",(0,t.jsx)(s.code,{children:"--pycodestyle"})," flag"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"pytest-flake8-check-for-style-plus-linting",children:"pytest-flake8: Check for Style Plus Linting"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["With the ",(0,t.jsx)(s.code,{children:"pytest-flake8"})," plugin, you can run all of your source code and test code through flake8 and get a failure if something isn't right","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"checks for PEP 8, as well as for logic errors"}),"\n",(0,t.jsxs)(s.li,{children:["use the ",(0,t.jsx)(s.code,{children:"--flake8"})," option to run ",(0,t.jsx)(s.code,{children:"flake8"})," during a pytest session"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["You can extend flake8 with plugins that offer even more checks, such as ",(0,t.jsx)(s.code,{children:"flake8-docstrings"})]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"plugins-for-web-development",children:"Plugins for Web Development"}),"\n",(0,t.jsx)(s.h4,{id:"pytest-selenium-test-with-a-web-browser",children:"pytest-selenium: Test with a Web Browser"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"pytest-selenium"})," plugin is the Python binding for Selenium"]}),"\n",(0,t.jsxs)(s.li,{children:["With it, you can","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"launch a web browser and use it to open URLs"}),"\n",(0,t.jsx)(s.li,{children:"exercise web applications"}),"\n",(0,t.jsx)(s.li,{children:"fill out forms"}),"\n",(0,t.jsx)(s.li,{children:"programmatically control the browser to test a web site or web application"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"pytest-django-test-django-applications",children:"pytest-django: Test Django Applications"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"By default, the builtin testing support in Django is based on unittest"}),"\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"pytest-django"})," plugin allows you to use pytest instead of unittest","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"includes helper functions and fixtures to speed up test implementation"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.h4,{id:"pytest-flask-test-flask-applications",children:"pytest-flask: Test Flask Applications"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The ",(0,t.jsx)(s.code,{children:"pytest-flask"})," plugin provides a handful of fixtures to assist in testing Flask applications"]}),"\n"]}),"\n",(0,t.jsx)(s.h2,{id:"a4-packaging-and-distributing-python-projects",children:"A4. Packaging and Distributing Python Projects"}),"\n",(0,t.jsx)(s.h3,{id:"creating-an-installable-module",children:"Creating an Installable Module"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"For a simple one-module project, the minimal configuration is small"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"\u200bsome_module_proj/\n\u200b\u251c\u2500\u2500 setup.py\n\u200b\u2514\u2500\u2500 some_module.py\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["The code we want to share is in ",(0,t.jsx)(s.code,{children:"some_module.py"})]}),"\n",(0,t.jsxs)(s.li,{children:["To make it installable with pip, we need a ",(0,t.jsx)(s.a,{href:"appendices/packaging/some_module_proj/setup.py",children:(0,t.jsx)(s.code,{children:"setup.py"})})," file"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pip install ./some_module_proj\nProcessing ./some_module_proj\nInstalling collected packages: some-module\n  Running setup.py install for some-module ... done\nSuccessfully installed some-module-0.0.0\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:'$ python\nPython 3.6.9 (default, Apr 18 2020, 01:56:04)\n[GCC 8.4.0] on linux\nType "help", "copyright", "credits" or "license" for more information.\n>>> from some_module import some_func\n>>> some_func()\n42\n>>>\n'})}),"\n",(0,t.jsx)(s.h3,{id:"creating-an-installable-package",children:"Creating an Installable Package"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"some_package_proj\n\u251c\u2500\u2500 setup.py\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 some_package\n        \u251c\u2500\u2500 __init__.py\n        \u2514\u2500\u2500 some_module.py\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.code,{children:"__init__.py"})," needs to be written to expose the module functionality to the outside world through the package namespace","\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["see: ",(0,t.jsx)(s.a,{href:"https://docs.python.org/3/tutorial/modules.html#packages",children:"https://docs.python.org/3/tutorial/modules.html#packages"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(s.li,{children:["If we do something like this in ",(0,t.jsx)(s.code,{children:"__init__.py"}),":"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"import some_package.some_module\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"The client code will have to specify:"}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"import some_package\nsome_package.some_module.some_func()\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"appendices/packaging/some_package_proj/src/some_package/__init__.py",children:(0,t.jsx)(s.code,{children:"some_package/__init__.py"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"expose everything in it to the package level"}),"\n",(0,t.jsx)(s.li,{children:"client code can do this:"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-python",children:"import some_package\nsome_package.some_func()\n"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"appendices/packaging/some_package_proj/setup.py",children:(0,t.jsx)(s.code,{children:"some_package_proj/setup.py"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsx)(s.li,{children:"specify packages"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pip install ./some_package_proj/\nProcessing ./some_package_proj\nInstalling collected packages: some-package\n  Running setup.py install for some-package ... done\nSuccessfully installed some-package-0.0.0\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:'$ python\nPython 3.6.9 (default, Apr 18 2020, 01:56:04)\n[GCC 8.4.0] on linux\nType "help", "copyright", "credits" or "license" for more information.\n>>> from some_package import some_func\n>>> some_func()\n42\n>>>\n'})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["You can add a ",(0,t.jsx)(s.code,{children:"tests"})," directory at the same level of ",(0,t.jsx)(s.code,{children:"src"})," to add our tests"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"creating-a-source-distribution-and-wheel",children:"Creating a Source Distribution and Wheel"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"some_package_proj_v2/\n\u251c\u2500\u2500 CHANGELOG.rst\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 README.rst\n\u251c\u2500\u2500 setup.py\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 some_package\n        \u251c\u2500\u2500 __init__.py\n        \u2514\u2500\u2500 some_module.py\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pip install --upgrade setuptools wheel\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ python setup.py sdist bdist_wheel\nrunning sdist\nrunning egg_info\ncreating src/some_package.egg-info\nwriting src/some_package.egg-info/PKG-INFO\nwriting dependency_links to src/some_package.egg-info/dependency_links.txt\nwriting top-level names to src/some_package.egg-info/top_level.txt\nwriting manifest file 'src/some_package.egg-info/SOURCES.txt'\nreading manifest file 'src/some_package.egg-info/SOURCES.txt'\nwriting manifest file 'src/some_package.egg-info/SOURCES.txt'\nrunning check\ncreating some_package-1.0\ncreating some_package-1.0/src\ncreating some_package-1.0/src/some_package\ncreating some_package-1.0/src/some_package.egg-info\ncopying files to some_package-1.0...\ncopying README.rst -> some_package-1.0\ncopying setup.py -> some_package-1.0\ncopying src/some_package/__init__.py -> some_package-1.0/src/some_package\ncopying src/some_package/some_module.py -> some_package-1.0/src/some_package\ncopying src/some_package.egg-info/PKG-INFO -> some_package-1.0/src/some_package.egg-info\ncopying src/some_package.egg-info/SOURCES.txt -> some_package-1.0/src/some_package.egg-info\ncopying src/some_package.egg-info/dependency_links.txt -> some_package-1.0/src/some_package.egg-info\ncopying src/some_package.egg-info/top_level.txt -> some_package-1.0/src/some_package.egg-info\nWriting some_package-1.0/setup.cfg\ncreating dist\nCreating tar archive\nremoving 'some_package-1.0' (and everything under it)\nrunning bdist_wheel\nrunning build\nrunning build_py\ncreating build\ncreating build/lib\ncreating build/lib/some_package\ncopying src/some_package/some_module.py -> build/lib/some_package\ncopying src/some_package/__init__.py -> build/lib/some_package\ninstalling to build/bdist.linux-x86_64/wheel\nrunning install\nrunning install_lib\ncreating build/bdist.linux-x86_64\ncreating build/bdist.linux-x86_64/wheel\ncreating build/bdist.linux-x86_64/wheel/some_package\ncopying build/lib/some_package/some_module.py -> build/bdist.linux-x86_64/wheel/some_package\ncopying build/lib/some_package/__init__.py -> build/bdist.linux-x86_64/wheel/some_package\nrunning install_egg_info\nCopying src/some_package.egg-info to build/bdist.linux-x86_64/wheel/some_package-1.0-py3.6.egg-info\nrunning install_scripts\nadding license file \"LICENSE\" (matched pattern \"LICEN[CS]E*\")\ncreating build/bdist.linux-x86_64/wheel/some_package-1.0.dist-info/WHEEL\ncreating 'dist/some_package-1.0-py3-none-any.whl' and adding 'build/bdist.linux-x86_64/wheel' to it\nadding 'some_package/__init__.py'\nadding 'some_package/some_module.py'\nadding 'some_package-1.0.dist-info/LICENSE'\nadding 'some_package-1.0.dist-info/METADATA'\nadding 'some_package-1.0.dist-info/WHEEL'\nadding 'some_package-1.0.dist-info/top_level.txt'\nadding 'some_package-1.0.dist-info/RECORD'\nremoving build/bdist.linux-x86_64/wheel\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-console",children:"$ pip install --no-index --find-links=dist some_package\nCollecting some_package\nInstalling collected packages: some-package\nSuccessfully installed some-package-1.0\n"})}),"\n",(0,t.jsx)(s.h2,{id:"sources",children:"Sources"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["Okken, Brian. ",(0,t.jsx)(s.em,{children:"Python Testing with Pytest: Simple, Rapid, Effective, and Scalable"}),". The Pragmatic Bookshelf, 2017."]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>a});var t=n(96540);const i={},l=t.createContext(i);function r(e){const s=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(l.Provider,{value:s},e.children)}}}]);