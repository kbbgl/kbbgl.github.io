"use strict";(globalThis.webpackChunkkgkb=globalThis.webpackChunkkgkb||[]).push([[97348],{37948:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>a,toc:()=>o});var t=n(74848),c=n(28453);const r={slug:"certificate-troubleshooting",title:"Troubleshooting Certificates",description:"Troubleshooting Certificates",authors:["kbbgl"],tags:["cybersecurity","certificates","encryption","openssl","cli"]},s=void 0,a={id:"cybersecurity/Encryption/certificate",title:"Troubleshooting Certificates",description:"Troubleshooting Certificates",source:"@site/docs/cybersecurity/Encryption/certificate.md",sourceDirName:"cybersecurity/Encryption",slug:"/cybersecurity/Encryption/certificate-troubleshooting",permalink:"/docs/cybersecurity/Encryption/certificate-troubleshooting",draft:!1,unlisted:!1,tags:[{inline:!0,label:"cybersecurity",permalink:"/docs/tags/cybersecurity"},{inline:!0,label:"certificates",permalink:"/docs/tags/certificates"},{inline:!0,label:"encryption",permalink:"/docs/tags/encryption"},{inline:!0,label:"openssl",permalink:"/docs/tags/openssl"},{inline:!0,label:"cli",permalink:"/docs/tags/cli"}],version:"current",frontMatter:{slug:"certificate-troubleshooting",title:"Troubleshooting Certificates",description:"Troubleshooting Certificates",authors:["kbbgl"],tags:["cybersecurity","certificates","encryption","openssl","cli"]},sidebar:"docsSidebar",previous:{title:"Getting Started with the Kernel",permalink:"/docs/os/development/linux_kernel_development/getting-started-kernel"},next:{title:"How SSL Works",permalink:"/docs/cybersecurity/Encryption/how-ssl-works"}},l={},o=[{value:"Display Certificate Information",id:"display-certificate-information",level:2},{value:"Full Information",id:"full-information",level:3},{value:"Specific Subject and Dates",id:"specific-subject-and-dates",level:3},{value:"Verifying Certificate",id:"verifying-certificate",level:2},{value:"Public Keys",id:"public-keys",level:2},{value:"Extract Public Key from Certificate",id:"extract-public-key-from-certificate",level:3},{value:"Displaying Public Key Information",id:"displaying-public-key-information",level:3},{value:"Private Keys",id:"private-keys",level:2},{value:"Displaying Private Key Information",id:"displaying-private-key-information",level:3},{value:"Checking a Private Key",id:"checking-a-private-key",level:3},{value:"Certificate Signing Request (CSR)",id:"certificate-signing-request-csr",level:2},{value:"Add Self-Signed Certificate to CA Store in Ubuntu",id:"add-self-signed-certificate-to-ca-store-in-ubuntu",level:2},{value:"Checking Kubernetes TLS Secret",id:"checking-kubernetes-tls-secret",level:2}];function d(e){const i={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h2,{id:"display-certificate-information",children:"Display Certificate Information"}),"\n",(0,t.jsx)(i.h3,{id:"full-information",children:"Full Information"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"openssl x509 -in /tmp/kgal-localhost-kind-kubeconfig-cluster-cert-auth-data.pem -noout -text\n"})}),"\n",(0,t.jsx)(i.p,{children:"The output will look something like this:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"Certificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number: 851...626 (0x763....1c3a)\n        Signature Algorithm: sha256WithRSAEncryption\n        Issuer: CN=kubernetes\n        Validity\n            Not Before: Sep 23 15:36:35 1970 GMT\n            Not After : Sep 21 15:41:35 2070 GMT\n        Subject: CN=kubernetes\n        Subject Public Key Info:\n            Public Key Algorithm: rsaEncryption\n                Public-Key: (2048 bit)\n                Modulus:\n                    00:b7:3f...:75\n                Exponent: 65537 (0x10001)\n        X509v3 extensions:\n            X509v3 Key Usage: critical\n                Digital Signature, Key Encipherment, Certificate Sign\n            X509v3 Basic Constraints: critical\n                CA:TRUE\n            X509v3 Subject Key Identifier: \n                F3:A2:...:3C\n            X509v3 Subject Alternative Name: \n                DNS:kubernetes\n    Signature Algorithm: sha256WithRSAEncryption\n    Signature Value:\n        65:91:a9:....b0:9c:48:31\n"})}),"\n",(0,t.jsx)(i.h3,{id:"specific-subject-and-dates",children:"Specific Subject and Dates"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"openssl x509 \\\n-in /tmp/kgal-localhost-kind-kubeconfig-cluster-cert-auth-data.pem \\\n-noout \\\n-subject \\\n-dates\n"})}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"subject=CN=kubernetes\nNot Before: Sep 23 15:36:35 1970 GMT\nNot After : Sep 21 15:41:35 2070 GMT\n"})}),"\n",(0,t.jsx)(i.h2,{id:"verifying-certificate",children:"Verifying Certificate"}),"\n",(0,t.jsx)(i.p,{children:"This command checks if a certificate is trusted by a given Certificate Authority (CA):"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"openssl verify -CAfile ca.pem crt.pem\n"})}),"\n",(0,t.jsx)(i.h2,{id:"public-keys",children:"Public Keys"}),"\n",(0,t.jsx)(i.h3,{id:"extract-public-key-from-certificate",children:"Extract Public Key from Certificate"}),"\n",(0,t.jsx)(i.p,{children:"This extracts the public key from a certificate and displays it in PEM format:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"openssl x509 \\\n-in /tmp/kgal-localhost-kind-kubeconfig-cluster-cert-auth-data.pem \\\n-noout \\\n-pubkey\n\n-----BEGIN PUBLIC KEY-----\nMIIBIj....AB\n-----END PUBLIC KEY-----\n"})}),"\n",(0,t.jsx)(i.h3,{id:"displaying-public-key-information",children:"Displaying Public Key Information"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"openssl x509 \\\n-in /tmp/kgal-localhost-kind-kubeconfig-cluster-public-key-data.pem \\\n-noout \\\n-pubin \\\n-text\n"})}),"\n",(0,t.jsx)(i.h2,{id:"private-keys",children:"Private Keys"}),"\n",(0,t.jsx)(i.h3,{id:"displaying-private-key-information",children:"Displaying Private Key Information"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"openssl pkey -in privatekey.pem -noout -text\n"})}),"\n",(0,t.jsx)(i.h3,{id:"checking-a-private-key",children:"Checking a Private Key"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"openssl rsa -in privatekey.pem -check -noout\n"})}),"\n",(0,t.jsx)(i.h2,{id:"certificate-signing-request-csr",children:"Certificate Signing Request (CSR)"}),"\n",(0,t.jsx)(i.p,{children:"Print the CSR content:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"openssl req -in docs.kbbgl-gh-io.dev.key -text -noout -verify\n"})}),"\n",(0,t.jsx)(i.h2,{id:"add-self-signed-certificate-to-ca-store-in-ubuntu",children:"Add Self-Signed Certificate to CA Store in Ubuntu"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"CRT_PATH=/tmp/kbbgl-gh-io-tls.crt\n\nsudo cp $CRT_PATH /usr/local/share/ca-certificates/\n\nsudo update-ca-certificates\n\nUpdating certificates in /etc/ssl/certs...\n1 added, 0 removed; done.\nRunning hooks in /etc/ca-certificates/update.d...\ndone.\n"})}),"\n",(0,t.jsx)(i.h2,{id:"checking-kubernetes-tls-secret",children:"Checking Kubernetes TLS Secret"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"kubectl get secrets -n default tls-kbbgl-gh-io-dev-crt -o jsonpath='{.data.tls\\.crt}' | base64 -d | openssl x509 -text -noout | grep -A 1 \"Subject Alternative Name\"\n            X509v3 Subject Alternative Name: \n                DNS:kbbgl-gh-io.dev, DNS:*.kbbgl-gh-io.dev\n"})})]})}function u(e={}){const{wrapper:i}={...(0,c.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,i,n)=>{n.d(i,{R:()=>s,x:()=>a});var t=n(96540);const c={},r=t.createContext(c);function s(e){const i=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:s(e.components),t.createElement(r.Provider,{value:i},e.children)}}}]);