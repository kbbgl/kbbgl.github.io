"use strict";(globalThis.webpackChunkkgkb=globalThis.webpackChunkkgkb||[]).push([[30121],{74691:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var o=s(74848),t=s(28453);const r={slug:"os-linux-network-network-filesystems-nfs",title:"NFS",authors:["kbbgl"],tags:["os","linux","network","network_filesystems","nfs","filesystem"]},i="NFS",l={id:"os/linux/network/network_filesystems/NFS",title:"NFS",description:"Network File System is a filesystem protocol built upon the Open Network Computing Remote Procedure Call system (ONC RPC). RPCs are managed by the portmap service.",source:"@site/docs/os/linux/network/network_filesystems/NFS.md",sourceDirName:"os/linux/network/network_filesystems",slug:"/os/linux/network/network_filesystems/os-linux-network-network-filesystems-nfs",permalink:"/docs/os/linux/network/network_filesystems/os-linux-network-network-filesystems-nfs",draft:!1,unlisted:!1,tags:[{inline:!0,label:"os",permalink:"/docs/tags/os"},{inline:!0,label:"linux",permalink:"/docs/tags/linux"},{inline:!0,label:"network",permalink:"/docs/tags/network"},{inline:!0,label:"network_filesystems",permalink:"/docs/tags/network-filesystems"},{inline:!0,label:"nfs",permalink:"/docs/tags/nfs"},{inline:!0,label:"filesystem",permalink:"/docs/tags/filesystem"}],version:"current",frontMatter:{slug:"os-linux-network-network-filesystems-nfs",title:"NFS",authors:["kbbgl"],tags:["os","linux","network","network_filesystems","nfs","filesystem"]},sidebar:"docsSidebar",previous:{title:"Mounting Network Filesystems",permalink:"/docs/os/linux/network/network_filesystems/os-linux-network-network-filesystems-mounting-network-filesystems"},next:{title:"Other Network Filesystems",permalink:"/docs/os/linux/network/network_filesystems/os-linux-network-network-filesystems-other-network-filesystems"}},a={},c=[{value:"Server Configuration",id:"server-configuration",level:2},{value:"Client Configuration",id:"client-configuration",level:2},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Performance Considerations",id:"performance-considerations",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"nfs",children:"NFS"})}),"\n",(0,o.jsx)(n.p,{children:"Network File System is a filesystem protocol built upon the Open Network Computing Remote Procedure Call system (ONC RPC). RPCs are managed by the portmap service."}),"\n",(0,o.jsx)(n.h2,{id:"server-configuration",children:"Server Configuration"}),"\n",(0,o.jsxs)(n.p,{children:["The main configuration is done in ",(0,o.jsx)(n.code,{children:"/etc/exports"})," file.\nThe file has:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"A directory to share."}),"\n",(0,o.jsx)(n.li,{children:"Host with mount options."}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"The server can be reloaded using:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"exportfs -ra\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The syntax of the ",(0,o.jsx)(n.code,{children:"exports"})," file is:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# <DIR> <HOST OR NETWORK> [<OPTIONS>]\n\n/srv/nfs 192.168.122.0/24(rw,sync,root_squash)\n"})}),"\n",(0,o.jsx)(n.h2,{id:"client-configuration",children:"Client Configuration"}),"\n",(0,o.jsx)(n.p,{children:"The NFS client mounts the remote filesystem onto the local system. There a few important commands:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# queries mount daemon on the remote server for information including shares that are available for mounting\nshowmount -e server\n\n# daemon is a dynamic port mapping daemon designed to reduce usage of well-known port\nportmap\n\n\n# mount command has the filesystem type NFS, which links to the mount.nfs command. There are two formats of the mount command for NFS shares.\n# - One option for mounting NFS shares is mount HOST:/export /mount-point where the host:/export portion causes the mount command to process this mount as NFS.\n# - The other form of the mount command is mount -t NFS HOST:/export /mountpoint which specifies which NFS is being used.\n# mount SERVER:/share /mnt/share\n"})}),"\n",(0,o.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,o.jsxs)(n.p,{children:["The NFS default security is to use the UNIX ",(0,o.jsx)(n.code,{children:"UID"})," and ",(0,o.jsx)(n.code,{children:"GID"}),". The challenge of using ",(0,o.jsx)(n.code,{children:"UID/GID"})," on different systems is the values must match. User ",(0,o.jsx)(n.code,{children:"Bib"})," with ",(0,o.jsx)(n.code,{children:"UID 1000"})," on system A must have the same ",(0,o.jsx)(n.code,{children:"UID"})," on system B, or the wrong information may be accessed. Having a single sign on system with network available information like ",(0,o.jsx)(n.code,{children:"NIS"}),", ",(0,o.jsx)(n.code,{children:"LDAP"}),", or ",(0,o.jsx)(n.code,{children:"Kerberos"})," will remove the ",(0,o.jsx)(n.code,{children:"UID"})," confusion issues. NFS4 is Kerberos-aware and an excellent option to eliminate the ",(0,o.jsx)(n.code,{children:"UID/GID"})," mapping issues."]}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"root_squash"})," option ",(0,o.jsx)(n.code,{children:"/etc/exports"})," file translates the root user's ",(0,o.jsx)(n.code,{children:"UID/GID"})," (0) to an anonymous ",(0,o.jsx)(n.code,{children:"UID/GID"}),". This is on by default and prevents root level access to the shared files. You should not disable ",(0,o.jsx)(n.code,{children:"root_squash"})," without a good reason."]}),"\n",(0,o.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,o.jsx)(n.p,{children:"Many factors contribute to the speed and performance of an NFS server or client."}),"\n",(0,o.jsxs)(n.p,{children:["Properly setting the values of ",(0,o.jsx)(n.code,{children:"rsize"})," and ",(0,o.jsx)(n.code,{children:"wsize"})," will allow for greater speed in a file transfer. However, you can only reasonably increase the block size to the ",(0,o.jsx)(n.code,{children:"MTU"})," of your network between client and server. Increasing the frame size (Jumbo Frames) is one option."]}),"\n",(0,o.jsx)(n.p,{children:"Moving from a 1G to a 10G Ethernet network would vastly speed up an NFS setup."}),"\n",(0,o.jsx)(n.p,{children:"The asynchronous mode trades speed for lack of robustness. An unclean shutdown of a server or client operating in an asynchronous mode has the potential to corrupt the data."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>l});var o=s(96540);const t={},r=o.createContext(t);function i(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);